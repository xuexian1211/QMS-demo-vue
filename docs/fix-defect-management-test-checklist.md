# 提案一测试验证清单

## 📋 测试前准备

### 1. 确认开发服务器运行
```bash
npm run dev
```
访问: http://localhost:5173

### 2. 导航到测试页面
- 不良现象页面: `/inspection-model/defect-phenomenon`
- 不良原因页面: `/inspection-model/defect-cause`

---

## ✅ Task 9.1: 多组织功能测试

### 测试目标
验证数据隔离和组织过滤功能

### 测试步骤

#### 不良现象页面
1. **添加集团级现象**
   - [ ] 点击"新增现象"
   - [ ] 组织选择器选择"集团级（全局可见）"
   - [ ] 填写现象信息并保存
   - [ ] 验证：现象代码、名称、严重等级正确显示

2. **添加工厂级现象**
   - [ ] 点击"新增现象"
   - [ ] 组织选择器选择"合肥工厂"
   - [ ] 填写现象信息并保存
   - [ ] 验证：列表中显示"合肥"标签

3. **验证数据隔离**
   - [ ] 查看列表中的"所属组织"列
   - [ ] 验证：集团级数据显示"集团级"标签
   - [ ] 验证：工厂级数据显示对应工厂名称

#### 不良原因页面
1. **组织过滤测试**
   - [ ] 左侧组织选择器选择"全部"
   - [ ] 验证：树中显示集团级和工厂级原因
   - [ ] 选择"合肥工厂"
   - [ ] 验证：只显示集团级和合肥工厂的原因

2. **添加不同组织的原因**
   - [ ] 添加集团级根原因
   - [ ] 添加合肥工厂根原因
   - [ ] 验证：树节点显示对应的组织标签

### 预期结果
- ✅ 集团级数据对所有工厂可见
- ✅ 工厂级数据仅对本工厂可见
- ✅ 组织标签正确显示

---

## ✅ Task 9.2: 原因树功能测试

### 测试目标
验证树状结构的添加、删除、展开功能

### 测试步骤

#### 1. 添加根原因
- [ ] 点击左上角"添加根原因"按钮
- [ ] 填写原因信息：
  - 原因代码: `C-TEST-001`
  - 原因名称: `测试根原因`
  - 原因类别: `Man`
  - 父原因: 留空
- [ ] 保存
- [ ] 验证：树中出现新的根节点

#### 2. 添加子原因
- [ ] 鼠标悬停在刚创建的根原因上
- [ ] 点击"+"图标（添加子原因）
- [ ] 填写子原因信息：
  - 原因代码: `C-TEST-001-01`
  - 原因名称: `测试子原因`
  - 父原因: 自动填充为父原因
- [ ] 保存
- [ ] 验证：子原因出现在父原因下方

#### 3. 添加子子原因（多层级）
- [ ] 在子原因上点击"+"图标
- [ ] 填写子子原因信息
- [ ] 保存
- [ ] 验证：形成三层树状结构

#### 4. 编辑原因
- [ ] 鼠标悬停在任意原因上
- [ ] 点击"编辑"图标
- [ ] 修改原因名称
- [ ] 保存
- [ ] 验证：树中名称更新

#### 5. 删除子原因
- [ ] 在子子原因上点击"删除"图标
- [ ] 确认删除
- [ ] 验证：子子原因被删除

#### 6. 删除父原因（级联删除）
- [ ] 在有子原因的父原因上点击"删除"图标
- [ ] 验证：弹窗提示子原因数量
- [ ] 确认删除
- [ ] 验证：父原因及所有子原因都被删除

#### 7. 树展开/折叠
- [ ] 点击树节点的展开/折叠图标
- [ ] 验证：子节点正确显示/隐藏

#### 8. 树搜索
- [ ] 在搜索框输入原因名称
- [ ] 验证：树自动过滤，只显示匹配的节点及其父节点

### 预期结果
- ✅ 支持无限层级的树状结构
- ✅ 添加子原因时自动继承父原因的类别和组织
- ✅ 删除父原因时正确提示并级联删除
- ✅ 树展开/折叠功能正常
- ✅ 搜索功能正常

---

## ✅ Task 9.3: 高频推荐测试

### 测试目标
验证高频标记和优先排序功能

### 测试步骤

#### 1. 标记高频原因
- [ ] 添加或编辑一个原因
- [ ] 打开"高频原因"开关
- [ ] 保存
- [ ] 验证：树节点前显示 ⭐ 图标
- [ ] 验证：列表中"高频标记"列显示"⭐ 高频"

#### 2. 高频原因优先排序
- [ ] 在同一层级添加多个原因（部分标记为高频）
- [ ] 验证：高频原因排在非高频原因前面

#### 3. 高频过滤
- [ ] 勾选"仅显示高频原因"复选框
- [ ] 验证：列表只显示高频原因

### 预期结果
- ✅ 高频原因显示 ⭐ 图标
- ✅ 高频原因在树中优先排序
- ✅ 高频过滤功能正常

---

## ✅ Task 9.4: 权重功能测试

### 测试目标
验证权重设置和排序功能

### 测试步骤

#### 1. 添加关联原因并设置权重
- [ ] 进入不良现象页面
- [ ] 编辑一个现象
- [ ] 切换到"关联原因"标签页
- [ ] 点击"添加关联原因"
- [ ] 选择多个原因
- [ ] 确认

#### 2. 调整权重
- [ ] 在关联原因表格中，找到"权重"列
- [ ] 使用 InputNumber 组件调整权重（1-10）
- [ ] 验证：权重值可以正常修改

#### 3. 权重排序
- [ ] 设置不同的权重值（如：8, 5, 9, 3）
- [ ] 验证：关联原因按权重降序排列（9 → 8 → 5 → 3）
- [ ] 修改某个权重
- [ ] 验证：列表自动重新排序

### 预期结果
- ✅ 权重可以在 1-10 范围内调整
- ✅ 关联原因按权重降序自动排序
- ✅ 权重修改后立即重新排序

---

## ✅ Task 9.5: 边界情况测试

### 测试目标
验证边界情况和异常处理

### 测试步骤

#### 1. 空数据状态
- [ ] 清空所有原因数据（或使用新的组织过滤）
- [ ] 验证：显示"暂无原因数据"空状态
- [ ] 验证：空状态有友好的提示信息

#### 2. 父原因选择器（防止循环引用）
- [ ] 编辑一个有子原因的父原因
- [ ] 打开父原因选择器
- [ ] 验证：选择器中不包含自己
- [ ] 验证：选择器中不包含自己的子原因

#### 3. 删除保护
- [ ] 尝试删除有子原因的父原因
- [ ] 验证：弹窗提示子原因数量
- [ ] 取消删除
- [ ] 验证：原因未被删除

#### 4. 表单验证
- [ ] 尝试保存空的原因代码
- [ ] 验证：显示验证错误
- [ ] 尝试保存空的原因名称
- [ ] 验证：显示验证错误

#### 5. 权重边界值
- [ ] 尝试输入权重 < 1
- [ ] 验证：自动调整为 1
- [ ] 尝试输入权重 > 10
- [ ] 验证：自动调整为 10

### 预期结果
- ✅ 空状态显示友好
- ✅ 防止循环引用
- ✅ 删除保护正常
- ✅ 表单验证正常
- ✅ 权重边界值处理正常

---

## 📊 测试结果汇总

### 测试环境
- **浏览器**: _____________
- **测试日期**: _____________
- **测试人员**: _____________

### 测试结果统计

| 测试项 | 通过 | 失败 | 备注 |
|--------|------|------|------|
| 9.1 多组织功能 | ☐ | ☐ | |
| 9.2 原因树功能 | ☐ | ☐ | |
| 9.3 高频推荐 | ☐ | ☐ | |
| 9.4 权重功能 | ☐ | ☐ | |
| 9.5 边界情况 | ☐ | ☐ | |

### 发现的问题

1. **问题描述**: _____________
   - **严重程度**: [ ] 高 [ ] 中 [ ] 低
   - **复现步骤**: _____________
   - **预期结果**: _____________
   - **实际结果**: _____________

2. **问题描述**: _____________
   - **严重程度**: [ ] 高 [ ] 中 [ ] 低
   - **复现步骤**: _____________
   - **预期结果**: _____________
   - **实际结果**: _____________

### 总体评价

- [ ] 所有功能正常，可以发布
- [ ] 有小问题，但不影响核心功能
- [ ] 有严重问题，需要修复后再测试

### 备注
_____________________________________________
_____________________________________________
_____________________________________________
