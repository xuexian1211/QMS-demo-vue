# 检验项目管理 (Inspection Item) - 详细设计文档

## 1. 模块概述
**模块名称**：检验项目管理 (Inspection Item)
**所属子系统**：质量主数据模块 (Quality Master Data)
**目标**：用于统一定义 QMS 系统中所有可能被用于测量的最小检测单元。支持不同数据类型（计量型/计数型）、不同的量测分类及严格的多工厂组织权限隔离机制。

## 2. 界面布局与交互设计
### 2.1 整体布局
采用经典的上栏查询、中栏工具、下栏数据的管理界面。
- **高级过滤扩展**：由于检验项目的属性特征复杂，查询区域支持基础检索并提供了“展开/收起”功能的辅助区，可按数据类型、所属组织域等多条件进一步复合过滤。

### 2.2 表格与色彩展示
- **所属组织过滤控制**：引入多选的组织选择器（合肥工厂、芜湖工厂等）。通过 `a-tag` 将跨越组织（如“集团”项目）和车间级别的项目以醒目色彩划分。
- **参数标记机制**：利用小巧醒目的标签 (`flags`) 快速呈现该检验项目是否承接 SPC 或者实验测试业务的核心挂载点（`isSpcDefault` 和 `isLabTestDefault`）。
- **数据约束识别**：为 `计量型（Quantitative）` 提供浅蓝色标识，对 `计数型（Qualitative）` 提供紫色标识处理，并依据类型强制关联是否有计量单位 (UOM)。

## 3. 核心功能设计
### 3.1 跨级权限的编辑拦截机制
- 系统的组织采用集团化分布。用户 `orgId` 若无跨级编辑权限，当点击诸如“集团级”标准检验项目时，操作列的编辑和删除会被拦截（逻辑 `canEdit()` 控制），只能只读查看或应用该标准项，而不能直接修改母版数据。

### 3.2 不良缺陷挂勾模型 (Defect Phenomenon Link)
- 增加了“不良现象” (Defect Phenomenon) 关联页签维护功能。针对某个质检项目可能导致的所有失效现象（如测表面外观时导致“划伤”、“破损”现象），支持进行先验绑定，缩短后续开具不合格单 (NC) 的选取时间。

## 4. 数据模型 (Data Model)
核心实体 `InspectionItem` 属性定义：
- `id`: 项目内部主键
- `code`: 项目唯一编码
- `name`: 检测特征名称
- `orgId`: 归属组织 (集团则为 null)
- `category`: 分类，含：尺寸(`dimension`)、外观(`appearance`)、理化(`physical_chemical`)、功能(`functional`)
- `dataType`: 数据定性方式 (`quantitative` 或 `qualitative`)
- `uom`: 单位（仅当 `dataType` 为计量型强绑定）
- `defaultMethodId`: 缺省验证和操作指导参考的方法卡ID
- `status`: 生命周期

## 5. 约束与规则
- **强类型录入检查**：若 `dataType` 选为 `qualitative` 此时 UOM 输入框为被完全禁用。
- **跨模块限制**：一旦该检验项目在生效的抽样方案体系或检验模板内被调用，系统逻辑底座原则上不允许再做删除动作（只能转为 obsolete/disabled 归档）。
