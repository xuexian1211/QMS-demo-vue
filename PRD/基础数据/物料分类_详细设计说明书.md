# 物料分类管理 (Material Category) - 详细设计文档

## 1. 模块概述
**模块名称**：物料分类管理
**所属子系统**：基础数据管理模块
**目标**：管理公司所有物料的分组架构及分类树节点，通过直观的层级结构组织物料主数据，以便规范和加速整个供应链数据链的搜索与统计属性归类。

## 2. 界面布局与交互设计 (重构说明)
为了大幅提升层级数据的可视化与可操作性，对页面进行了深度的 **“左树右表”** (Split-Layout) 布局改造。

### 2.1 左侧分类树 (Tree Panel)
- **展示**：使用树状结构全量或异步渲染物料的层级关系（如：原材料 -> 金属材料）。
- **搜索**：顶部提供针对树节点的实时文本搜索过滤能力，便于在庞大的分类目录中快速定位。
- **操作互动**：
  - 左键单击：高亮选中该节点，并**联动右侧表格**，使其仅展示所选分类及所有下挂子分类的数据。
  - 右键单击：弹出快捷环境菜单 (Context Menu)，支持直接针对于此级别进行：**新增子分类**、**编辑此分类**、**删除此分类** 等极速操作。
- **清除重置**：树顶部含有“清除筛选”按钮，恢复查看平铺的全部分类台账。

### 2.2 右侧内容面板 (Content Panel)
- 同常规的管理视图一致，但在数据获取时会额外挂载来自左侧所选层级的依赖参数。
- 包含了常规工具栏操作、搜索面板、及带有分类完整层级信息的表格 (`a-table`)。

## 3. 核心功能设计
### 3.1 树与表格的数据联动
- 左侧树与右侧表格使用一套基础的数据源加工而成。
- 左树发生 `select` 事件时，更新上下文 `selectedTreeKeys`。
- 表格的 `DataSource` 设定为基于该 Key 向下递归查找所有子节点 ID 并执行集合内 `.filter()` 保留满足条件的条目。

### 3.2 级联删除机制
- 树形结构数据中极易遇到存在关联子层级的情况。
- 在用户尝试触发删除操作时，系统会自动评估 (基于 `getDescendantIds` 获取数量)。
- 若其存在子类别，将明确在对话框气泡中提示：“分类X下有 N 个子分类，删除后子分类也将被删除”，确认后执行**深度遍历级联删除**以保证数据的干净与一致性。

## 4. 数据模型 (Data Model)
核心实体 `Category` 属性定义：
- `id`: 分类主键
- `categoryName`: 分类名称
- `categoryCode`: 规范化分类编码 (大写字符 + 下划线构型)
- `parentId`: 上级分类ID（指向自身实体的外键指针，为空表示根节点）
- `sortOrder`: 同级内的显示排序权重
- `description`: 说明备注
- `status`: 控制节点是否可以在后续物料档案创建时被正常引用

## 5. 约束与规则
- **编码规范**：分类编码被严格校验，只允许大写英文字母和下划线组成。
- **循环依赖防范**：在设置上级分类时，不能选择其自身或其子分类作为父级以致死循环（本期简化处理，但在后端需严格防范）。
