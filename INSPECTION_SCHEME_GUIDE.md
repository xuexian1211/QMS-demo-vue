# 检验方案管理系统 - 使用说明

## ✅ 已完成的工作

### 1. 核心功能实现

#### 📋 类型定义 (`src/types/index.ts`)
- ✅ `InspScheme` - 检验方案主表
- ✅ `InspSchemeDetail` - 检验方案明细
- ✅ `InspStrategy` - 检验策略
- ✅ `MatchDimension` - 匹配维度
- ✅ 更新了 `MaterialSpec` 接口

#### 🔌 API 接口 (`src/api/inspScheme.ts`)
- ✅ 检验方案 CRUD 操作
- ✅ 检验方案明细管理
- ✅ 检验策略管理
- ✅ 策略匹配测试
- ✅ **包含丰富的 Mock 数据**：
  - 4个示例检验方案（IQC、IPQC、FQC）
  - 多个检验明细示例
  - 3个检验策略示例

#### 🎯 策略匹配引擎 (`src/utils/strategyMatcher.ts`)
- ✅ 多维度匹配逻辑
- ✅ 优先级仲裁
- ✅ 触发条件支持
- ✅ 完整的单元测试

#### 🖥️ 前端页面

**检验方案列表页** (`src/views/inspection-model/InspSchemeList.vue`)
- ✅ 方案列表展示
- ✅ 搜索和筛选
- ✅ 新建/编辑/删除
- ✅ 状态流转（草稿→审批中→已批准→作废）
- ✅ 从模板创建

**检验方案编辑页** (`src/views/inspection-model/InspSchemeEdit.vue`)
- ✅ 基本信息编辑
- ✅ 检验项目明细管理（内联编辑）
- ✅ 策略绑定管理
- ✅ 所有必需的事件处理函数

**物料规格编辑器** (`src/components/MaterialSpecEditor.vue`)
- ✅ 计量型规格维护
- ✅ 计数型规格维护

#### 🧪 测试
- ✅ 策略匹配器单元测试 (`src/__tests__/strategyMatcher.spec.ts`)

### 2. 路由配置
- ✅ 已替换旧的 InspPlan 路由为新的 InspScheme 组件
- ✅ 保持了原有的 URL 路径 `/inspection-model/insp-plans`

## 📊 Mock 数据说明

### 检验方案示例
1. **SCH-IQC-001** - 来料检验方案-电子元器件（已批准）
2. **SCH-IQC-002** - 来料检验方案-机械零件（已批准）
3. **SCH-IPQC-001** - 过程检验方案-压铸工序（审批中）
4. **SCH-FQC-001** - 成品检验方案-标准产品（草稿）

### 检验明细示例
- 外观检验（目视检验，AQL 2.5）
- 尺寸测量（卡尺测量，AQL 1.0，SPC监控）
- 电气性能测试（万用表测试，全检，送检实验室）
- 表面粗糙度（粗糙度仪，AQL 2.5，SPC监控）

### 检验策略示例
1. **电阻类物料检验策略** - 所有电阻类物料使用电子元器件方案
2. **新供应商加严检验策略** - 新供应商前5批使用加严检验
3. **压铸工序检验策略** - 压铸工序使用专用检验方案

## 🚀 使用方法

### 访问页面
```
http://localhost:3001/inspection-model/insp-plans
```

### 主要功能

#### 1. 查看检验方案列表
- 打开页面即可看到4个示例方案
- 支持按方案编码、名称、状态搜索

#### 2. 新建检验方案
1. 点击"新建方案"按钮
2. 填写基本信息：
   - 方案编码（必填）
   - 方案名称（必填）
   - 版本号（默认V1.0）
   - 描述（可选）
3. 点击"保存"

#### 3. 编辑检验方案
1. 点击列表中的"编辑"按钮
2. 在三个标签页中编辑：
   - **基本信息**：编辑方案基础数据
   - **检验项目明细**：
     - 添加检验项目
     - 设置特性分类（SC/CC/Major/Minor）
     - 选择抽样规则
     - 选择检验方法
     - 配置SPC监控和送检要求
   - **策略绑定**：
     - 新增检验策略
     - 设置业务上下文（IQC/IPQC/FQC/OQC）
     - 配置匹配维度（物料、供应商、工序等）
     - 设置优先级
     - 配置触发条件

#### 4. 状态流转
- **草稿** → 点击"提交审批" → **审批中**
- **审批中** → 点击"审批通过" → **已批准**
- **已批准** → 点击"作废" → **已作废**

#### 5. 策略管理
在编辑页面的"策略绑定"标签中：
- 查看当前方案的所有策略
- 新增策略并配置匹配规则
- 启用/禁用策略
- 删除策略

## 🔧 技术特点

### 1. 架构设计
- **方案与模板分离**：InspScheme 是可编辑的实例
- **策略与方案分离**：InspStrategy 定义绑定逻辑
- **规格与方案解耦**：MaterialSpec 通过 inspItemCode 关联

### 2. 匹配引擎
- 支持多维度匹配（物料、供应商、工序等）
- 基于优先级的智能仲裁
- 支持触发条件（总是、新供应商前N批、工程变更前N批）

### 3. 用户体验
- 内联编辑：直接在表格中修改数据
- 批量操作：支持批量删除明细
- 状态管理：清晰的状态流转流程
- 实时反馈：操作成功/失败即时提示

## 📝 待完成工作

### 后端集成
- [ ] 实现真实的后端 API
- [ ] 数据库表结构创建
- [ ] 业务逻辑实现

### 功能增强
- [ ] 从模板导入明细功能
- [ ] 物料规格批量导入
- [ ] 策略匹配测试工具
- [ ] 审批流程集成
- [ ] 版本管理功能

### 数据加载
- [ ] 加载检验项目主数据
- [ ] 加载抽样规则主数据
- [ ] 加载检验方法主数据
- [ ] 加载量检具类型主数据

## 🐛 已知问题

### TypeScript Lint 警告
以下 lint 警告不影响功能运行：
- 找不到模块声明（TypeScript 缓存问题）
- 未使用的参数（Mock 数据中的占位参数）

这些警告会在以下情况下消失：
1. 重启 TypeScript 服务器
2. 实现真实的后端 API 后

## 💡 使用建议

1. **先查看示例数据**：打开列表页查看4个示例方案，了解数据结构
2. **尝试编辑功能**：编辑现有方案，熟悉操作流程
3. **测试策略绑定**：在方案1中查看已配置的策略
4. **创建新方案**：尝试从头创建一个新的检验方案

## 📞 技术支持

如有问题，请检查：
1. 开发服务器是否正常运行（http://localhost:3001）
2. 浏览器控制台是否有错误信息
3. 路由配置是否正确

---

**版本**: V1.0  
**最后更新**: 2024-02-10  
**状态**: ✅ 核心功能已完成，可用于演示和测试
