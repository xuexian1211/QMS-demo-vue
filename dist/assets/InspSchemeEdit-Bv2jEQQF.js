import{d as va,r as N,k as Z,j as fa,a as he,m as ya,c as m,e as R,p as o,f as r,x as l,q as a,s as c,t as p,o as n,h as u,y as E,K as Ia,a9 as Ca,F as k,z as S,V as ga,P as ee,I as ca,aa as ka,M as Pe,C as D,u as Ta}from"./index-BPMZt9Bz.js";import{P as _a}from"./PlayCircleOutlined-DB3JvYhq.js";import{_ as ba}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Na={class:"scheme-edit-page"},wa={class:"page-header"},Aa={class:"header-left"},Qa={class:"title-block"},La={class:"page-title"},xa={key:0,class:"field-hint"},Sa={key:0,class:"tab-toolbar"},Ra={key:0,class:"sort-badge"},Ua={key:0,class:"tab-toolbar"},Oa={key:0},Ea={key:0,class:"tab-toolbar"},ha={key:0},Pa={key:1},Ma={key:0,class:"tab-toolbar"},Da={key:0},qa={key:1},Va={key:2},za={key:3},Fa={key:0,class:"sim-result"},$a={key:0},Ba={key:1},Wa=va({__name:"InspSchemeEdit",setup(Ha){const me=Ta(),ae=fa(),ve=N(),Y=N(!1),fe=N("details"),_=Z(()=>ae.path.includes("/view/")),le=Z(()=>ae.path.includes("/edit/")),Me=Z(()=>_.value?"查看检验方案":le.value?"编辑检验方案":"新增检验方案"),z=N("ORG001"),Q=Z(()=>!le.value&&!_.value||z.value===null?!1:C.orgId===null),C=he({id:null,orgId:null,schemeCode:"",schemeName:"",version:"V1.0",inspType:void 0,status:"DRAFT",sourceTemplateId:void 0,sourceTemplateName:void 0,description:""}),De={schemeCode:[{required:!0,message:"请输入方案编码",trigger:"blur"}],schemeName:[{required:!0,message:"请输入方案名称",trigger:"blur"}],inspType:[{required:!0,message:"请选择检验类型",trigger:"change"}]},$=N(void 0),ye=N([{id:"T001",name:"IQC-原材料通用模板",version:"V1.0",details:[{inspItemId:"ITEM001",inspItemName:"外观检查",characteristicClass:"Major",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!1,labRequired:!1},{inspItemId:"ITEM002",inspItemName:"尺寸测量",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1}]},{id:"T002",name:"IPQC-过程检验模板",version:"V2.0",details:[{inspItemId:"ITEM003",inspItemName:"硬度测试",characteristicClass:"SC",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!0,labRequired:!0},{inspItemId:"ITEM004",inspItemName:"表面粗糙度",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1}]},{id:"T003",name:"FQC-成品检验模板",version:"V1.2",details:[{inspItemId:"ITEM005",inspItemName:"功能测试",characteristicClass:"SC",samplingRuleCode:"FULL_INSPECT",samplingRuleName:"全检",spcEnabled:!1,labRequired:!1}]}]);function qe(s){if(!s){C.sourceTemplateId=void 0,C.sourceTemplateName=void 0;return}const e=ye.value.find(y=>y.id===s);e&&Pe.confirm({title:"引用模板",content:`将从模板「${e.name}」复制 ${e.details.length} 个检验项目到当前方案，继续吗？`,onOk(){C.sourceTemplateId=e.id,C.sourceTemplateName=e.name,x.value=e.details.map((y,T)=>({id:`from-tpl-${T}-${Date.now()}`,schemeId:"",sortOrder:T+1,...y,inspMethodId:void 0,inspMethodName:"",gaugeTypeId:void 0,gaugeTypeName:"",labRequired:y.labRequired??!1,relatedPhenomenonIds:[],fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""})),D.success(`已从模板复制 ${e.details.length} 个检验项目，可在此基础上继续编辑`)},onCancel(){$.value=void 0}})}const x=N([]),Ve=[{title:"#",key:"sortOrder",width:50},{title:"检验项目",key:"inspItemName",dataIndex:"inspItemName",width:170},{title:"特性分类",key:"characteristicClass",width:110},{title:"抽样规则",key:"samplingRuleName",width:180},{title:"检验方法",key:"inspMethodName",width:150},{title:"SPC",key:"spcEnabled",width:60},{title:"实验室",key:"labRequired",width:65},{title:"操作",key:"action",width:110,fixed:"right"}],Ie=N([{id:"ITEM001",name:"外观检查",dataType:"qualitative"},{id:"ITEM002",name:"尺寸测量",dataType:"quantitative"},{id:"ITEM003",name:"硬度测试",dataType:"quantitative"},{id:"ITEM004",name:"表面粗糙度",dataType:"quantitative"},{id:"ITEM005",name:"功能测试",dataType:"qualitative"},{id:"ITEM006",name:"引脚平整度",dataType:"quantitative"}]),Ce=N([{code:"AQL-L2-N-0.65",name:"AQL 0.65 Level-II 正常"},{code:"AQL-L2-N-1.0",name:"AQL 1.0 Level-II 正常"},{code:"AQL-L2-T-0.65",name:"AQL 0.65 Level-II 加严"},{code:"FULL_INSPECT",name:"全检"}]),ge=N([{id:"M001",name:"目视检查"},{id:"M002",name:"卡尺测量"},{id:"M003",name:"三坐标测量"},{id:"M004",name:"洛氏硬度计测量"}]);function ze(s,e){const y=Ie.value.find(T=>T.id===e);y&&(s.inspItemName=y.name)}function Fe(){x.value.push({id:`new-${Date.now()}`,schemeId:"",sortOrder:x.value.length+1,inspItemId:void 0,inspItemName:"（请选择项目）",characteristicClass:"Minor",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II 正常",inspMethodId:void 0,inspMethodName:"",spcEnabled:!1,labRequired:!1,fromTemplate:!1,_editing:!0,createTime:"",updateTime:"",creator:"",updater:""})}function $e(s){x.value=x.value.filter(e=>e.id!==s.id)}function Be(){Pe.confirm({title:"确认清空",content:"将清空所有检验项目明细，操作不可撤销，确认吗？",okType:"danger",onOk(){x.value=[],$.value=void 0,C.sourceTemplateId=void 0,C.sourceTemplateName=void 0}})}const h=N([]),B=N(!1),v=N(null),We=[{title:"业务类型",key:"contextType",width:130},{title:"适用范围（匹配维度）",key:"matchSummary"},{title:"触发条件",key:"triggerCondition",width:180},{title:"优先级",key:"priority",width:80},{title:"操作",key:"action",width:110}];function He(){v.value={id:`new-${Date.now()}`,schemeId:"",contextType:C.inspType||"IQC",matchDimension:{materialId:void 0,supplierId:void 0,customerId:void 0,operationNo:void 0,ipqcType:void 0},priority:50,triggerCondition:"ALWAYS",triggerValue:void 0,description:"",createTime:"",updateTime:"",creator:"",updater:"",orgId:C.orgId??z.value??""},B.value=!0}function je(s){v.value=JSON.parse(JSON.stringify(s)),B.value=!0}function Ke(){if(!v.value)return;const s=h.value.findIndex(e=>e.id===v.value.id);s>=0?h.value[s]=v.value:h.value.push(v.value),B.value=!1,D.success("策略已保存")}function Ye(s){h.value=h.value.filter(e=>e.id!==s.id),D.success("已删除策略")}const te=N(!1),b=he({contextType:"IQC",materialId:void 0,supplierId:void 0,customerId:void 0,operationNo:void 0,ipqcType:void 0}),U=N(null);function Je(){var e,y,T,O,q;U.value=null;const s=h.value.filter(L=>L.contextType===b.contextType).filter(L=>{const d=L.matchDimension;return!(d.materialId&&d.materialId!==b.materialId||d.supplierId&&d.supplierId!==b.supplierId||d.customerId&&d.customerId!==b.customerId||d.operationNo&&d.operationNo!==b.operationNo||d.ipqcType&&d.ipqcType!==b.ipqcType)}).sort((L,d)=>L.priority-d.priority);if(s.length>0){const L=s[0],d=[];(e=L.matchDimension)!=null&&e.materialName&&d.push("物料"),(y=L.matchDimension)!=null&&y.supplierName&&d.push("供应商"),(T=L.matchDimension)!=null&&T.customerName&&d.push("客户"),(O=L.matchDimension)!=null&&O.operationName&&d.push("工序"),(q=L.matchDimension)!=null&&q.ipqcType&&d.push("IPQC类型"),U.value={matched:!0,strategy:L,matchType:d.length>0?d.join(" + ")+" 匹配":"通用匹配"}}else U.value={matched:!1}}const P=N([]),W=N(!1),g=N(null),Ge=[{title:"物料",dataIndex:"materialCode",key:"materialCode",width:120},{title:"检验项目",dataIndex:"inspItemName",key:"inspItemName",width:130},{title:"数据类型",key:"dataType",width:100},{title:"规格标准",key:"spec"},{title:"操作",key:"action",width:100}];function Xe(){g.value={id:`new-${Date.now()}`,materialId:void 0,materialCode:"",inspItemCode:void 0,inspItemName:"",dataType:"QUANTITATIVE",targetValue:void 0,upperLimit:void 0,lowerLimit:void 0,uom:"mm",standardDesc:"",expectedValue:"",specCode:"",specName:"",specType:"quantitative",sortOrder:P.value.length+1,status:"enabled",orgId:C.orgId??z.value??"",createTime:"",updateTime:"",creator:"",updater:""},W.value=!0}function Ze(s){g.value=JSON.parse(JSON.stringify(s)),W.value=!0}function ea(){if(!g.value)return;const s=x.value.find(y=>y.inspItemId===g.value.inspItemCode);s&&(g.value.inspItemName=s.inspItemName);const e=P.value.findIndex(y=>y.id===g.value.id);e>=0?P.value[e]=g.value:P.value.push(g.value),W.value=!1,D.success("规格已保存")}function aa(s){P.value=P.value.filter(e=>e.id!==s.id)}const H=N([]),la=[{title:"检验项目",dataIndex:"itemName",key:"itemName",width:150},{title:"不良现象",dataIndex:"phenomenonName",key:"phenomenonName"},{title:"严重等级",key:"severity",width:100},{title:"操作",key:"action",width:80}];function ta(){var s;H.value.push({id:`new-${Date.now()}`,itemName:((s=x.value[0])==null?void 0:s.inspItemName)||"外观检查",phenomenonName:"表面划伤",severity:"MI"}),D.success("已添加示例，请编辑")}function ia(s){H.value=H.value.filter(e=>e.id!==s.id)}const j=N([{id:"MAT001",code:"M001",name:"铝合金压铸件"},{id:"MAT002",code:"M002",name:"电子元器件A"},{id:"MAT003",code:"M003",name:"塑料注塑件"}]),ie=N([{id:"SUP001",name:"供应商甲（主力）"},{id:"SUP002",name:"供应商乙（备用）"},{id:"SUP003",name:"供应商丙（新供应商）"}]),ne=N([{id:"CUST001",code:"CUST-01",name:"客户A（大众）"},{id:"CUST002",code:"CUST-02",name:"客户B（通用）"},{id:"CUST003",code:"CUST-03",name:"客户C（丰田）"}]),ue=N([{no:"OP010",name:"焊接"},{no:"OP020",name:"组装"},{no:"OP030",name:"测试"}]),ce=s=>({DRAFT:"default",IN_APPROVAL:"processing",APPROVED:"success",OBSOLETE:"error"})[s]||"default",ke=s=>({DRAFT:"草稿",IN_APPROVAL:"审批中",APPROVED:"已批准",OBSOLETE:"已作废"})[s]||s,na=s=>({SC:"red",CC:"orange",Major:"blue",Minor:"default"})[s]||"default",ua=s=>({CR:"red",MA:"orange",MI:"blue"})[s]||"default",Te=s=>({ALWAYS:"总是触发",ON_NEW_SUPPLIER_FIRST_N_BATCHES:"新供应商前N批",ON_ECN_FIRST_N_BATCHES:"工程变更前N批"})[s]||s,oa=()=>me.push("/inspection-model/insp-schemes"),_e=async()=>{var s;try{if(Y.value=!0,await((s=ve.value)==null?void 0:s.validate()),x.value.length===0){D.warning("方案至少需要包含一个检验项目");return}D.success("方案保存成功"),me.push("/inspection-model/insp-schemes")}catch{D.error("请完善必填项")}finally{Y.value=!1}};return ya(()=>{const s=ae.params.id;if(s){const e=s!=="2";Object.assign(C,{id:s,orgId:e?null:z.value,schemeCode:e?"SCH-IQC-G001":"SCH-IQC-001",schemeName:e?"集团通用-电子料IQC方案":"合肥工厂-电子料IQC专用方案",version:"V1.0",inspType:"IQC",status:"APPROVED",sourceTemplateId:"T001",sourceTemplateName:"IQC-原材料通用模板",description:e?"集团统一制定，适用于所有工厂的电子类物料来料检验。":"用于IC芯片类物料的来料检验，额外增加了引脚平整度检查。"}),$.value="T001";const y=e?null:z.value;x.value=[{id:"d1",schemeId:s,sortOrder:1,inspItemId:"ITEM001",inspItemName:"外观检查",characteristicClass:"Major",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!1,labRequired:!1,fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""},{id:"d2",schemeId:s,sortOrder:2,inspItemId:"ITEM002",inspItemName:"尺寸测量",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1,fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""},{id:"d3",schemeId:s,sortOrder:3,inspItemId:"ITEM006",inspItemName:"引脚平整度",characteristicClass:"SC",samplingRuleCode:"FULL_INSPECT",samplingRuleName:"全检",spcEnabled:!1,labRequired:!1,fromTemplate:!1,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""}],h.value=[{id:"s1",schemeId:s,contextType:"IQC",matchDimension:{materialId:"MAT002",materialName:"电子元器件A"},priority:20,triggerCondition:"ALWAYS",orgId:y,createTime:"",updateTime:"",creator:"",updater:""},{id:"s2",schemeId:s,contextType:"IQC",matchDimension:{materialId:"MAT002",materialName:"电子元器件A",supplierId:"SUP003",supplierName:"供应商丙（新供应商）"},priority:5,triggerCondition:"ON_NEW_SUPPLIER_FIRST_N_BATCHES",triggerValue:3,orgId:y,createTime:"",updateTime:"",creator:"",updater:""}],P.value=[{id:"sp1",materialId:"MAT002",materialCode:"M002",inspItemCode:"ITEM006",inspItemName:"引脚平整度",dataType:"QUANTITATIVE",targetValue:.05,upperLimit:.1,lowerLimit:0,uom:"mm",specCode:"SP001",specName:"引脚平整度规格",specType:"quantitative",sortOrder:1,status:"enabled",orgId:y,createTime:"",updateTime:"",creator:"",updater:""}],H.value=[{id:"p1",itemName:"外观检查",phenomenonName:"表面划伤",severity:"MI"},{id:"p2",itemName:"外观检查",phenomenonName:"引脚变形",severity:"MA"}]}else C.orgId=z.value}),(s,e)=>{var Le,xe;const y=c("a-button"),T=c("a-tag"),O=c("a-space"),q=c("a-alert"),L=c("a-input"),d=c("a-form-item"),V=c("a-col"),oe=c("a-row"),f=c("a-select-option"),w=c("a-select"),se=c("a-textarea"),J=c("a-form"),be=c("a-card"),de=c("a-badge"),Ne=c("a-tooltip"),we=c("a-switch"),G=c("a-table"),X=c("a-tab-pane"),sa=c("a-tabs"),re=c("a-divider"),K=c("a-input-number"),pe=c("a-modal"),Ae=c("a-descriptions-item"),da=c("a-descriptions"),ra=c("a-result"),pa=c("a-empty"),Qe=c("a-radio"),ma=c("a-radio-group");return n(),m("div",Na,[R("div",wa,[R("div",Aa,[l(y,{type:"text",onClick:oa,class:"back-btn"},{icon:a(()=>[l(E(Ia))]),default:a(()=>[e[41]||(e[41]=u(" 返回 ",-1))]),_:1}),R("div",Qa,[R("h2",La,p(Me.value),1),C.version?(n(),o(T,{key:0,color:"blue"},{default:a(()=>[u(p(C.version),1)]),_:1})):r("",!0),l(T,{color:ce(C.status)},{default:a(()=>[u(p(ke(C.status)),1)]),_:1},8,["color"]),C.orgId===null?(n(),o(T,{key:1,color:"gold"},{default:a(()=>[...e[42]||(e[42]=[u("集团方案",-1)])]),_:1})):(n(),o(T,{key:2,color:"cyan"},{default:a(()=>[...e[43]||(e[43]=[u("本地方案",-1)])]),_:1})),C.sourceTemplateName?(n(),o(T,{key:3,color:"purple"},{icon:a(()=>[l(E(Ca))]),default:a(()=>[u(" 源自: "+p(C.sourceTemplateName),1)]),_:1})):r("",!0)])]),!_.value&&!Q.value?(n(),o(O,{key:0},{default:a(()=>[l(y,{onClick:_e,loading:Y.value},{default:a(()=>[...e[44]||(e[44]=[u("保存草稿",-1)])]),_:1},8,["loading"]),l(y,{type:"primary",onClick:_e,loading:Y.value},{default:a(()=>[...e[45]||(e[45]=[u("保存",-1)])]),_:1},8,["loading"])]),_:1})):r("",!0)]),Q.value?(n(),o(q,{key:0,type:"warning","show-icon":"",message:"集团级方案对工厂用户只读，如需修改请联系集团管理员，或基于此方案创建一个新的本地方案。",style:{"margin-bottom":"16px"}})):r("",!0),l(be,{class:"info-card",title:"基本信息"},{default:a(()=>[l(J,{ref_key:"formRef",ref:ve,model:C,rules:De,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[l(oe,{gutter:24},{default:a(()=>[l(V,{span:8},{default:a(()=>[l(d,{label:"方案编码",name:"schemeCode"},{default:a(()=>[l(L,{value:C.schemeCode,"onUpdate:value":e[0]||(e[0]=t=>C.schemeCode=t),disabled:_.value||le.value||Q.value,placeholder:"如: SCH-IQC-001"},null,8,["value","disabled"])]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(d,{label:"方案名称",name:"schemeName"},{default:a(()=>[l(L,{value:C.schemeName,"onUpdate:value":e[1]||(e[1]=t=>C.schemeName=t),disabled:_.value||Q.value,placeholder:"请输入方案名称"},null,8,["value","disabled"])]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(d,{label:"版本",name:"version"},{default:a(()=>[l(L,{value:C.version,"onUpdate:value":e[2]||(e[2]=t=>C.version=t),disabled:_.value||Q.value,placeholder:"如: V1.0"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(oe,{gutter:24},{default:a(()=>[l(V,{span:8},{default:a(()=>[l(d,{label:"检验类型",name:"inspType"},{default:a(()=>[l(w,{value:C.inspType,"onUpdate:value":e[3]||(e[3]=t=>C.inspType=t),disabled:_.value||Q.value,placeholder:"请选择"},{default:a(()=>[l(f,{value:"IQC"},{default:a(()=>[...e[46]||(e[46]=[u("IQC 来料检验",-1)])]),_:1}),l(f,{value:"IPQC"},{default:a(()=>[...e[47]||(e[47]=[u("IPQC 过程检验",-1)])]),_:1}),l(f,{value:"FQC"},{default:a(()=>[...e[48]||(e[48]=[u("FQC 成品检验",-1)])]),_:1}),l(f,{value:"OQC"},{default:a(()=>[...e[49]||(e[49]=[u("OQC 出货检验",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(d,{label:"引用模板"},{default:a(()=>[l(w,{value:$.value,"onUpdate:value":e[4]||(e[4]=t=>$.value=t),disabled:_.value||Q.value||x.value.length>0,placeholder:"选择模板可自动带出检验项目","allow-clear":"",onChange:qe},{default:a(()=>[(n(!0),m(k,null,S(ye.value,t=>(n(),o(f,{key:t.id,value:t.id},{default:a(()=>[u(p(t.name)+" ("+p(t.version)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"]),x.value.length>0&&!_.value?(n(),m("div",xa,[l(E(ga)),e[50]||(e[50]=u(" 已有明细，需清空后才能重新引用模板 ",-1))])):r("",!0)]),_:1})]),_:1}),l(V,{span:8},{default:a(()=>[l(d,{label:"状态"},{default:a(()=>[l(T,{color:ce(C.status)},{default:a(()=>[u(p(ke(C.status)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),l(oe,{gutter:24},{default:a(()=>[l(V,{span:16},{default:a(()=>[l(d,{label:"描述","label-col":{span:3},"wrapper-col":{span:20}},{default:a(()=>[l(se,{value:C.description,"onUpdate:value":e[5]||(e[5]=t=>C.description=t),disabled:_.value||Q.value,rows:2},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(be,{class:"tab-card"},{default:a(()=>[l(sa,{activeKey:fe.value,"onUpdate:activeKey":e[7]||(e[7]=t=>fe.value=t)},{default:a(()=>[l(X,{key:"details"},{tab:a(()=>[R("span",null,[e[51]||(e[51]=u(" 检验项目明细 ",-1)),l(de,{count:x.value.length,offset:[6,-2],color:"#1890ff"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(n(),m("div",Sa,[l(O,null,{default:a(()=>[l(y,{type:"primary",size:"small",onClick:Fe},{icon:a(()=>[l(E(ee))]),default:a(()=>[e[52]||(e[52]=u("新增检验项目 ",-1))]),_:1}),x.value.length>0?(n(),o(y,{key:0,size:"small",danger:"",onClick:Be},{icon:a(()=>[l(E(ca))]),default:a(()=>[e[53]||(e[53]=u("清空所有 ",-1))]),_:1})):r("",!0),l(Ne,{title:"明细行来自模板时标记蓝色，新增行为绿色"},{default:a(()=>[l(E(ka),{style:{cursor:"pointer",color:"#8c8c8c"}})]),_:1})]),_:1})])):r("",!0),l(G,{columns:Ve,"data-source":x.value,"row-key":"id",size:"small",pagination:!1,"row-class-name":t=>t.fromTemplate?"row-from-template":"row-custom"},{bodyCell:a(({column:t,record:i,index:A})=>[t.key==="sortOrder"?(n(),m("span",Ra,p(A+1),1)):r("",!0),t.key==="inspItemName"?(n(),m(k,{key:1},[!_.value&&i._editing?(n(),o(w,{key:0,value:i.inspItemId,"onUpdate:value":I=>i.inspItemId=I,size:"small",style:{width:"160px"},onChange:I=>ze(i,I)},{default:a(()=>[(n(!0),m(k,null,S(Ie.value,I=>(n(),o(f,{key:I.id,value:I.id},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(n(),o(Ne,{key:1,title:i.fromTemplate?"来自模板":"自定义添加"},{default:a(()=>[l(T,{color:i.fromTemplate?"blue":"green",style:{margin:"0"}},{default:a(()=>[u(p(i.inspItemName),1)]),_:2},1032,["color"])]),_:2},1032,["title"]))],64)):r("",!0),t.key==="characteristicClass"?(n(),m(k,{key:2},[!_.value&&i._editing?(n(),o(w,{key:0,value:i.characteristicClass,"onUpdate:value":I=>i.characteristicClass=I,size:"small",style:{width:"90px"}},{default:a(()=>[l(f,{value:"SC"},{default:a(()=>[...e[54]||(e[54]=[u("SC-特殊",-1)])]),_:1}),l(f,{value:"CC"},{default:a(()=>[...e[55]||(e[55]=[u("CC-关键",-1)])]),_:1}),l(f,{value:"Major"},{default:a(()=>[...e[56]||(e[56]=[u("主要",-1)])]),_:1}),l(f,{value:"Minor"},{default:a(()=>[...e[57]||(e[57]=[u("次要",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])):(n(),o(T,{key:1,color:na(i.characteristicClass)},{default:a(()=>[u(p(i.characteristicClass),1)]),_:2},1032,["color"]))],64)):r("",!0),t.key==="samplingRuleName"?(n(),m(k,{key:3},[!_.value&&i._editing?(n(),o(w,{key:0,value:i.samplingRuleCode,"onUpdate:value":I=>i.samplingRuleCode=I,size:"small",style:{width:"160px"},onChange:I=>{var M;return i.samplingRuleName=((M=Ce.value.find(F=>F.code===I))==null?void 0:M.name)||I}},{default:a(()=>[(n(!0),m(k,null,S(Ce.value,I=>(n(),o(f,{key:I.code,value:I.code},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(n(),m(k,{key:1},[u(p(i.samplingRuleName||i.samplingRuleCode),1)],64))],64)):r("",!0),t.key==="inspMethodName"?(n(),m(k,{key:4},[!_.value&&i._editing?(n(),o(w,{key:0,value:i.inspMethodId,"onUpdate:value":I=>i.inspMethodId=I,size:"small",style:{width:"130px"},"allow-clear":"",onChange:I=>{var M;return i.inspMethodName=((M=ge.value.find(F=>F.id===I))==null?void 0:M.name)||""}},{default:a(()=>[(n(!0),m(k,null,S(ge.value,I=>(n(),o(f,{key:I.id,value:I.id},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(n(),m(k,{key:1},[u(p(i.inspMethodName||"-"),1)],64))],64)):r("",!0),t.key==="spcEnabled"?(n(),o(we,{key:5,checked:i.spcEnabled,"onUpdate:checked":I=>i.spcEnabled=I,disabled:_.value||Q.value,size:"small"},null,8,["checked","onUpdate:checked","disabled"])):r("",!0),t.key==="labRequired"?(n(),o(we,{key:6,checked:i.labRequired,"onUpdate:checked":I=>i.labRequired=I,disabled:_.value||Q.value,size:"small"},null,8,["checked","onUpdate:checked","disabled"])):r("",!0),t.key==="action"?(n(),m(k,{key:7},[!_.value&&!Q.value?(n(),o(O,{key:0},{default:a(()=>[i._editing?(n(),o(y,{key:0,type:"link",size:"small",onClick:I=>i._editing=!1},{default:a(()=>[...e[58]||(e[58]=[u("完成",-1)])]),_:1},8,["onClick"])):(n(),o(y,{key:1,type:"link",size:"small",onClick:I=>i._editing=!0},{default:a(()=>[...e[59]||(e[59]=[u("编辑",-1)])]),_:1},8,["onClick"])),l(y,{type:"link",danger:"",size:"small",onClick:I=>$e(i)},{default:a(()=>[...e[60]||(e[60]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source","row-class-name"])]),_:1}),l(X,{key:"strategies"},{tab:a(()=>[R("span",null,[e[61]||(e[61]=u(" 适用策略 (上下文绑定) ",-1)),l(de,{count:h.value.length,offset:[6,-2],color:"#52c41a"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(n(),m("div",Ua,[l(O,null,{default:a(()=>[l(y,{type:"primary",size:"small",onClick:He},{icon:a(()=>[l(E(ee))]),default:a(()=>[e[62]||(e[62]=u("新增策略 ",-1))]),_:1}),l(y,{size:"small",onClick:e[6]||(e[6]=t=>te.value=!0)},{icon:a(()=>[l(E(_a))]),default:a(()=>[e[63]||(e[63]=u("匹配模拟器 ",-1))]),_:1})]),_:1})])):r("",!0),l(G,{columns:We,"data-source":h.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:t,record:i})=>[t.key==="contextType"?(n(),o(T,{key:0,color:"blue"},{default:a(()=>[u(p(i.contextType),1)]),_:2},1024)):r("",!0),t.key==="matchSummary"?(n(),o(O,{key:1,wrap:""},{default:a(()=>{var A,I,M,F,Se,Re,Ue,Oe,Ee;return[(A=i.matchDimension)!=null&&A.materialName?(n(),o(T,{key:0,color:"orange"},{default:a(()=>[u(" 物料: "+p(i.matchDimension.materialName),1)]),_:2},1024)):r("",!0),(I=i.matchDimension)!=null&&I.supplierName?(n(),o(T,{key:1,color:"red"},{default:a(()=>[u(" 供应商: "+p(i.matchDimension.supplierName),1)]),_:2},1024)):r("",!0),(M=i.matchDimension)!=null&&M.customerName?(n(),o(T,{key:2,color:"geekblue"},{default:a(()=>[u(" 客户: "+p(i.matchDimension.customerName),1)]),_:2},1024)):r("",!0),(F=i.matchDimension)!=null&&F.operationName?(n(),o(T,{key:3,color:"purple"},{default:a(()=>[u(" 工序: "+p(i.matchDimension.operationName),1)]),_:2},1024)):r("",!0),(Se=i.matchDimension)!=null&&Se.ipqcType?(n(),o(T,{key:4,color:"volcano"},{default:a(()=>[u(" IPQC类型: "+p(i.matchDimension.ipqcType),1)]),_:2},1024)):r("",!0),!((Re=i.matchDimension)!=null&&Re.materialName)&&!((Ue=i.matchDimension)!=null&&Ue.supplierName)&&!((Oe=i.matchDimension)!=null&&Oe.customerName)&&!((Ee=i.matchDimension)!=null&&Ee.operationName)?(n(),o(T,{key:5,color:"default"},{default:a(()=>[...e[64]||(e[64]=[u(" 通用（兜底） ",-1)])]),_:1})):r("",!0)]}),_:2},1024)):r("",!0),t.key==="triggerCondition"?(n(),m(k,{key:2},[R("span",null,p(Te(i.triggerCondition)),1),i.triggerValue?(n(),m("span",Oa," (前 "+p(i.triggerValue)+" 批)",1)):r("",!0)],64)):r("",!0),t.key==="priority"?(n(),o(T,{key:3,color:i.priority<=10?"red":i.priority<=50?"orange":"default"},{default:a(()=>[u(" P"+p(i.priority),1)]),_:2},1032,["color"])):r("",!0),t.key==="action"?(n(),m(k,{key:4},[!_.value&&!Q.value?(n(),o(O,{key:0},{default:a(()=>[l(y,{type:"link",size:"small",onClick:A=>je(i)},{default:a(()=>[...e[65]||(e[65]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(y,{type:"link",danger:"",size:"small",onClick:A=>Ye(i)},{default:a(()=>[...e[66]||(e[66]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1}),l(X,{key:"materialSpec"},{tab:a(()=>[R("span",null,[e[67]||(e[67]=u("物料规格 ",-1)),l(de,{count:P.value.length,offset:[6,-2],color:"#722ed1"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(n(),m("div",Ea,[l(y,{type:"primary",size:"small",onClick:Xe},{icon:a(()=>[l(E(ee))]),default:a(()=>[e[68]||(e[68]=u("新增规格 ",-1))]),_:1})])):r("",!0),l(G,{columns:Ge,"data-source":P.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:t,record:i})=>[t.key==="dataType"?(n(),o(T,{key:0,color:i.dataType==="QUANTITATIVE"?"blue":"purple"},{default:a(()=>[u(p(i.dataType==="QUANTITATIVE"?"计量型":"计数型"),1)]),_:2},1032,["color"])):r("",!0),t.key==="spec"?(n(),m(k,{key:1},[i.dataType==="QUANTITATIVE"?(n(),m("span",ha,[u(p(i.lowerLimit)+" ~ "+p(i.upperLimit)+" "+p(i.uom)+" ",1),l(T,{color:"cyan",style:{"margin-left":"4px"}},{default:a(()=>[u("目标: "+p(i.targetValue),1)]),_:2},1024)])):(n(),m("span",Pa,p(i.standardDesc||i.expectedValue),1))],64)):r("",!0),t.key==="action"?(n(),m(k,{key:2},[!_.value&&!Q.value?(n(),o(O,{key:0},{default:a(()=>[l(y,{type:"link",size:"small",onClick:A=>Ze(i)},{default:a(()=>[...e[69]||(e[69]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(y,{type:"link",danger:"",size:"small",onClick:A=>aa(i)},{default:a(()=>[...e[70]||(e[70]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1}),l(X,{key:"phenomenon",tab:"不良现象防错配置"},{default:a(()=>[!_.value&&!Q.value?(n(),m("div",Ma,[l(y,{type:"primary",size:"small",onClick:ta},{icon:a(()=>[l(E(ee))]),default:a(()=>[e[71]||(e[71]=u("新增绑定 ",-1))]),_:1})])):r("",!0),l(G,{columns:la,"data-source":H.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:t,record:i})=>[t.key==="severity"?(n(),o(T,{key:0,color:ua(i.severity)},{default:a(()=>[u(p(i.severity),1)]),_:2},1032,["color"])):r("",!0),t.key==="action"?(n(),m(k,{key:1},[!_.value&&!Q.value?(n(),o(y,{key:0,type:"link",danger:"",size:"small",onClick:A=>ia(i)},{default:a(()=>[...e[72]||(e[72]=[u("删除",-1)])]),_:1},8,["onClick"])):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["activeKey"])]),_:1}),l(pe,{visible:B.value,"onUpdate:visible":e[22]||(e[22]=t=>B.value=t),title:(xe=(Le=v.value)==null?void 0:Le.id)!=null&&xe.startsWith("new")?"新增绑定策略":"编辑绑定策略",width:"680px",onOk:Ke,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(q,{type:"info","show-icon":"",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[73]||(e[73]=[u(' 策略定义"什么情况下"使用本方案。同一方案可绑定多条策略，优先级越小优先级越高。 ',-1)])]),_:1}),v.value?(n(),o(J,{key:0,model:v.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[l(d,{label:"业务类型",required:""},{default:a(()=>[l(w,{value:v.value.contextType,"onUpdate:value":e[8]||(e[8]=t=>v.value.contextType=t)},{default:a(()=>[l(f,{value:"IQC"},{default:a(()=>[...e[74]||(e[74]=[u("IQC 来料检验",-1)])]),_:1}),l(f,{value:"IPQC"},{default:a(()=>[...e[75]||(e[75]=[u("IPQC 过程检验",-1)])]),_:1}),l(f,{value:"FQC"},{default:a(()=>[...e[76]||(e[76]=[u("FQC 成品检验",-1)])]),_:1}),l(f,{value:"OQC"},{default:a(()=>[...e[77]||(e[77]=[u("OQC 出货检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(re,null,{default:a(()=>[...e[78]||(e[78]=[u("匹配维度（不填则通用匹配）",-1)])]),_:1}),l(q,{type:"warning","show-icon":"",style:{"margin-bottom":"12px"}},{message:a(()=>[v.value.contextType==="IQC"?(n(),m("span",Da,[...e[79]||(e[79]=[u("IQC: 可按 ",-1),R("b",null,"物料 + 供应商",-1),u(" 匹配",-1)])])):v.value.contextType==="IPQC"?(n(),m("span",qa,[...e[80]||(e[80]=[u("IPQC: 可按 ",-1),R("b",null,"物料 + 工序 + IPQC类型",-1),u(" 匹配",-1)])])):v.value.contextType==="FQC"?(n(),m("span",Va,[...e[81]||(e[81]=[u("FQC: 内部成品检验，仅按 ",-1),R("b",null,"物料",-1),u(" 匹配（无供应商/客户）",-1)])])):v.value.contextType==="OQC"?(n(),m("span",za,[...e[82]||(e[82]=[u("OQC: 出货检验，可按 ",-1),R("b",null,"物料 + 客户",-1),u(" 匹配（无供应商）",-1)])])):r("",!0)]),_:1}),l(d,{label:"物料"},{default:a(()=>[l(w,{value:v.value.matchDimension.materialId,"onUpdate:value":e[9]||(e[9]=t=>v.value.matchDimension.materialId=t),"allow-clear":"",placeholder:"不限物料",onChange:e[10]||(e[10]=t=>{var i;return v.value.matchDimension.materialName=((i=j.value.find(A=>A.id===t))==null?void 0:i.name)||""})},{default:a(()=>[(n(!0),m(k,null,S(j.value,t=>(n(),o(f,{key:t.id,value:t.id},{default:a(()=>[u(p(t.code)+" - "+p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),v.value.contextType==="IQC"?(n(),o(d,{key:0,label:"供应商"},{default:a(()=>[l(w,{value:v.value.matchDimension.supplierId,"onUpdate:value":e[11]||(e[11]=t=>v.value.matchDimension.supplierId=t),"allow-clear":"",placeholder:"不限供应商",onChange:e[12]||(e[12]=t=>{var i;return v.value.matchDimension.supplierName=((i=ie.value.find(A=>A.id===t))==null?void 0:i.name)||""})},{default:a(()=>[(n(!0),m(k,null,S(ie.value,t=>(n(),o(f,{key:t.id,value:t.id},{default:a(()=>[u(p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="OQC"?(n(),o(d,{key:1,label:"客户"},{default:a(()=>[l(w,{value:v.value.matchDimension.customerId,"onUpdate:value":e[13]||(e[13]=t=>v.value.matchDimension.customerId=t),"allow-clear":"",placeholder:"不限客户",onChange:e[14]||(e[14]=t=>{var i;return v.value.matchDimension.customerName=((i=ne.value.find(A=>A.id===t))==null?void 0:i.name)||""})},{default:a(()=>[(n(!0),m(k,null,S(ne.value,t=>(n(),o(f,{key:t.id,value:t.id},{default:a(()=>[u(p(t.code)+" - "+p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="IPQC"?(n(),o(d,{key:2,label:"工序"},{default:a(()=>[l(w,{value:v.value.matchDimension.operationNo,"onUpdate:value":e[15]||(e[15]=t=>v.value.matchDimension.operationNo=t),"allow-clear":"",placeholder:"不限工序",onChange:e[16]||(e[16]=t=>{var i;return v.value.matchDimension.operationName=((i=ue.value.find(A=>A.no===t))==null?void 0:i.name)||""})},{default:a(()=>[(n(!0),m(k,null,S(ue.value,t=>(n(),o(f,{key:t.no,value:t.no},{default:a(()=>[u(p(t.no)+" "+p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="IPQC"?(n(),o(d,{key:3,label:"IPQC 类型"},{default:a(()=>[l(w,{value:v.value.matchDimension.ipqcType,"onUpdate:value":e[17]||(e[17]=t=>v.value.matchDimension.ipqcType=t),"allow-clear":"",placeholder:"不限类型"},{default:a(()=>[l(f,{value:"FAI"},{default:a(()=>[...e[83]||(e[83]=[u("FAI 首件检验",-1)])]),_:1}),l(f,{value:"PATROL"},{default:a(()=>[...e[84]||(e[84]=[u("PATROL 巡检",-1)])]),_:1}),l(f,{value:"LAI"},{default:a(()=>[...e[85]||(e[85]=[u("LAI 末件检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):r("",!0),l(re,null,{default:a(()=>[...e[86]||(e[86]=[u("策略参数",-1)])]),_:1}),l(d,{label:"触发条件"},{default:a(()=>[l(w,{value:v.value.triggerCondition,"onUpdate:value":e[18]||(e[18]=t=>v.value.triggerCondition=t)},{default:a(()=>[l(f,{value:"ALWAYS"},{default:a(()=>[...e[87]||(e[87]=[u("总是触发",-1)])]),_:1}),l(f,{value:"ON_NEW_SUPPLIER_FIRST_N_BATCHES"},{default:a(()=>[...e[88]||(e[88]=[u("新供应商前N批",-1)])]),_:1}),l(f,{value:"ON_ECN_FIRST_N_BATCHES"},{default:a(()=>[...e[89]||(e[89]=[u("工程变更后前N批",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),v.value.triggerCondition!=="ALWAYS"?(n(),o(d,{key:4,label:"前N批"},{default:a(()=>[l(K,{value:v.value.triggerValue,"onUpdate:value":e[19]||(e[19]=t=>v.value.triggerValue=t),min:1,max:99,style:{width:"120px"}},null,8,["value"]),e[90]||(e[90]=R("span",{style:{"margin-left":"8px",color:"#8c8c8c"}},"批",-1))]),_:1})):r("",!0),l(d,{label:"优先级",extra:"数值越小越优先，建议：精确匹配=10，通用匹配=99"},{default:a(()=>[l(K,{value:v.value.priority,"onUpdate:value":e[20]||(e[20]=t=>v.value.priority=t),min:1,max:999,style:{width:"120px"}},null,8,["value"])]),_:1}),l(d,{label:"备注"},{default:a(()=>[l(se,{value:v.value.description,"onUpdate:value":e[21]||(e[21]=t=>v.value.description=t),rows:2},null,8,["value"])]),_:1})]),_:1},8,["model"])):r("",!0)]),_:1},8,["visible","title"]),l(pe,{visible:te.value,"onUpdate:visible":e[29]||(e[29]=t=>te.value=t),title:"策略匹配模拟器",width:"700px",onOk:Je,"ok-text":"开始模拟"},{default:a(()=>{var t;return[l(q,{type:"info","show-icon":"",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[91]||(e[91]=[u("输入业务上下文参数，验证当前方案策略的匹配逻辑是否符合预期。",-1)])]),_:1}),l(J,{model:b,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[l(d,{label:"业务类型"},{default:a(()=>[l(w,{value:b.contextType,"onUpdate:value":e[23]||(e[23]=i=>b.contextType=i)},{default:a(()=>[l(f,{value:"IQC"},{default:a(()=>[...e[92]||(e[92]=[u("IQC",-1)])]),_:1}),l(f,{value:"IPQC"},{default:a(()=>[...e[93]||(e[93]=[u("IPQC",-1)])]),_:1}),l(f,{value:"FQC"},{default:a(()=>[...e[94]||(e[94]=[u("FQC",-1)])]),_:1}),l(f,{value:"OQC"},{default:a(()=>[...e[95]||(e[95]=[u("OQC",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(d,{label:"物料"},{default:a(()=>[l(w,{value:b.materialId,"onUpdate:value":e[24]||(e[24]=i=>b.materialId=i),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(n(!0),m(k,null,S(j.value,i=>(n(),o(f,{key:i.id,value:i.id},{default:a(()=>[u(p(i.code)+" - "+p(i.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),b.contextType==="IQC"?(n(),o(d,{key:0,label:"供应商"},{default:a(()=>[l(w,{value:b.supplierId,"onUpdate:value":e[25]||(e[25]=i=>b.supplierId=i),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(n(!0),m(k,null,S(ie.value,i=>(n(),o(f,{key:i.id,value:i.id},{default:a(()=>[u(p(i.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="OQC"?(n(),o(d,{key:1,label:"客户"},{default:a(()=>[l(w,{value:b.customerId,"onUpdate:value":e[26]||(e[26]=i=>b.customerId=i),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(n(!0),m(k,null,S(ne.value,i=>(n(),o(f,{key:i.id,value:i.id},{default:a(()=>[u(p(i.code)+" - "+p(i.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="IPQC"?(n(),o(d,{key:2,label:"工序"},{default:a(()=>[l(w,{value:b.operationNo,"onUpdate:value":e[27]||(e[27]=i=>b.operationNo=i),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(n(!0),m(k,null,S(ue.value,i=>(n(),o(f,{key:i.no,value:i.no},{default:a(()=>[u(p(i.no)+" "+p(i.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="IPQC"?(n(),o(d,{key:3,label:"IPQC类型"},{default:a(()=>[l(w,{value:b.ipqcType,"onUpdate:value":e[28]||(e[28]=i=>b.ipqcType=i),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[l(f,{value:"FAI"},{default:a(()=>[...e[96]||(e[96]=[u("FAI 首件检验",-1)])]),_:1}),l(f,{value:"PATROL"},{default:a(()=>[...e[97]||(e[97]=[u("PATROL 巡检",-1)])]),_:1}),l(f,{value:"LAI"},{default:a(()=>[...e[98]||(e[98]=[u("LAI 末件检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):r("",!0)]),_:1},8,["model"]),l(re,null,{default:a(()=>[...e[99]||(e[99]=[u("模拟结果",-1)])]),_:1}),U.value?(n(),m("div",Fa,[l(ra,{status:U.value.matched?"success":"warning",title:U.value.matched?`✅ 匹配到策略 (优先级 P${(t=U.value.strategy)==null?void 0:t.priority})`:"⚠️ 未匹配到任何策略"},{subTitle:a(()=>[U.value.matched?(n(),m("div",$a,[l(da,{bordered:"",size:"small",column:2},{default:a(()=>[l(Ae,{label:"匹配类型"},{default:a(()=>[u(p(U.value.matchType),1)]),_:1}),l(Ae,{label:"触发条件"},{default:a(()=>{var i;return[u(p(Te((i=U.value.strategy)==null?void 0:i.triggerCondition)),1)]}),_:1})]),_:1})])):(n(),m("div",Ba,"当前方案无策略可匹配此业务上下文，建议添加兜底（通用）策略。"))]),_:1},8,["status","title"])])):(n(),o(pa,{key:1,description:"请填写条件后点击「开始模拟」"}))]}),_:1},8,["visible"]),l(pe,{visible:W.value,"onUpdate:visible":e[40]||(e[40]=t=>W.value=t),title:"物料检验规格",width:"600px",onOk:ea},{default:a(()=>[g.value?(n(),o(J,{key:0,model:g.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[l(d,{label:"物料"},{default:a(()=>[l(w,{value:g.value.materialId,"onUpdate:value":e[30]||(e[30]=t=>g.value.materialId=t),placeholder:"请选择物料",onChange:e[31]||(e[31]=t=>{var i;return g.value.materialCode=((i=j.value.find(A=>A.id===t))==null?void 0:i.code)||""})},{default:a(()=>[(n(!0),m(k,null,S(j.value,t=>(n(),o(f,{key:t.id,value:t.id},{default:a(()=>[u(p(t.code)+" - "+p(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(d,{label:"检验项目"},{default:a(()=>[l(w,{value:g.value.inspItemCode,"onUpdate:value":e[32]||(e[32]=t=>g.value.inspItemCode=t),placeholder:"请选择项目"},{default:a(()=>[(n(!0),m(k,null,S(x.value,t=>(n(),o(f,{key:t.inspItemId,value:t.inspItemId},{default:a(()=>[u(p(t.inspItemName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(d,{label:"数据类型"},{default:a(()=>[l(ma,{value:g.value.dataType,"onUpdate:value":e[33]||(e[33]=t=>g.value.dataType=t)},{default:a(()=>[l(Qe,{value:"QUANTITATIVE"},{default:a(()=>[...e[100]||(e[100]=[u("计量型（有公差）",-1)])]),_:1}),l(Qe,{value:"QUALITATIVE"},{default:a(()=>[...e[101]||(e[101]=[u("计数型（描述标准）",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),g.value.dataType==="QUANTITATIVE"?(n(),m(k,{key:0},[l(d,{label:"目标值"},{default:a(()=>[l(K,{value:g.value.targetValue,"onUpdate:value":e[34]||(e[34]=t=>g.value.targetValue=t),style:{width:"140px"}},null,8,["value"]),l(L,{value:g.value.uom,"onUpdate:value":e[35]||(e[35]=t=>g.value.uom=t),placeholder:"单位",style:{width:"70px","margin-left":"8px"}},null,8,["value"])]),_:1}),l(d,{label:"上限 (USL)"},{default:a(()=>[l(K,{value:g.value.upperLimit,"onUpdate:value":e[36]||(e[36]=t=>g.value.upperLimit=t),style:{width:"140px"}},null,8,["value"])]),_:1}),l(d,{label:"下限 (LSL)"},{default:a(()=>[l(K,{value:g.value.lowerLimit,"onUpdate:value":e[37]||(e[37]=t=>g.value.lowerLimit=t),style:{width:"140px"}},null,8,["value"])]),_:1})],64)):(n(),m(k,{key:1},[l(d,{label:"标准描述"},{default:a(()=>[l(se,{value:g.value.standardDesc,"onUpdate:value":e[38]||(e[38]=t=>g.value.standardDesc=t),rows:3,placeholder:"如：表面无划伤，色泽均匀"},null,8,["value"])]),_:1}),l(d,{label:"期望值"},{default:a(()=>[l(L,{value:g.value.expectedValue,"onUpdate:value":e[39]||(e[39]=t=>g.value.expectedValue=t),placeholder:"如：OK / PASS"},null,8,["value"])]),_:1})],64))]),_:1},8,["model"])):r("",!0)]),_:1},8,["visible"])])}}}),Ja=ba(Wa,[["__scopeId","data-v-a5c76827"]]);export{Ja as default};
