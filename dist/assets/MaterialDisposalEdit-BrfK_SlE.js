import{d as O,r as y,a as Y,m as E,c as L,e as s,x as e,q as t,s as p,n as j,t as K,j as V,C,u as F,o as q,h,y as x,K as G,p as w,f as M,L as z}from"./index-C4MSyl8P.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"material-disposal-edit"},X={class:"page-header"},Z={class:"header-left"},$={class:"title-section"},ee={class:"header-actions"},te={class:"form-container"},ae={class:"main-info-section"},le={class:"section-title"},re={class:"form-tabs"},oe={class:"tab-content"},ne={class:"tab-content"},ie={class:"tab-content"},ue=O({__name:"MaterialDisposalEdit",setup(se){const f=F(),U=V(),N=y(),g=y(!1),l=Y({id:null,disposalNo:"",discoveryDate:null,discoveryDepartment:"品质部（IQC）",otherDepartment:"",discoverer:"",materialName:"",materialModel:"",batchNo:"",purchaseOrderNo:"",supplierName:"",supplierCode:"",contactPerson:"",contactPhone:"",defectPhenomenon:"",defectCategory:"",defectQuantity:null,totalQuantity:null,isolationArea:"",isolationMark:"黄色标牌",isolationPerson:"",iqcInspectionNo:"",supplierCertificateNo:"",otherCertificates:"",reviewDepartments:[],reviewDate:null,disposalMethod:"return",discountPercentage:null,rectificationDeadline:null,requiredDocuments:[],executionDepartment:"",executor:"",executionDate:null,executionResult:"",verificationDepartment:"",verifier:"",verificationConclusion:"",fillerSignature:"",departmentHeadSignature:"",qualityDepartmentReview:"",approverSignature:"",remark:"",status:"pending"}),c=y("material"),Q=u=>{console.log("Tab切换事件触发"),console.log("切换到Tab:",u),console.log("当前activeTab值:",c.value),c.value=u,console.log("设置后的activeTab值:",c.value)},k=u=>({draft:"草稿",pending_review:"待审核",reviewing:"审核中",approved:"已审核",rejected:"已驳回",processing:"处理中",completed:"已完成",cancelled:"已取消"})[u]||u,R=u=>({draft:"status-draft",pending_review:"status-pending-review",reviewing:"status-reviewing",approved:"status-approved",rejected:"status-rejected",processing:"status-processing",completed:"status-completed",cancelled:"status-cancelled"})[u]||"",S={discoveryDate:[{required:!0,message:"请选择发现时间",trigger:"change"}],discoveryDepartment:[{required:!0,message:"请选择发现部门",trigger:"change"}],otherDepartment:[{required:!0,message:"请输入其他部门",trigger:"blur"}],discoverer:[{required:!0,message:"请输入发现人",trigger:"blur"}],materialName:[{required:!0,message:"请输入物料名称",trigger:"blur"}],materialModel:[{required:!0,message:"请输入物料型号",trigger:"blur"}],batchNo:[{required:!0,message:"请输入批次号",trigger:"blur"}],purchaseOrderNo:[{required:!0,message:"请输入采购订单号",trigger:"blur"}],supplierName:[{required:!0,message:"请输入供应商名称",trigger:"blur"}],supplierCode:[{required:!0,message:"请输入供应商编码",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入联系电话",trigger:"blur"}],defectPhenomenon:[{required:!0,message:"请输入不合格现象",trigger:"blur"}],defectCategory:[{required:!0,message:"请选择不合格类别",trigger:"change"}],defectQuantity:[{required:!0,message:"请输入不合格数量",trigger:"blur"}],totalQuantity:[{required:!0,message:"请输入总数量",trigger:"blur"}],isolationArea:[{required:!0,message:"请输入隔离区域",trigger:"blur"}],isolationMark:[{required:!0,message:"请选择隔离标识",trigger:"change"}],isolationPerson:[{required:!0,message:"请输入隔离人",trigger:"blur"}],reviewDepartments:[{required:!0,message:"请选择评审部门",trigger:"change"}],reviewDate:[{required:!0,message:"请选择评审日期",trigger:"change"}],disposalMethod:[{required:!0,message:"请选择处置方式",trigger:"change"}]},A=()=>{window.location.href="/production-quality/exception-handling/material-disposal"},I=async()=>{try{await N.value.validate(),g.value=!0,setTimeout(()=>{C.success("保存成功"),f.push("/production-quality/exception-handling/material-disposal")},1e3)}catch(u){console.error("表单验证失败:",u)}finally{g.value=!1}},T=()=>{const u=U.query.id;if(u){const m=[{id:1,disposalNo:"LHBHG20240115001",discoveryDate:"2024-01-15 09:30",discoveryDepartment:"品质部（IQC）",discoverer:"张三",materialName:"电子元件A",materialModel:"EC-A001",batchNo:"BATCH001",purchaseOrderNo:"PO20240110001",supplierName:"供应商A",supplierCode:"SUP001",contactPerson:"李经理",contactPhone:"13800138001",defectPhenomenon:"尺寸超差，超出公差范围0.2mm",defectCategory:"A类",defectQuantity:50,totalQuantity:1e3,isolationArea:"不合格品区A-01",isolationMark:"黄色标牌",isolationPerson:"王五",iqcInspectionNo:"IQC20240115001",supplierCertificateNo:"CERT001",otherCertificates:"",reviewDepartments:["品质部","采购部"],reviewDate:"2024-01-15",disposalMethod:"return",discountPercentage:null,rectificationDeadline:"2024-01-25",requiredDocuments:["8D报告","整改计划表"],executionDepartment:"采购部",executor:"赵六",executionDate:"2024-01-16",executionResult:"已退货给供应商，要求重新提供合格产品",verificationDepartment:"品质部（SQE）",verifier:"孙七",verificationConclusion:"合格",fillerSignature:"张三",departmentHeadSignature:"周主管",qualityDepartmentReview:"李审核",approverSignature:"王审批",remark:"已通知供应商加强质量控制",status:"completed"},{id:2,disposalNo:"LHBHG20240116001",discoveryDate:"2024-01-16 14:20",discoveryDepartment:"品质部（IQC）",discoverer:"钱八",materialName:"机械零件B",materialModel:"MP-B002",batchNo:"BATCH002",purchaseOrderNo:"PO20240112002",supplierName:"供应商B",supplierCode:"SUP002",contactPerson:"陈经理",contactPhone:"13900139002",defectPhenomenon:"表面有划痕，影响外观质量",defectCategory:"B类",defectQuantity:30,totalQuantity:500,isolationArea:"不合格品区A-02",isolationMark:"黄色盛具",isolationPerson:"吴九",iqcInspectionNo:"IQC20240116001",supplierCertificateNo:"CERT002",otherCertificates:"",reviewDepartments:["品质部","制造技术部"],reviewDate:"2024-01-16",disposalMethod:"concession_discount",discountPercentage:5,rectificationDeadline:"2024-01-26",requiredDocuments:["整改计划表"],executionDepartment:"制造技术部",executor:"郑十",executionDate:"2024-01-17",executionResult:"已让步接收，降价5%",verificationDepartment:"IQC",verifier:"冯十一",verificationConclusion:"合格",fillerSignature:"钱八",departmentHeadSignature:"沈主管",qualityDepartmentReview:"韩审核",approverSignature:"杨审批",remark:"供应商承诺改进包装方式",status:"completed"},{id:3,disposalNo:"LHBHG20240117001",discoveryDate:"2024-01-17 11:45",discoveryDepartment:"其他",otherDepartment:"生产部",discoverer:"朱十二",materialName:"原材料C",materialModel:"RM-C003",batchNo:"BATCH003",purchaseOrderNo:"PO20240113003",supplierName:"供应商C",supplierCode:"SUP003",contactPerson:"秦经理",contactPhone:"13700137003",defectPhenomenon:"颜色偏差，与标准色板不符",defectCategory:"C类",defectQuantity:20,totalQuantity:200,isolationArea:"不合格品区A-03",isolationMark:"黄色标牌",isolationPerson:"尤十三",iqcInspectionNo:"IQC20240117001",supplierCertificateNo:"CERT003",otherCertificates:"",reviewDepartments:["品质部","采购部","研发技术部"],reviewDate:"2024-01-17",disposalMethod:"sorting",discountPercentage:null,rectificationDeadline:"2024-01-27",requiredDocuments:["8D报告","复检报告"],executionDepartment:"生产部",executor:"",executionDate:null,executionResult:"",verificationDepartment:"",verifier:"",verificationConclusion:"",fillerSignature:"朱十二",departmentHeadSignature:"",qualityDepartmentReview:"",approverSignature:"",remark:"等待分选处理",status:"pending"}].find(i=>i.id===parseInt(u));m?Object.assign(l,m):(C.error("未找到对应的记录"),f.push("/production-quality/exception-handling/material-disposal"))}else C.error("缺少记录ID参数"),f.push("/production-quality/exception-handling/material-disposal")};return E(()=>{T()}),(u,a)=>{const m=p("a-button"),i=p("a-input"),o=p("a-form-item"),n=p("a-col"),b=p("a-date-picker"),v=p("a-select"),d=p("a-row"),_=p("a-tab-pane"),P=p("a-textarea"),D=p("a-input-number"),B=p("a-tabs"),H=p("a-form");return q(),L("div",W,[s("div",X,[s("div",Z,[e(m,{type:"text",onClick:A,class:"back-button"},{icon:t(()=>[e(x(G))]),default:t(()=>[a[29]||(a[29]=h(" 返回 ",-1))]),_:1}),s("div",$,[a[30]||(a[30]=s("h2",{class:"page-title"},"来料不合格处置单-编辑",-1)),s("div",{class:j(["status-badge",R(l.status)])},K(k(l.status)),3)])]),s("div",ee,[e(m,{type:"primary",onClick:I,loading:g.value},{default:t(()=>[...a[31]||(a[31]=[h("保存",-1)])]),_:1},8,["loading"])])]),s("div",te,[e(H,{ref_key:"formRef",ref:N,model:l,rules:S,layout:"vertical",class:"disposal-form"},{default:t(()=>[s("div",ae,[s("div",le,[e(x(z)),a[32]||(a[32]=h(" 基本信息 ",-1))]),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"处置单号",name:"disposalNo"},{default:t(()=>[e(i,{value:l.disposalNo,"onUpdate:value":a[0]||(a[0]=r=>l.disposalNo=r),disabled:""},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"发现时间",name:"discoveryDate",required:""},{default:t(()=>[e(b,{value:l.discoveryDate,"onUpdate:value":a[1]||(a[1]=r=>l.discoveryDate=r),"show-time":"",format:"YYYY-MM-DD HH:mm",placeholder:"请选择发现时间",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"发现部门",name:"discoveryDepartment",required:""},{default:t(()=>[e(v,{value:l.discoveryDepartment,"onUpdate:value":a[2]||(a[2]=r=>l.discoveryDepartment=r),placeholder:"请选择发现部门",options:[{value:"品质部（IQC）",label:"品质部（IQC）"},{value:"品质部（IPQC）",label:"品质部（IPQC）"},{value:"品质部（FQC）",label:"品质部（FQC）"},{value:"生产部",label:"生产部"},{value:"其他",label:"其他"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),l.discoveryDepartment==="其他"?(q(),w(d,{key:0,gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"其他部门",name:"otherDepartment",required:""},{default:t(()=>[e(i,{value:l.otherDepartment,"onUpdate:value":a[3]||(a[3]=r=>l.otherDepartment=r),placeholder:"请输入其他部门"},null,8,["value"])]),_:1})]),_:1})]),_:1})):M("",!0),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"发现人",name:"discoverer",required:""},{default:t(()=>[e(i,{value:l.discoverer,"onUpdate:value":a[4]||(a[4]=r=>l.discoverer=r),placeholder:"请输入发现人"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"供应商名称",name:"supplierName",required:""},{default:t(()=>[e(i,{value:l.supplierName,"onUpdate:value":a[5]||(a[5]=r=>l.supplierName=r),placeholder:"请输入供应商名称"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"批次号",name:"batchNo",required:""},{default:t(()=>[e(i,{value:l.batchNo,"onUpdate:value":a[6]||(a[6]=r=>l.batchNo=r),placeholder:"请输入批次号"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),s("div",re,[e(B,{activeKey:c.value,"onUpdate:activeKey":a[28]||(a[28]=r=>c.value=r),onChange:Q},{default:t(()=>[e(_,{key:"material",tab:"物料信息"},{default:t(()=>[s("div",oe,[e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"物料名称",name:"materialName",required:""},{default:t(()=>[e(i,{value:l.materialName,"onUpdate:value":a[7]||(a[7]=r=>l.materialName=r),placeholder:"请输入物料名称"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"物料型号",name:"materialModel",required:""},{default:t(()=>[e(i,{value:l.materialModel,"onUpdate:value":a[8]||(a[8]=r=>l.materialModel=r),placeholder:"请输入物料型号"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"采购订单号",name:"purchaseOrderNo",required:""},{default:t(()=>[e(i,{value:l.purchaseOrderNo,"onUpdate:value":a[9]||(a[9]=r=>l.purchaseOrderNo=r),placeholder:"请输入采购订单号"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"供应商编码",name:"supplierCode",required:""},{default:t(()=>[e(i,{value:l.supplierCode,"onUpdate:value":a[10]||(a[10]=r=>l.supplierCode=r),placeholder:"请输入供应商编码"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"联系人",name:"contactPerson",required:""},{default:t(()=>[e(i,{value:l.contactPerson,"onUpdate:value":a[11]||(a[11]=r=>l.contactPerson=r),placeholder:"请输入联系人"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"联系电话",name:"contactPhone",required:""},{default:t(()=>[e(i,{value:l.contactPhone,"onUpdate:value":a[12]||(a[12]=r=>l.contactPhone=r),placeholder:"请输入联系电话"},null,8,["value"])]),_:1})]),_:1})]),_:1})])]),_:1}),e(_,{key:"defect",tab:"不合格详情"},{default:t(()=>[s("div",ne,[e(d,{gutter:16},{default:t(()=>[e(n,{span:12},{default:t(()=>[e(o,{label:"不合格现象",name:"defectPhenomenon",required:""},{default:t(()=>[e(P,{value:l.defectPhenomenon,"onUpdate:value":a[13]||(a[13]=r=>l.defectPhenomenon=r),rows:3,placeholder:"请详细描述不合格现象"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:t(()=>[e(o,{label:"不合格类别",name:"defectCategory",required:""},{default:t(()=>[e(v,{value:l.defectCategory,"onUpdate:value":a[14]||(a[14]=r=>l.defectCategory=r),placeholder:"请选择不合格类别",options:[{value:"尺寸超差",label:"尺寸超差"},{value:"外观缺陷",label:"外观缺陷"},{value:"性能不符",label:"性能不符"},{value:"材质问题",label:"材质问题"},{value:"包装问题",label:"包装问题"},{value:"其他",label:"其他"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"不合格数量",name:"defectQuantity",required:""},{default:t(()=>[e(D,{value:l.defectQuantity,"onUpdate:value":a[15]||(a[15]=r=>l.defectQuantity=r),min:1,placeholder:"请输入不合格数量",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"总数量",name:"totalQuantity",required:""},{default:t(()=>[e(D,{value:l.totalQuantity,"onUpdate:value":a[16]||(a[16]=r=>l.totalQuantity=r),min:1,placeholder:"请输入总数量",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"隔离区域",name:"isolationArea",required:""},{default:t(()=>[e(i,{value:l.isolationArea,"onUpdate:value":a[17]||(a[17]=r=>l.isolationArea=r),placeholder:"请输入隔离区域"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"隔离标识",name:"isolationMark",required:""},{default:t(()=>[e(v,{value:l.isolationMark,"onUpdate:value":a[18]||(a[18]=r=>l.isolationMark=r),placeholder:"请选择隔离标识",options:[{value:"红色标牌",label:"红色标牌"},{value:"黄色标牌",label:"黄色标牌"},{value:"蓝色标牌",label:"蓝色标牌"}]},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"隔离人",name:"isolationPerson",required:""},{default:t(()=>[e(i,{value:l.isolationPerson,"onUpdate:value":a[19]||(a[19]=r=>l.isolationPerson=r),placeholder:"请输入隔离人"},null,8,["value"])]),_:1})]),_:1})]),_:1})])]),_:1}),e(_,{key:"processing",tab:"处理记录"},{default:t(()=>[s("div",ie,[e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"评审部门",name:"reviewDepartments",required:""},{default:t(()=>[e(v,{value:l.reviewDepartments,"onUpdate:value":a[20]||(a[20]=r=>l.reviewDepartments=r),mode:"multiple",placeholder:"请选择评审部门",options:[{value:"品质部",label:"品质部"},{value:"采购部",label:"采购部"},{value:"制造技术部",label:"制造技术部"},{value:"研发技术部",label:"研发技术部"},{value:"生产部",label:"生产部"}]},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"评审日期",name:"reviewDate",required:""},{default:t(()=>[e(b,{value:l.reviewDate,"onUpdate:value":a[21]||(a[21]=r=>l.reviewDate=r),format:"YYYY-MM-DD",placeholder:"请选择评审日期",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"处置方式",name:"disposalMethod",required:""},{default:t(()=>[e(v,{value:l.disposalMethod,"onUpdate:value":a[22]||(a[22]=r=>l.disposalMethod=r),placeholder:"请选择处置方式",options:[{value:"return",label:"退货（退回供应商返工/分选）"},{value:"concession",label:"让步接收（不降价）"},{value:"concession_discount",label:"让步接收（降价）"},{value:"sorting",label:"挑选使用（我司分选）"}]},null,8,["value"])]),_:1})]),_:1}),l.disposalMethod==="concession_discount"?(q(),w(n,{key:0,span:8},{default:t(()=>[e(o,{label:"降价比例(%)",name:"discountPercentage"},{default:t(()=>[e(D,{value:l.discountPercentage,"onUpdate:value":a[23]||(a[23]=r=>l.discountPercentage=r),min:1,max:100,placeholder:"请输入降价比例",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})):M("",!0)]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:8},{default:t(()=>[e(o,{label:"执行部门",name:"executionDepartment"},{default:t(()=>[e(i,{value:l.executionDepartment,"onUpdate:value":a[24]||(a[24]=r=>l.executionDepartment=r),placeholder:"请输入执行部门"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"执行人",name:"executor"},{default:t(()=>[e(i,{value:l.executor,"onUpdate:value":a[25]||(a[25]=r=>l.executor=r),placeholder:"请输入执行人"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:8},{default:t(()=>[e(o,{label:"执行完成日期",name:"executionDate"},{default:t(()=>[e(b,{value:l.executionDate,"onUpdate:value":a[26]||(a[26]=r=>l.executionDate=r),format:"YYYY-MM-DD",placeholder:"请选择执行完成日期",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(d,{gutter:16},{default:t(()=>[e(n,{span:24},{default:t(()=>[e(o,{label:"执行结果",name:"executionResult"},{default:t(()=>[e(P,{value:l.executionResult,"onUpdate:value":a[27]||(a[27]=r=>l.executionResult=r),rows:3,placeholder:"请输入执行结果"},null,8,["value"])]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["activeKey"])])]),_:1},8,["model"])])])}}}),ce=J(ue,[["__scopeId","data-v-eb978288"]]);export{ce as default};
