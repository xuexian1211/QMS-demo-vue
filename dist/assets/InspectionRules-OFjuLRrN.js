import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as T,r as w,m as de,c as z,o as c,e as F,x as t,q as a,h as l,y as N,P as V,s,p as q,f as P,t as B,F as re,z as pe,C as x}from"./index-D0CfuKge.js";const ve={class:"page-container"},fe={class:"page-header"},me={class:"search-form"},ge={__name:"InspectionRules",setup(ye){const v=T({name:"",type:"",status:""}),g=w([]),U=w(!1),y=T({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:n=>`共 ${n} 条数据`}),M=[{title:"规则编码",dataIndex:"code",key:"code",width:120},{title:"规则名称",dataIndex:"name",key:"name"},{title:"适用类型",dataIndex:"type",key:"type",width:100},{title:"优先级",dataIndex:"priority",key:"priority",width:80},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:180,fixed:"right"}],_=w(!1),b=w(!1),I=w(),u=T({id:null,name:"",code:"",type:"",priority:"medium",description:"",conditions:[],action:"",status:"active"}),j={name:[{required:!0,message:"请输入规则名称",trigger:"blur"}],code:[{required:!0,message:"请输入规则编码",trigger:"blur"}],type:[{required:!0,message:"请选择适用类型",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],action:[{required:!0,message:"请选择处理方式",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},E=[{id:1,code:"RULE001",name:"尺寸检验规则",type:"IQC",priority:"high",description:"用于零部件尺寸检验的规则",status:"active",createTime:"2024-01-15 09:30:00"},{id:2,code:"RULE002",name:"外观质量检验规则",type:"IPQC",priority:"medium",description:"生产过程中外观质量检验规则",status:"active",createTime:"2024-01-16 14:20:00"},{id:3,code:"RULE003",name:"性能测试规则",type:"FQC",priority:"high",description:"成品性能测试的检验规则",status:"inactive",createTime:"2024-01-17 10:45:00"}],J=n=>({high:"red",medium:"orange",low:"green"})[n]||"default",A=n=>({high:"高",medium:"中",low:"低"})[n]||n,Q=()=>{U.value=!0,setTimeout(()=>{g.value=E,y.total=E.length,U.value=!1},500)},L=()=>{y.current=1,Q()},G=()=>{v.name="",v.type="",v.status="",L()},H=n=>{y.current=n.current,y.pageSize=n.pageSize,Q()},K=()=>{b.value=!1,_.value=!0,S()},W=n=>{b.value=!0,_.value=!0,Object.assign(u,{...n,conditions:n.conditions||[{field:"",operator:"",value:"",unit:""}]})},X=n=>{x.info("查看功能开发中...")},Y=n=>{const e=g.value.findIndex(d=>d.id===n);e>-1&&(g.value.splice(e,1),y.total--,x.success("删除成功"))},Z=()=>{u.conditions.push({field:"",operator:"",value:"",unit:""})},h=n=>{u.conditions.length>1&&u.conditions.splice(n,1)},ee=async()=>{try{if(await I.value.validate(),b.value){const n=g.value.findIndex(e=>e.id===u.id);n>-1&&(g.value[n]={...u}),x.success("更新成功")}else{const n=Math.max(...g.value.map(d=>d.id))+1,e={...u,id:n,code:u.code||`RULE${String(n).padStart(3,"0")}`,createTime:new Date().toLocaleString("zh-CN")};g.value.unshift(e),y.total++,x.success("创建成功")}_.value=!1,S()}catch(n){console.error("表单验证失败:",n)}},te=()=>{_.value=!1,S()},S=()=>{var n;Object.assign(u,{id:null,name:"",code:"",type:"",priority:"medium",description:"",conditions:[{field:"",operator:"",value:"",unit:""}],action:"",status:"active"}),(n=I.value)==null||n.resetFields()};return de(()=>{Q()}),(n,e)=>{const d=s("a-button"),C=s("a-input"),r=s("a-form-item"),i=s("a-select-option"),k=s("a-select"),O=s("a-form"),$=s("a-tag"),ae=s("a-popconfirm"),le=s("a-space"),oe=s("a-table"),f=s("a-col"),R=s("a-row"),D=s("a-radio"),ne=s("a-radio-group"),ue=s("a-textarea"),ie=s("a-modal");return c(),z("div",ve,[F("div",fe,[e[12]||(e[12]=F("h1",null,"检验规则管理",-1)),t(d,{type:"primary",onClick:K},{icon:a(()=>[t(N(V))]),default:a(()=>[e[11]||(e[11]=l(" 新建规则 ",-1))]),_:1})]),F("div",me,[t(O,{layout:"inline",model:v},{default:a(()=>[t(r,{label:"规则名称"},{default:a(()=>[t(C,{value:v.name,"onUpdate:value":e[0]||(e[0]=o=>v.name=o),placeholder:"请输入规则名称"},null,8,["value"])]),_:1}),t(r,{label:"适用类型"},{default:a(()=>[t(k,{value:v.type,"onUpdate:value":e[1]||(e[1]=o=>v.type=o),placeholder:"请选择适用类型",style:{width:"150px"}},{default:a(()=>[t(i,{value:"IQC"},{default:a(()=>[...e[13]||(e[13]=[l("来料检验",-1)])]),_:1}),t(i,{value:"IPQC"},{default:a(()=>[...e[14]||(e[14]=[l("过程检验",-1)])]),_:1}),t(i,{value:"FQC"},{default:a(()=>[...e[15]||(e[15]=[l("成品检验",-1)])]),_:1}),t(i,{value:"OQC"},{default:a(()=>[...e[16]||(e[16]=[l("出货检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(r,{label:"状态"},{default:a(()=>[t(k,{value:v.status,"onUpdate:value":e[2]||(e[2]=o=>v.status=o),placeholder:"请选择状态",style:{width:"100px"}},{default:a(()=>[t(i,{value:"active"},{default:a(()=>[...e[17]||(e[17]=[l("启用",-1)])]),_:1}),t(i,{value:"inactive"},{default:a(()=>[...e[18]||(e[18]=[l("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(r,null,{default:a(()=>[t(d,{type:"primary",onClick:L},{default:a(()=>[...e[19]||(e[19]=[l("查询",-1)])]),_:1}),t(d,{style:{"margin-left":"8px"},onClick:G},{default:a(()=>[...e[20]||(e[20]=[l("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),t(oe,{columns:M,"data-source":g.value,pagination:y,loading:U.value,onChange:H,"row-key":"id"},{bodyCell:a(({column:o,record:m})=>[o.key==="status"?(c(),q($,{key:0,color:m.status==="active"?"green":"red"},{default:a(()=>[l(B(m.status==="active"?"启用":"禁用"),1)]),_:2},1032,["color"])):P("",!0),o.key==="priority"?(c(),q($,{key:1,color:J(m.priority)},{default:a(()=>[l(B(A(m.priority)),1)]),_:2},1032,["color"])):P("",!0),o.key==="action"?(c(),q(le,{key:2},{default:a(()=>[t(d,{type:"link",size:"small",onClick:p=>W(m)},{default:a(()=>[...e[21]||(e[21]=[l("编辑",-1)])]),_:1},8,["onClick"]),t(d,{type:"link",size:"small",onClick:p=>X(m)},{default:a(()=>[...e[22]||(e[22]=[l("查看",-1)])]),_:1},8,["onClick"]),t(ae,{title:"确定要删除这个规则吗？",onConfirm:p=>Y(m.id)},{default:a(()=>[t(d,{type:"link",size:"small",danger:""},{default:a(()=>[...e[23]||(e[23]=[l("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):P("",!0)]),_:1},8,["data-source","pagination","loading"]),t(ie,{visible:_.value,"onUpdate:visible":e[10]||(e[10]=o=>_.value=o),title:b.value?"编辑规则":"新建规则",width:"900px",onOk:ee,onCancel:te},{default:a(()=>[t(O,{ref_key:"formRef",ref:I,model:u,rules:j,layout:"vertical"},{default:a(()=>[t(R,{gutter:16},{default:a(()=>[t(f,{span:12},{default:a(()=>[t(r,{label:"规则名称",name:"name"},{default:a(()=>[t(C,{value:u.name,"onUpdate:value":e[3]||(e[3]=o=>u.name=o),placeholder:"请输入规则名称"},null,8,["value"])]),_:1})]),_:1}),t(f,{span:12},{default:a(()=>[t(r,{label:"规则编码",name:"code"},{default:a(()=>[t(C,{value:u.code,"onUpdate:value":e[4]||(e[4]=o=>u.code=o),placeholder:"请输入规则编码"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(R,{gutter:16},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(r,{label:"适用类型",name:"type"},{default:a(()=>[t(k,{value:u.type,"onUpdate:value":e[5]||(e[5]=o=>u.type=o),placeholder:"请选择适用类型"},{default:a(()=>[t(i,{value:"IQC"},{default:a(()=>[...e[24]||(e[24]=[l("来料检验",-1)])]),_:1}),t(i,{value:"IPQC"},{default:a(()=>[...e[25]||(e[25]=[l("过程检验",-1)])]),_:1}),t(i,{value:"FQC"},{default:a(()=>[...e[26]||(e[26]=[l("成品检验",-1)])]),_:1}),t(i,{value:"OQC"},{default:a(()=>[...e[27]||(e[27]=[l("出货检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(r,{label:"优先级",name:"priority"},{default:a(()=>[t(k,{value:u.priority,"onUpdate:value":e[6]||(e[6]=o=>u.priority=o),placeholder:"请选择优先级"},{default:a(()=>[t(i,{value:"high"},{default:a(()=>[...e[28]||(e[28]=[l("高",-1)])]),_:1}),t(i,{value:"medium"},{default:a(()=>[...e[29]||(e[29]=[l("中",-1)])]),_:1}),t(i,{value:"low"},{default:a(()=>[...e[30]||(e[30]=[l("低",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(r,{label:"状态",name:"status"},{default:a(()=>[t(ne,{value:u.status,"onUpdate:value":e[7]||(e[7]=o=>u.status=o)},{default:a(()=>[t(D,{value:"active"},{default:a(()=>[...e[31]||(e[31]=[l("启用",-1)])]),_:1}),t(D,{value:"inactive"},{default:a(()=>[...e[32]||(e[32]=[l("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(r,{label:"规则描述",name:"description"},{default:a(()=>[t(ue,{value:u.description,"onUpdate:value":e[8]||(e[8]=o=>u.description=o),rows:3,placeholder:"请输入规则描述"},null,8,["value"])]),_:1}),t(r,{label:"检验条件",name:"conditions"},{default:a(()=>[(c(!0),z(re,null,pe(u.conditions,(o,m)=>(c(),z("div",{key:m,class:"condition-item"},[t(R,{gutter:8},{default:a(()=>[t(f,{span:6},{default:a(()=>[t(C,{value:o.field,"onUpdate:value":p=>o.field=p,placeholder:"检验字段"},null,8,["value","onUpdate:value"])]),_:2},1024),t(f,{span:4},{default:a(()=>[t(k,{value:o.operator,"onUpdate:value":p=>o.operator=p,placeholder:"操作符"},{default:a(()=>[t(i,{value:">"},{default:a(()=>[...e[33]||(e[33]=[l("大于",-1)])]),_:1}),t(i,{value:">="},{default:a(()=>[...e[34]||(e[34]=[l("大于等于",-1)])]),_:1}),t(i,{value:"<"},{default:a(()=>[...e[35]||(e[35]=[l("小于",-1)])]),_:1}),t(i,{value:"<="},{default:a(()=>[...e[36]||(e[36]=[l("小于等于",-1)])]),_:1}),t(i,{value:"="},{default:a(()=>[...e[37]||(e[37]=[l("等于",-1)])]),_:1}),t(i,{value:"!="},{default:a(()=>[...e[38]||(e[38]=[l("不等于",-1)])]),_:1}),t(i,{value:"contains"},{default:a(()=>[...e[39]||(e[39]=[l("包含",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])]),_:2},1024),t(f,{span:6},{default:a(()=>[t(C,{value:o.value,"onUpdate:value":p=>o.value=p,placeholder:"标准值"},null,8,["value","onUpdate:value"])]),_:2},1024),t(f,{span:6},{default:a(()=>[t(C,{value:o.unit,"onUpdate:value":p=>o.unit=p,placeholder:"单位"},null,8,["value","onUpdate:value"])]),_:2},1024),t(f,{span:2},{default:a(()=>[t(d,{type:"text",danger:"",onClick:p=>h(m)},{default:a(()=>[...e[40]||(e[40]=[l("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),t(d,{type:"dashed",onClick:Z,style:{width:"100%","margin-top":"8px"}},{icon:a(()=>[t(N(V))]),default:a(()=>[e[41]||(e[41]=l(" 添加检验条件 ",-1))]),_:1})]),_:1}),t(r,{label:"处理方式",name:"action"},{default:a(()=>[t(k,{value:u.action,"onUpdate:value":e[9]||(e[9]=o=>u.action=o),placeholder:"请选择处理方式"},{default:a(()=>[t(i,{value:"pass"},{default:a(()=>[...e[42]||(e[42]=[l("通过",-1)])]),_:1}),t(i,{value:"warning"},{default:a(()=>[...e[43]||(e[43]=[l("警告",-1)])]),_:1}),t(i,{value:"fail"},{default:a(()=>[...e[44]||(e[44]=[l("不通过",-1)])]),_:1}),t(i,{value:"rework"},{default:a(()=>[...e[45]||(e[45]=[l("返工",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}},ke=se(ge,[["__scopeId","data-v-70b7c17b"]]);export{ke as default};
