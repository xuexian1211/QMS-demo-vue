import{d as ce,a as T,r as y,m as ye,c as V,e as _,x as t,q as l,s as r,C,o as v,h as i,y as J,P as _e,F as K,z as Y,S as be,p as I,f as q,t as d,E as ge}from"./index-Ozo2vowX.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";const xe={class:"problem-management-container"},ke={class:"page-header"},Ce={class:"search-form"},Ie={class:"table-container"},De={style:{"white-space":"pre-wrap"}},Te={style:{"white-space":"pre-wrap"}},Ue={style:{"white-space":"pre-wrap"}},Pe=ce({__name:"ProblemList",setup(Se){const n=T({title:"",typeId:void 0,priority:void 0,status:void 0}),E=y([]),U=y(!1),P=y([]),b=T({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:a=>`共 ${a} 条数据`}),G=[{title:"问题标题",dataIndex:"title",key:"title",width:200,ellipsis:!0},{title:"问题类型",dataIndex:"typeName",key:"typeName",width:120},{title:"优先级",dataIndex:"priority",key:"priority",width:80},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"责任人",dataIndex:"responsible",key:"responsible",width:100},{title:"预计完成时间",dataIndex:"expectedDate",key:"expectedDate",width:120},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150},{title:"操作",key:"action",width:180,fixed:"right"}],g=y(!1),S=y("新增问题"),A=y(),s=T({id:"",title:"",typeId:"",priority:"medium",status:"open",description:"",impact:"",solution:"",responsible:"",expectedDate:void 0}),N=y(!1),u=T({id:"",title:"",typeName:"",priority:"medium",status:"open",description:"",impact:"",solution:"",responsible:"",expectedDate:"",createdAt:"",updatedAt:""}),H={title:[{required:!0,message:"请输入问题标题",trigger:"blur"}],typeId:[{required:!0,message:"请选择问题类型",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],description:[{required:!0,message:"请输入问题描述",trigger:"blur"}]},W=[{id:"1",name:"质量问题",code:"QUALITY"},{id:"2",name:"工艺问题",code:"PROCESS"},{id:"3",name:"设备问题",code:"EQUIPMENT"}],X=[{id:"1",title:"产品尺寸超差",typeId:"1",typeName:"质量问题",priority:"high",status:"open",description:"某批次产品尺寸超出公差范围，需要立即处理",impact:"影响产品质量，可能导致客户投诉",solution:"",responsible:"张三",expectedDate:"2024-12-20",createdAt:"2024-12-01 10:00:00",updatedAt:"2024-12-01 10:00:00"},{id:"2",title:"生产线设备故障",typeId:"3",typeName:"设备问题",priority:"medium",status:"processing",description:"生产线2号设备出现故障，影响生产进度",impact:"影响生产效率，可能导致交期延迟",solution:"联系维修人员进行检修",responsible:"李四",expectedDate:"2024-12-15",createdAt:"2024-12-02 14:30:00",updatedAt:"2024-12-03 09:15:00"}],M=a=>({high:"red",medium:"orange",low:"green"})[a]||"default",F=a=>({high:"高",medium:"中",low:"低"})[a]||a,R=a=>({open:"red",processing:"blue",resolved:"green",closed:"gray"})[a]||"default",B=a=>({open:"待处理",processing:"处理中",resolved:"已解决",closed:"已关闭"})[a]||a,Z=async()=>{try{await new Promise(a=>setTimeout(a,300)),P.value=W}catch{C.error("获取问题类型失败")}},w=async()=>{U.value=!0;try{await new Promise(e=>setTimeout(e,500));let a=[...X];n.title&&(a=a.filter(e=>e.title.includes(n.title))),n.typeId&&(a=a.filter(e=>e.typeId===n.typeId)),n.priority&&(a=a.filter(e=>e.priority===n.priority)),n.status&&(a=a.filter(e=>e.status===n.status)),E.value=a,b.total=a.length}catch{C.error("获取数据失败")}finally{U.value=!1}},ee=()=>{b.current=1,w()},te=()=>{n.title="",n.typeId=void 0,n.priority=void 0,n.status=void 0,b.current=1,w()},le=a=>{b.current=a.current,b.pageSize=a.pageSize,w()},ae=()=>{S.value="新增问题",g.value=!0,L()},oe=a=>{Object.assign(u,a),N.value=!0},ie=a=>{S.value="编辑问题",g.value=!0,Object.assign(s,{...a,expectedDate:a.expectedDate?ge(a.expectedDate):void 0})},se=async a=>{try{await new Promise(e=>setTimeout(e,500)),C.success("删除成功"),w()}catch{C.error("删除失败")}},ne=async()=>{try{await A.value.validate(),await new Promise(a=>setTimeout(a,500)),C.success(s.id?"更新成功":"新增成功"),g.value=!1,w()}catch(a){console.error("验证失败:",a)}},re=()=>{g.value=!1,L()},L=()=>{var a;s.id="",s.title="",s.typeId="",s.priority="medium",s.status="open",s.description="",s.impact="",s.solution="",s.responsible="",s.expectedDate=void 0,(a=A.value)==null||a.resetFields()};return ye(()=>{Z(),w()}),(a,e)=>{const x=r("a-button"),h=r("a-input"),p=r("a-form-item"),m=r("a-select-option"),k=r("a-select"),$=r("a-form"),D=r("a-tag"),de=r("a-popconfirm"),ue=r("a-space"),pe=r("a-table"),z=r("a-radio"),me=r("a-radio-group"),O=r("a-textarea"),fe=r("a-date-picker"),j=r("a-modal"),f=r("a-descriptions-item"),ve=r("a-descriptions");return v(),V("div",xe,[_("div",ke,[e[16]||(e[16]=_("h2",null,"问题管理",-1)),t(x,{type:"primary",onClick:ae},{icon:l(()=>[t(J(_e))]),default:l(()=>[e[15]||(e[15]=i(" 新增问题 ",-1))]),_:1})]),_("div",Ce,[t($,{model:n,layout:"inline"},{default:l(()=>[t(p,{label:"问题标题"},{default:l(()=>[t(h,{value:n.title,"onUpdate:value":e[0]||(e[0]=o=>n.title=o),placeholder:"请输入问题标题",allowClear:""},null,8,["value"])]),_:1}),t(p,{label:"问题类型"},{default:l(()=>[t(k,{value:n.typeId,"onUpdate:value":e[1]||(e[1]=o=>n.typeId=o),placeholder:"请选择问题类型",allowClear:"",style:{width:"150px"}},{default:l(()=>[(v(!0),V(K,null,Y(P.value,o=>(v(),I(m,{key:o.id,value:o.id},{default:l(()=>[i(d(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(p,{label:"优先级"},{default:l(()=>[t(k,{value:n.priority,"onUpdate:value":e[2]||(e[2]=o=>n.priority=o),placeholder:"请选择优先级",allowClear:"",style:{width:"120px"}},{default:l(()=>[t(m,{value:"high"},{default:l(()=>[...e[17]||(e[17]=[i("高",-1)])]),_:1}),t(m,{value:"medium"},{default:l(()=>[...e[18]||(e[18]=[i("中",-1)])]),_:1}),t(m,{value:"low"},{default:l(()=>[...e[19]||(e[19]=[i("低",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"状态"},{default:l(()=>[t(k,{value:n.status,"onUpdate:value":e[3]||(e[3]=o=>n.status=o),placeholder:"请选择状态",allowClear:"",style:{width:"120px"}},{default:l(()=>[t(m,{value:"open"},{default:l(()=>[...e[20]||(e[20]=[i("待处理",-1)])]),_:1}),t(m,{value:"processing"},{default:l(()=>[...e[21]||(e[21]=[i("处理中",-1)])]),_:1}),t(m,{value:"resolved"},{default:l(()=>[...e[22]||(e[22]=[i("已解决",-1)])]),_:1}),t(m,{value:"closed"},{default:l(()=>[...e[23]||(e[23]=[i("已关闭",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,null,{default:l(()=>[t(x,{type:"primary",onClick:ee},{icon:l(()=>[t(J(be))]),default:l(()=>[e[24]||(e[24]=i(" 搜索 ",-1))]),_:1}),t(x,{style:{"margin-left":"8px"},onClick:te},{default:l(()=>[...e[25]||(e[25]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_("div",Ie,[t(pe,{columns:G,"data-source":E.value,pagination:b,loading:U.value,onChange:le,rowKey:"id"},{bodyCell:l(({column:o,record:c})=>[o.key==="priority"?(v(),I(D,{key:0,color:M(c.priority)},{default:l(()=>[i(d(F(c.priority)),1)]),_:2},1032,["color"])):q("",!0),o.key==="status"?(v(),I(D,{key:1,color:R(c.status)},{default:l(()=>[i(d(B(c.status)),1)]),_:2},1032,["color"])):q("",!0),o.key==="action"?(v(),I(ue,{key:2},{default:l(()=>[t(x,{type:"link",size:"small",onClick:Q=>oe(c)},{default:l(()=>[...e[26]||(e[26]=[i("查看",-1)])]),_:1},8,["onClick"]),t(x,{type:"link",size:"small",onClick:Q=>ie(c)},{default:l(()=>[...e[27]||(e[27]=[i("编辑",-1)])]),_:1},8,["onClick"]),t(de,{title:"确定要删除这个问题吗？",onConfirm:Q=>se(c.id),okText:"确定",cancelText:"取消"},{default:l(()=>[t(x,{type:"link",size:"small",danger:""},{default:l(()=>[...e[28]||(e[28]=[i("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):q("",!0)]),_:1},8,["data-source","pagination","loading"])]),t(j,{visible:g.value,"onUpdate:visible":e[13]||(e[13]=o=>g.value=o),title:S.value,onOk:ne,onCancel:re,width:"800px"},{default:l(()=>[t($,{ref_key:"formRef",ref:A,model:s,rules:H,"label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[t(p,{label:"问题标题",name:"title"},{default:l(()=>[t(h,{value:s.title,"onUpdate:value":e[4]||(e[4]=o=>s.title=o),placeholder:"请输入问题标题"},null,8,["value"])]),_:1}),t(p,{label:"问题类型",name:"typeId"},{default:l(()=>[t(k,{value:s.typeId,"onUpdate:value":e[5]||(e[5]=o=>s.typeId=o),placeholder:"请选择问题类型"},{default:l(()=>[(v(!0),V(K,null,Y(P.value,o=>(v(),I(m,{key:o.id,value:o.id},{default:l(()=>[i(d(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(p,{label:"优先级",name:"priority"},{default:l(()=>[t(me,{value:s.priority,"onUpdate:value":e[6]||(e[6]=o=>s.priority=o)},{default:l(()=>[t(z,{value:"high"},{default:l(()=>[...e[29]||(e[29]=[i("高",-1)])]),_:1}),t(z,{value:"medium"},{default:l(()=>[...e[30]||(e[30]=[i("中",-1)])]),_:1}),t(z,{value:"low"},{default:l(()=>[...e[31]||(e[31]=[i("低",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"状态",name:"status"},{default:l(()=>[t(k,{value:s.status,"onUpdate:value":e[7]||(e[7]=o=>s.status=o),placeholder:"请选择状态"},{default:l(()=>[t(m,{value:"open"},{default:l(()=>[...e[32]||(e[32]=[i("待处理",-1)])]),_:1}),t(m,{value:"processing"},{default:l(()=>[...e[33]||(e[33]=[i("处理中",-1)])]),_:1}),t(m,{value:"resolved"},{default:l(()=>[...e[34]||(e[34]=[i("已解决",-1)])]),_:1}),t(m,{value:"closed"},{default:l(()=>[...e[35]||(e[35]=[i("已关闭",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"问题描述",name:"description"},{default:l(()=>[t(O,{value:s.description,"onUpdate:value":e[8]||(e[8]=o=>s.description=o),rows:4,placeholder:"请详细描述问题"},null,8,["value"])]),_:1}),t(p,{label:"影响范围",name:"impact"},{default:l(()=>[t(O,{value:s.impact,"onUpdate:value":e[9]||(e[9]=o=>s.impact=o),rows:3,placeholder:"请描述问题的影响范围"},null,8,["value"])]),_:1}),t(p,{label:"解决方案",name:"solution"},{default:l(()=>[t(O,{value:s.solution,"onUpdate:value":e[10]||(e[10]=o=>s.solution=o),rows:3,placeholder:"请描述解决方案"},null,8,["value"])]),_:1}),t(p,{label:"责任人",name:"responsible"},{default:l(()=>[t(h,{value:s.responsible,"onUpdate:value":e[11]||(e[11]=o=>s.responsible=o),placeholder:"请输入责任人"},null,8,["value"])]),_:1}),t(p,{label:"预计完成时间",name:"expectedDate"},{default:l(()=>[t(fe,{value:s.expectedDate,"onUpdate:value":e[12]||(e[12]=o=>s.expectedDate=o),style:{width:"100%"},placeholder:"请选择预计完成时间"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(j,{visible:N.value,"onUpdate:visible":e[14]||(e[14]=o=>N.value=o),title:"问题详情",footer:null,width:"800px"},{default:l(()=>[t(ve,{column:2,bordered:""},{default:l(()=>[t(f,{label:"问题标题"},{default:l(()=>[i(d(u.title),1)]),_:1}),t(f,{label:"问题类型"},{default:l(()=>[i(d(u.typeName),1)]),_:1}),t(f,{label:"优先级"},{default:l(()=>[t(D,{color:M(u.priority)},{default:l(()=>[i(d(F(u.priority)),1)]),_:1},8,["color"])]),_:1}),t(f,{label:"状态"},{default:l(()=>[t(D,{color:R(u.status)},{default:l(()=>[i(d(B(u.status)),1)]),_:1},8,["color"])]),_:1}),t(f,{label:"责任人"},{default:l(()=>[i(d(u.responsible),1)]),_:1}),t(f,{label:"预计完成时间"},{default:l(()=>[i(d(u.expectedDate),1)]),_:1}),t(f,{label:"问题描述",span:2},{default:l(()=>[_("div",De,d(u.description),1)]),_:1}),t(f,{label:"影响范围",span:2},{default:l(()=>[_("div",Te,d(u.impact),1)]),_:1}),t(f,{label:"解决方案",span:2},{default:l(()=>[_("div",Ue,d(u.solution),1)]),_:1}),t(f,{label:"创建时间"},{default:l(()=>[i(d(u.createdAt),1)]),_:1}),t(f,{label:"更新时间"},{default:l(()=>[i(d(u.updatedAt),1)]),_:1})]),_:1})]),_:1},8,["visible"])])}}}),he=we(Pe,[["__scopeId","data-v-ed10f931"]]);export{he as default};
