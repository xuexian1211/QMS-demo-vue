import{x as t,N as Ia,d as Ca,r as N,k as le,j as ca,a as Me,m as ga,c as m,e as U,p as o,f as r,q as a,s as g,t as p,o as i,h as u,y as E,K as Ta,a2 as ka,F as T,z as S,V as _a,P as ne,I as ba,a3 as Na,M as De,C as $,u as wa}from"./index-BhbkSrG8.js";import{_ as Aa}from"./_plugin-vue_export-helper-DlAUqK2U.js";var Qa={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"};function Ve(M){for(var x=1;x<arguments.length;x++){var R=arguments[x]!=null?Object(arguments[x]):{},z=Object.keys(R);typeof Object.getOwnPropertySymbols=="function"&&(z=z.concat(Object.getOwnPropertySymbols(R).filter(function(D){return Object.getOwnPropertyDescriptor(R,D).enumerable}))),z.forEach(function(D){La(M,D,R[D])})}return M}function La(M,x,R){return x in M?Object.defineProperty(M,x,{value:R,enumerable:!0,configurable:!0,writable:!0}):M[x]=R,M}var ye=function(x,R){var z=Ve({},x,R.attrs);return t(Ia,Ve({},z,{icon:Qa}),null)};ye.displayName="PlayCircleOutlined";ye.inheritAttrs=!1;const Oa={class:"scheme-edit-page"},Sa={class:"page-header"},xa={class:"header-left"},Ra={class:"title-block"},Ua={class:"page-title"},ha={key:0,class:"field-hint"},Pa={key:0,class:"tab-toolbar"},Ea={key:0,class:"sort-badge"},Ma={key:0,class:"tab-toolbar"},Da={key:0},Va={key:0,class:"tab-toolbar"},qa={key:0},za={key:1},Fa={key:0,class:"tab-toolbar"},$a={key:0},Ba={key:1},ja={key:2},Wa={key:3},Ha={key:0,class:"sim-result"},Ya={key:0},Ja={key:1},Ga=Ca({__name:"InspSchemeEdit",setup(M){const x=wa(),R=ca(),z=N(),D=N(!1),Ie=N("details"),_=le(()=>R.path.includes("/view/")),ie=le(()=>R.path.includes("/edit/")),qe=le(()=>_.value?"查看检验方案":ie.value?"编辑检验方案":"新增检验方案"),W=N("ORG001"),Q=le(()=>!ie.value&&!_.value||W.value===null?!1:C.orgId===null),C=Me({id:null,orgId:null,schemeCode:"",schemeName:"",version:"V1.0",inspType:void 0,status:"DRAFT",sourceTemplateId:void 0,sourceTemplateName:void 0,description:""}),ze={schemeCode:[{required:!0,message:"请输入方案编码",trigger:"blur"}],schemeName:[{required:!0,message:"请输入方案名称",trigger:"blur"}],inspType:[{required:!0,message:"请选择检验类型",trigger:"change"}]},Y=N(void 0),Ce=N([{id:"T001",name:"IQC-原材料通用模板",version:"V1.0",details:[{inspItemId:"ITEM001",inspItemName:"外观检查",characteristicClass:"Major",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!1,labRequired:!1},{inspItemId:"ITEM002",inspItemName:"尺寸测量",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1}]},{id:"T002",name:"IPQC-过程检验模板",version:"V2.0",details:[{inspItemId:"ITEM003",inspItemName:"硬度测试",characteristicClass:"SC",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!0,labRequired:!0},{inspItemId:"ITEM004",inspItemName:"表面粗糙度",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1}]},{id:"T003",name:"FQC-成品检验模板",version:"V1.2",details:[{inspItemId:"ITEM005",inspItemName:"功能测试",characteristicClass:"SC",samplingRuleCode:"FULL_INSPECT",samplingRuleName:"全检",spcEnabled:!1,labRequired:!1}]}]);function Fe(s){if(!s){C.sourceTemplateId=void 0,C.sourceTemplateName=void 0;return}const e=Ce.value.find(y=>y.id===s);e&&De.confirm({title:"引用模板",content:`将从模板「${e.name}」复制 ${e.details.length} 个检验项目到当前方案，继续吗？`,onOk(){C.sourceTemplateId=e.id,C.sourceTemplateName=e.name,O.value=e.details.map((y,k)=>({id:`from-tpl-${k}-${Date.now()}`,schemeId:"",sortOrder:k+1,...y,inspMethodId:void 0,inspMethodName:"",gaugeTypeId:void 0,gaugeTypeName:"",labRequired:y.labRequired??!1,relatedPhenomenonIds:[],fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""})),$.success(`已从模板复制 ${e.details.length} 个检验项目，可在此基础上继续编辑`)},onCancel(){Y.value=void 0}})}const O=N([]),$e=[{title:"#",key:"sortOrder",width:50},{title:"检验项目",key:"inspItemName",dataIndex:"inspItemName",width:170},{title:"特性分类",key:"characteristicClass",width:110},{title:"抽样规则",key:"samplingRuleName",width:180},{title:"检验方法",key:"inspMethodName",width:150},{title:"SPC",key:"spcEnabled",width:60},{title:"实验室",key:"labRequired",width:65},{title:"操作",key:"action",width:110,fixed:"right"}],ce=N([{id:"ITEM001",name:"外观检查",dataType:"qualitative"},{id:"ITEM002",name:"尺寸测量",dataType:"quantitative"},{id:"ITEM003",name:"硬度测试",dataType:"quantitative"},{id:"ITEM004",name:"表面粗糙度",dataType:"quantitative"},{id:"ITEM005",name:"功能测试",dataType:"qualitative"},{id:"ITEM006",name:"引脚平整度",dataType:"quantitative"}]),ge=N([{code:"AQL-L2-N-0.65",name:"AQL 0.65 Level-II 正常"},{code:"AQL-L2-N-1.0",name:"AQL 1.0 Level-II 正常"},{code:"AQL-L2-T-0.65",name:"AQL 0.65 Level-II 加严"},{code:"FULL_INSPECT",name:"全检"}]),Te=N([{id:"M001",name:"目视检查"},{id:"M002",name:"卡尺测量"},{id:"M003",name:"三坐标测量"},{id:"M004",name:"洛氏硬度计测量"}]);function Be(s,e){const y=ce.value.find(k=>k.id===e);y&&(s.inspItemName=y.name)}function je(){O.value.push({id:`new-${Date.now()}`,schemeId:"",sortOrder:O.value.length+1,inspItemId:void 0,inspItemName:"（请选择项目）",characteristicClass:"Minor",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II 正常",inspMethodId:void 0,inspMethodName:"",spcEnabled:!1,labRequired:!1,fromTemplate:!1,_editing:!0,createTime:"",updateTime:"",creator:"",updater:""})}function We(s){O.value=O.value.filter(e=>e.id!==s.id)}function He(){De.confirm({title:"确认清空",content:"将清空所有检验项目明细，操作不可撤销，确认吗？",okType:"danger",onOk(){O.value=[],Y.value=void 0,C.sourceTemplateId=void 0,C.sourceTemplateName=void 0}})}const V=N([]),J=N(!1),v=N(null),Ye=[{title:"业务类型",key:"contextType",width:130},{title:"适用范围（匹配维度）",key:"matchSummary"},{title:"触发条件",key:"triggerCondition",width:180},{title:"优先级",key:"priority",width:80},{title:"操作",key:"action",width:110}];function Je(){v.value={id:`new-${Date.now()}`,schemeId:"",contextType:C.inspType||"IQC",matchDimension:{materialId:void 0,supplierId:void 0,customerId:void 0,operationNo:void 0,ipqcType:void 0},priority:50,triggerCondition:"ALWAYS",triggerValue:void 0,description:"",createTime:"",updateTime:"",creator:"",updater:"",orgId:C.orgId??W.value??""},J.value=!0}function Ge(s){v.value=JSON.parse(JSON.stringify(s)),J.value=!0}function Ke(){if(!v.value)return;const s=V.value.findIndex(e=>e.id===v.value.id);s>=0?V.value[s]=v.value:V.value.push(v.value),J.value=!1,$.success("策略已保存")}function Xe(s){V.value=V.value.filter(e=>e.id!==s.id),$.success("已删除策略")}const ue=N(!1),b=Me({contextType:"IQC",materialId:void 0,supplierId:void 0,customerId:void 0,operationNo:void 0,ipqcType:void 0}),h=N(null);function Ze(){var e,y,k,P,B;h.value=null;const s=V.value.filter(L=>L.contextType===b.contextType).filter(L=>{const d=L.matchDimension;return!(d.materialId&&d.materialId!==b.materialId||d.supplierId&&d.supplierId!==b.supplierId||d.customerId&&d.customerId!==b.customerId||d.operationNo&&d.operationNo!==b.operationNo||d.ipqcType&&d.ipqcType!==b.ipqcType)}).sort((L,d)=>L.priority-d.priority);if(s.length>0){const L=s[0],d=[];(e=L.matchDimension)!=null&&e.materialName&&d.push("物料"),(y=L.matchDimension)!=null&&y.supplierName&&d.push("供应商"),(k=L.matchDimension)!=null&&k.customerName&&d.push("客户"),(P=L.matchDimension)!=null&&P.operationName&&d.push("工序"),(B=L.matchDimension)!=null&&B.ipqcType&&d.push("IPQC类型"),h.value={matched:!0,strategy:L,matchType:d.length>0?d.join(" + ")+" 匹配":"通用匹配"}}else h.value={matched:!1}}const q=N([]),G=N(!1),c=N(null),ea=[{title:"物料",dataIndex:"materialCode",key:"materialCode",width:120},{title:"检验项目",dataIndex:"inspItemName",key:"inspItemName",width:130},{title:"数据类型",key:"dataType",width:100},{title:"规格标准",key:"spec"},{title:"操作",key:"action",width:100}];function aa(){c.value={id:`new-${Date.now()}`,materialId:void 0,materialCode:"",inspItemCode:void 0,inspItemName:"",dataType:"QUANTITATIVE",targetValue:void 0,upperLimit:void 0,lowerLimit:void 0,uom:"mm",standardDesc:"",expectedValue:"",specCode:"",specName:"",specType:"quantitative",sortOrder:q.value.length+1,status:"enabled",orgId:C.orgId??W.value??"",createTime:"",updateTime:"",creator:"",updater:""},G.value=!0}function ta(s){c.value=JSON.parse(JSON.stringify(s)),G.value=!0}function la(){if(!c.value)return;const s=O.value.find(y=>y.inspItemId===c.value.inspItemCode);s&&(c.value.inspItemName=s.inspItemName);const e=q.value.findIndex(y=>y.id===c.value.id);e>=0?q.value[e]=c.value:q.value.push(c.value),G.value=!1,$.success("规格已保存")}function na(s){q.value=q.value.filter(e=>e.id!==s.id)}const K=N([]),ia=[{title:"检验项目",dataIndex:"itemName",key:"itemName",width:150},{title:"不良现象",dataIndex:"phenomenonName",key:"phenomenonName"},{title:"严重等级",key:"severity",width:100},{title:"操作",key:"action",width:80}];function ua(){var s;K.value.push({id:`new-${Date.now()}`,itemName:((s=O.value[0])==null?void 0:s.inspItemName)||"外观检查",phenomenonName:"表面划伤",severity:"MI"}),$.success("已添加示例，请编辑")}function oa(s){K.value=K.value.filter(e=>e.id!==s.id)}const X=N([{id:"MAT001",code:"M001",name:"铝合金压铸件"},{id:"MAT002",code:"M002",name:"电子元器件A"},{id:"MAT003",code:"M003",name:"塑料注塑件"}]),oe=N([{id:"SUP001",name:"供应商甲（主力）"},{id:"SUP002",name:"供应商乙（备用）"},{id:"SUP003",name:"供应商丙（新供应商）"}]),se=N([{id:"CUST001",code:"CUST-01",name:"客户A（大众）"},{id:"CUST002",code:"CUST-02",name:"客户B（通用）"},{id:"CUST003",code:"CUST-03",name:"客户C（丰田）"}]),de=N([{no:"OP010",name:"焊接"},{no:"OP020",name:"组装"},{no:"OP030",name:"测试"}]),ke=s=>({DRAFT:"default",IN_APPROVAL:"processing",APPROVED:"success",OBSOLETE:"error"})[s]||"default",_e=s=>({DRAFT:"草稿",IN_APPROVAL:"审批中",APPROVED:"已批准",OBSOLETE:"已作废"})[s]||s,sa=s=>({SC:"red",CC:"orange",Major:"blue",Minor:"default"})[s]||"default",da=s=>({CR:"red",MA:"orange",MI:"blue"})[s]||"default",be=s=>({ALWAYS:"总是触发",ON_NEW_SUPPLIER_FIRST_N_BATCHES:"新供应商前N批",ON_ECN_FIRST_N_BATCHES:"工程变更前N批"})[s]||s,ra=()=>x.push("/inspection-model/insp-plans"),Ne=async()=>{var s;try{if(D.value=!0,await((s=z.value)==null?void 0:s.validate()),O.value.length===0){$.warning("方案至少需要包含一个检验项目");return}$.success("方案保存成功"),x.push("/inspection-model/insp-plans")}catch{$.error("请完善必填项")}finally{D.value=!1}};return ga(()=>{const s=R.params.id;if(s){const e=s!=="2";Object.assign(C,{id:s,orgId:e?null:W.value,schemeCode:e?"SCH-IQC-G001":"SCH-IQC-001",schemeName:e?"集团通用-电子料IQC方案":"合肥工厂-电子料IQC专用方案",version:"V1.0",inspType:"IQC",status:"APPROVED",sourceTemplateId:"T001",sourceTemplateName:"IQC-原材料通用模板",description:e?"集团统一制定，适用于所有工厂的电子类物料来料检验。":"用于IC芯片类物料的来料检验，额外增加了引脚平整度检查。"}),Y.value="T001";const y=e?null:W.value;O.value=[{id:"d1",schemeId:s,sortOrder:1,inspItemId:"ITEM001",inspItemName:"外观检查",characteristicClass:"Major",samplingRuleCode:"AQL-L2-N-0.65",samplingRuleName:"AQL 0.65 Level-II",spcEnabled:!1,labRequired:!1,fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""},{id:"d2",schemeId:s,sortOrder:2,inspItemId:"ITEM002",inspItemName:"尺寸测量",characteristicClass:"CC",samplingRuleCode:"AQL-L2-N-1.0",samplingRuleName:"AQL 1.0 Level-II",spcEnabled:!0,labRequired:!1,fromTemplate:!0,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""},{id:"d3",schemeId:s,sortOrder:3,inspItemId:"ITEM006",inspItemName:"引脚平整度",characteristicClass:"SC",samplingRuleCode:"FULL_INSPECT",samplingRuleName:"全检",spcEnabled:!1,labRequired:!1,fromTemplate:!1,_editing:!1,createTime:"",updateTime:"",creator:"",updater:""}],V.value=[{id:"s1",schemeId:s,contextType:"IQC",matchDimension:{materialId:"MAT002",materialName:"电子元器件A"},priority:20,triggerCondition:"ALWAYS",orgId:y,createTime:"",updateTime:"",creator:"",updater:""},{id:"s2",schemeId:s,contextType:"IQC",matchDimension:{materialId:"MAT002",materialName:"电子元器件A",supplierId:"SUP003",supplierName:"供应商丙（新供应商）"},priority:5,triggerCondition:"ON_NEW_SUPPLIER_FIRST_N_BATCHES",triggerValue:3,orgId:y,createTime:"",updateTime:"",creator:"",updater:""}],q.value=[{id:"sp1",materialId:"MAT002",materialCode:"M002",inspItemCode:"ITEM006",inspItemName:"引脚平整度",dataType:"QUANTITATIVE",targetValue:.05,upperLimit:.1,lowerLimit:0,uom:"mm",specCode:"SP001",specName:"引脚平整度规格",specType:"quantitative",sortOrder:1,status:"enabled",orgId:y,createTime:"",updateTime:"",creator:"",updater:""}],K.value=[{id:"p1",itemName:"外观检查",phenomenonName:"表面划伤",severity:"MI"},{id:"p2",itemName:"外观检查",phenomenonName:"引脚变形",severity:"MA"}]}else C.orgId=W.value}),(s,e)=>{var Se,xe;const y=g("a-button"),k=g("a-tag"),P=g("a-space"),B=g("a-alert"),L=g("a-input"),d=g("a-form-item"),j=g("a-col"),re=g("a-row"),f=g("a-select-option"),w=g("a-select"),pe=g("a-textarea"),ee=g("a-form"),we=g("a-card"),me=g("a-badge"),Ae=g("a-tooltip"),Qe=g("a-switch"),ae=g("a-table"),te=g("a-tab-pane"),pa=g("a-tabs"),ve=g("a-divider"),Z=g("a-input-number"),fe=g("a-modal"),Le=g("a-descriptions-item"),ma=g("a-descriptions"),va=g("a-result"),fa=g("a-empty"),Oe=g("a-radio"),ya=g("a-radio-group");return i(),m("div",Oa,[U("div",Sa,[U("div",xa,[t(y,{type:"text",onClick:ra,class:"back-btn"},{icon:a(()=>[t(E(Ta))]),default:a(()=>[e[41]||(e[41]=u(" 返回 ",-1))]),_:1}),U("div",Ra,[U("h2",Ua,p(qe.value),1),C.version?(i(),o(k,{key:0,color:"blue"},{default:a(()=>[u(p(C.version),1)]),_:1})):r("",!0),t(k,{color:ke(C.status)},{default:a(()=>[u(p(_e(C.status)),1)]),_:1},8,["color"]),C.orgId===null?(i(),o(k,{key:1,color:"gold"},{default:a(()=>[...e[42]||(e[42]=[u("集团方案",-1)])]),_:1})):(i(),o(k,{key:2,color:"cyan"},{default:a(()=>[...e[43]||(e[43]=[u("本地方案",-1)])]),_:1})),C.sourceTemplateName?(i(),o(k,{key:3,color:"purple"},{icon:a(()=>[t(E(ka))]),default:a(()=>[u(" 源自: "+p(C.sourceTemplateName),1)]),_:1})):r("",!0)])]),!_.value&&!Q.value?(i(),o(P,{key:0},{default:a(()=>[t(y,{onClick:Ne,loading:D.value},{default:a(()=>[...e[44]||(e[44]=[u("保存草稿",-1)])]),_:1},8,["loading"]),t(y,{type:"primary",onClick:Ne,loading:D.value},{default:a(()=>[...e[45]||(e[45]=[u("保存",-1)])]),_:1},8,["loading"])]),_:1})):r("",!0)]),Q.value?(i(),o(B,{key:0,type:"warning","show-icon":"",message:"集团级方案对工厂用户只读，如需修改请联系集团管理员，或基于此方案创建一个新的本地方案。",style:{"margin-bottom":"16px"}})):r("",!0),t(we,{class:"info-card",title:"基本信息"},{default:a(()=>[t(ee,{ref_key:"formRef",ref:z,model:C,rules:ze,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(re,{gutter:24},{default:a(()=>[t(j,{span:8},{default:a(()=>[t(d,{label:"方案编码",name:"schemeCode"},{default:a(()=>[t(L,{value:C.schemeCode,"onUpdate:value":e[0]||(e[0]=l=>C.schemeCode=l),disabled:_.value||ie.value||Q.value,placeholder:"如: SCH-IQC-001"},null,8,["value","disabled"])]),_:1})]),_:1}),t(j,{span:8},{default:a(()=>[t(d,{label:"方案名称",name:"schemeName"},{default:a(()=>[t(L,{value:C.schemeName,"onUpdate:value":e[1]||(e[1]=l=>C.schemeName=l),disabled:_.value||Q.value,placeholder:"请输入方案名称"},null,8,["value","disabled"])]),_:1})]),_:1}),t(j,{span:8},{default:a(()=>[t(d,{label:"版本",name:"version"},{default:a(()=>[t(L,{value:C.version,"onUpdate:value":e[2]||(e[2]=l=>C.version=l),disabled:_.value||Q.value,placeholder:"如: V1.0"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),t(re,{gutter:24},{default:a(()=>[t(j,{span:8},{default:a(()=>[t(d,{label:"检验类型",name:"inspType"},{default:a(()=>[t(w,{value:C.inspType,"onUpdate:value":e[3]||(e[3]=l=>C.inspType=l),disabled:_.value||Q.value,placeholder:"请选择"},{default:a(()=>[t(f,{value:"IQC"},{default:a(()=>[...e[46]||(e[46]=[u("IQC 来料检验",-1)])]),_:1}),t(f,{value:"IPQC"},{default:a(()=>[...e[47]||(e[47]=[u("IPQC 过程检验",-1)])]),_:1}),t(f,{value:"FQC"},{default:a(()=>[...e[48]||(e[48]=[u("FQC 成品检验",-1)])]),_:1}),t(f,{value:"OQC"},{default:a(()=>[...e[49]||(e[49]=[u("OQC 出货检验",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(j,{span:8},{default:a(()=>[t(d,{label:"引用模板"},{default:a(()=>[t(w,{value:Y.value,"onUpdate:value":e[4]||(e[4]=l=>Y.value=l),disabled:_.value||Q.value||O.value.length>0,placeholder:"选择模板可自动带出检验项目","allow-clear":"",onChange:Fe},{default:a(()=>[(i(!0),m(T,null,S(Ce.value,l=>(i(),o(f,{key:l.id,value:l.id},{default:a(()=>[u(p(l.name)+" ("+p(l.version)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"]),O.value.length>0&&!_.value?(i(),m("div",ha,[t(E(_a)),e[50]||(e[50]=u(" 已有明细，需清空后才能重新引用模板 ",-1))])):r("",!0)]),_:1})]),_:1}),t(j,{span:8},{default:a(()=>[t(d,{label:"状态"},{default:a(()=>[t(k,{color:ke(C.status)},{default:a(()=>[u(p(_e(C.status)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),t(re,{gutter:24},{default:a(()=>[t(j,{span:16},{default:a(()=>[t(d,{label:"描述","label-col":{span:3},"wrapper-col":{span:20}},{default:a(()=>[t(pe,{value:C.description,"onUpdate:value":e[5]||(e[5]=l=>C.description=l),disabled:_.value||Q.value,rows:2},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(we,{class:"tab-card"},{default:a(()=>[t(pa,{activeKey:Ie.value,"onUpdate:activeKey":e[7]||(e[7]=l=>Ie.value=l)},{default:a(()=>[t(te,{key:"details"},{tab:a(()=>[U("span",null,[e[51]||(e[51]=u(" 检验项目明细 ",-1)),t(me,{count:O.value.length,offset:[6,-2],color:"#1890ff"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(i(),m("div",Pa,[t(P,null,{default:a(()=>[t(y,{type:"primary",size:"small",onClick:je},{icon:a(()=>[t(E(ne))]),default:a(()=>[e[52]||(e[52]=u("新增检验项目 ",-1))]),_:1}),O.value.length>0?(i(),o(y,{key:0,size:"small",danger:"",onClick:He},{icon:a(()=>[t(E(ba))]),default:a(()=>[e[53]||(e[53]=u("清空所有 ",-1))]),_:1})):r("",!0),t(Ae,{title:"明细行来自模板时标记蓝色，新增行为绿色"},{default:a(()=>[t(E(Na),{style:{cursor:"pointer",color:"#8c8c8c"}})]),_:1})]),_:1})])):r("",!0),t(ae,{columns:$e,"data-source":O.value,"row-key":"id",size:"small",pagination:!1,"row-class-name":l=>l.fromTemplate?"row-from-template":"row-custom"},{bodyCell:a(({column:l,record:n,index:A})=>[l.key==="sortOrder"?(i(),m("span",Ea,p(A+1),1)):r("",!0),l.key==="inspItemName"?(i(),m(T,{key:1},[!_.value&&n._editing?(i(),o(w,{key:0,value:n.inspItemId,"onUpdate:value":I=>n.inspItemId=I,size:"small",style:{width:"160px"},onChange:I=>Be(n,I)},{default:a(()=>[(i(!0),m(T,null,S(ce.value,I=>(i(),o(f,{key:I.id,value:I.id},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(i(),o(Ae,{key:1,title:n.fromTemplate?"来自模板":"自定义添加"},{default:a(()=>[t(k,{color:n.fromTemplate?"blue":"green",style:{margin:"0"}},{default:a(()=>[u(p(n.inspItemName),1)]),_:2},1032,["color"])]),_:2},1032,["title"]))],64)):r("",!0),l.key==="characteristicClass"?(i(),m(T,{key:2},[!_.value&&n._editing?(i(),o(w,{key:0,value:n.characteristicClass,"onUpdate:value":I=>n.characteristicClass=I,size:"small",style:{width:"90px"}},{default:a(()=>[t(f,{value:"SC"},{default:a(()=>[...e[54]||(e[54]=[u("SC-特殊",-1)])]),_:1}),t(f,{value:"CC"},{default:a(()=>[...e[55]||(e[55]=[u("CC-关键",-1)])]),_:1}),t(f,{value:"Major"},{default:a(()=>[...e[56]||(e[56]=[u("主要",-1)])]),_:1}),t(f,{value:"Minor"},{default:a(()=>[...e[57]||(e[57]=[u("次要",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])):(i(),o(k,{key:1,color:sa(n.characteristicClass)},{default:a(()=>[u(p(n.characteristicClass),1)]),_:2},1032,["color"]))],64)):r("",!0),l.key==="samplingRuleName"?(i(),m(T,{key:3},[!_.value&&n._editing?(i(),o(w,{key:0,value:n.samplingRuleCode,"onUpdate:value":I=>n.samplingRuleCode=I,size:"small",style:{width:"160px"},onChange:I=>{var F;return n.samplingRuleName=((F=ge.value.find(H=>H.code===I))==null?void 0:F.name)||I}},{default:a(()=>[(i(!0),m(T,null,S(ge.value,I=>(i(),o(f,{key:I.code,value:I.code},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(i(),m(T,{key:1},[u(p(n.samplingRuleName||n.samplingRuleCode),1)],64))],64)):r("",!0),l.key==="inspMethodName"?(i(),m(T,{key:4},[!_.value&&n._editing?(i(),o(w,{key:0,value:n.inspMethodId,"onUpdate:value":I=>n.inspMethodId=I,size:"small",style:{width:"130px"},"allow-clear":"",onChange:I=>{var F;return n.inspMethodName=((F=Te.value.find(H=>H.id===I))==null?void 0:F.name)||""}},{default:a(()=>[(i(!0),m(T,null,S(Te.value,I=>(i(),o(f,{key:I.id,value:I.id},{default:a(()=>[u(p(I.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"])):(i(),m(T,{key:1},[u(p(n.inspMethodName||"-"),1)],64))],64)):r("",!0),l.key==="spcEnabled"?(i(),o(Qe,{key:5,checked:n.spcEnabled,"onUpdate:checked":I=>n.spcEnabled=I,disabled:_.value||Q.value,size:"small"},null,8,["checked","onUpdate:checked","disabled"])):r("",!0),l.key==="labRequired"?(i(),o(Qe,{key:6,checked:n.labRequired,"onUpdate:checked":I=>n.labRequired=I,disabled:_.value||Q.value,size:"small"},null,8,["checked","onUpdate:checked","disabled"])):r("",!0),l.key==="action"?(i(),m(T,{key:7},[!_.value&&!Q.value?(i(),o(P,{key:0},{default:a(()=>[n._editing?(i(),o(y,{key:0,type:"link",size:"small",onClick:I=>n._editing=!1},{default:a(()=>[...e[58]||(e[58]=[u("完成",-1)])]),_:1},8,["onClick"])):(i(),o(y,{key:1,type:"link",size:"small",onClick:I=>n._editing=!0},{default:a(()=>[...e[59]||(e[59]=[u("编辑",-1)])]),_:1},8,["onClick"])),t(y,{type:"link",danger:"",size:"small",onClick:I=>We(n)},{default:a(()=>[...e[60]||(e[60]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source","row-class-name"])]),_:1}),t(te,{key:"strategies"},{tab:a(()=>[U("span",null,[e[61]||(e[61]=u(" 适用策略 (上下文绑定) ",-1)),t(me,{count:V.value.length,offset:[6,-2],color:"#52c41a"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(i(),m("div",Ma,[t(P,null,{default:a(()=>[t(y,{type:"primary",size:"small",onClick:Je},{icon:a(()=>[t(E(ne))]),default:a(()=>[e[62]||(e[62]=u("新增策略 ",-1))]),_:1}),t(y,{size:"small",onClick:e[6]||(e[6]=l=>ue.value=!0)},{icon:a(()=>[t(E(ye))]),default:a(()=>[e[63]||(e[63]=u("匹配模拟器 ",-1))]),_:1})]),_:1})])):r("",!0),t(ae,{columns:Ye,"data-source":V.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:l,record:n})=>[l.key==="contextType"?(i(),o(k,{key:0,color:"blue"},{default:a(()=>[u(p(n.contextType),1)]),_:2},1024)):r("",!0),l.key==="matchSummary"?(i(),o(P,{key:1,wrap:""},{default:a(()=>{var A,I,F,H,Re,Ue,he,Pe,Ee;return[(A=n.matchDimension)!=null&&A.materialName?(i(),o(k,{key:0,color:"orange"},{default:a(()=>[u(" 物料: "+p(n.matchDimension.materialName),1)]),_:2},1024)):r("",!0),(I=n.matchDimension)!=null&&I.supplierName?(i(),o(k,{key:1,color:"red"},{default:a(()=>[u(" 供应商: "+p(n.matchDimension.supplierName),1)]),_:2},1024)):r("",!0),(F=n.matchDimension)!=null&&F.customerName?(i(),o(k,{key:2,color:"geekblue"},{default:a(()=>[u(" 客户: "+p(n.matchDimension.customerName),1)]),_:2},1024)):r("",!0),(H=n.matchDimension)!=null&&H.operationName?(i(),o(k,{key:3,color:"purple"},{default:a(()=>[u(" 工序: "+p(n.matchDimension.operationName),1)]),_:2},1024)):r("",!0),(Re=n.matchDimension)!=null&&Re.ipqcType?(i(),o(k,{key:4,color:"volcano"},{default:a(()=>[u(" IPQC类型: "+p(n.matchDimension.ipqcType),1)]),_:2},1024)):r("",!0),!((Ue=n.matchDimension)!=null&&Ue.materialName)&&!((he=n.matchDimension)!=null&&he.supplierName)&&!((Pe=n.matchDimension)!=null&&Pe.customerName)&&!((Ee=n.matchDimension)!=null&&Ee.operationName)?(i(),o(k,{key:5,color:"default"},{default:a(()=>[...e[64]||(e[64]=[u(" 通用（兜底） ",-1)])]),_:1})):r("",!0)]}),_:2},1024)):r("",!0),l.key==="triggerCondition"?(i(),m(T,{key:2},[U("span",null,p(be(n.triggerCondition)),1),n.triggerValue?(i(),m("span",Da," (前 "+p(n.triggerValue)+" 批)",1)):r("",!0)],64)):r("",!0),l.key==="priority"?(i(),o(k,{key:3,color:n.priority<=10?"red":n.priority<=50?"orange":"default"},{default:a(()=>[u(" P"+p(n.priority),1)]),_:2},1032,["color"])):r("",!0),l.key==="action"?(i(),m(T,{key:4},[!_.value&&!Q.value?(i(),o(P,{key:0},{default:a(()=>[t(y,{type:"link",size:"small",onClick:A=>Ge(n)},{default:a(()=>[...e[65]||(e[65]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(y,{type:"link",danger:"",size:"small",onClick:A=>Xe(n)},{default:a(()=>[...e[66]||(e[66]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1}),t(te,{key:"materialSpec"},{tab:a(()=>[U("span",null,[e[67]||(e[67]=u("物料规格 ",-1)),t(me,{count:q.value.length,offset:[6,-2],color:"#722ed1"},null,8,["count"])])]),default:a(()=>[!_.value&&!Q.value?(i(),m("div",Va,[t(y,{type:"primary",size:"small",onClick:aa},{icon:a(()=>[t(E(ne))]),default:a(()=>[e[68]||(e[68]=u("新增规格 ",-1))]),_:1})])):r("",!0),t(ae,{columns:ea,"data-source":q.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:l,record:n})=>[l.key==="dataType"?(i(),o(k,{key:0,color:n.dataType==="QUANTITATIVE"?"blue":"purple"},{default:a(()=>[u(p(n.dataType==="QUANTITATIVE"?"计量型":"计数型"),1)]),_:2},1032,["color"])):r("",!0),l.key==="spec"?(i(),m(T,{key:1},[n.dataType==="QUANTITATIVE"?(i(),m("span",qa,[u(p(n.lowerLimit)+" ~ "+p(n.upperLimit)+" "+p(n.uom)+" ",1),t(k,{color:"cyan",style:{"margin-left":"4px"}},{default:a(()=>[u("目标: "+p(n.targetValue),1)]),_:2},1024)])):(i(),m("span",za,p(n.standardDesc||n.expectedValue),1))],64)):r("",!0),l.key==="action"?(i(),m(T,{key:2},[!_.value&&!Q.value?(i(),o(P,{key:0},{default:a(()=>[t(y,{type:"link",size:"small",onClick:A=>ta(n)},{default:a(()=>[...e[69]||(e[69]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(y,{type:"link",danger:"",size:"small",onClick:A=>na(n)},{default:a(()=>[...e[70]||(e[70]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1}),t(te,{key:"phenomenon",tab:"不良现象防错配置"},{default:a(()=>[!_.value&&!Q.value?(i(),m("div",Fa,[t(y,{type:"primary",size:"small",onClick:ua},{icon:a(()=>[t(E(ne))]),default:a(()=>[e[71]||(e[71]=u("新增绑定 ",-1))]),_:1})])):r("",!0),t(ae,{columns:ia,"data-source":K.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:l,record:n})=>[l.key==="severity"?(i(),o(k,{key:0,color:da(n.severity)},{default:a(()=>[u(p(n.severity),1)]),_:2},1032,["color"])):r("",!0),l.key==="action"?(i(),m(T,{key:1},[!_.value&&!Q.value?(i(),o(y,{key:0,type:"link",danger:"",size:"small",onClick:A=>oa(n)},{default:a(()=>[...e[72]||(e[72]=[u("删除",-1)])]),_:1},8,["onClick"])):r("",!0)],64)):r("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["activeKey"])]),_:1}),t(fe,{visible:J.value,"onUpdate:visible":e[22]||(e[22]=l=>J.value=l),title:(xe=(Se=v.value)==null?void 0:Se.id)!=null&&xe.startsWith("new")?"新增绑定策略":"编辑绑定策略",width:"680px",onOk:Ke,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[t(B,{type:"info","show-icon":"",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[73]||(e[73]=[u(' 策略定义"什么情况下"使用本方案。同一方案可绑定多条策略，优先级越小优先级越高。 ',-1)])]),_:1}),v.value?(i(),o(ee,{key:0,model:v.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(d,{label:"业务类型",required:""},{default:a(()=>[t(w,{value:v.value.contextType,"onUpdate:value":e[8]||(e[8]=l=>v.value.contextType=l)},{default:a(()=>[t(f,{value:"IQC"},{default:a(()=>[...e[74]||(e[74]=[u("IQC 来料检验",-1)])]),_:1}),t(f,{value:"IPQC"},{default:a(()=>[...e[75]||(e[75]=[u("IPQC 过程检验",-1)])]),_:1}),t(f,{value:"FQC"},{default:a(()=>[...e[76]||(e[76]=[u("FQC 成品检验",-1)])]),_:1}),t(f,{value:"OQC"},{default:a(()=>[...e[77]||(e[77]=[u("OQC 出货检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(ve,null,{default:a(()=>[...e[78]||(e[78]=[u("匹配维度（不填则通用匹配）",-1)])]),_:1}),t(B,{type:"warning","show-icon":"",style:{"margin-bottom":"12px"}},{message:a(()=>[v.value.contextType==="IQC"?(i(),m("span",$a,[...e[79]||(e[79]=[u("IQC: 可按 ",-1),U("b",null,"物料 + 供应商",-1),u(" 匹配",-1)])])):v.value.contextType==="IPQC"?(i(),m("span",Ba,[...e[80]||(e[80]=[u("IPQC: 可按 ",-1),U("b",null,"物料 + 工序 + IPQC类型",-1),u(" 匹配",-1)])])):v.value.contextType==="FQC"?(i(),m("span",ja,[...e[81]||(e[81]=[u("FQC: 内部成品检验，仅按 ",-1),U("b",null,"物料",-1),u(" 匹配（无供应商/客户）",-1)])])):v.value.contextType==="OQC"?(i(),m("span",Wa,[...e[82]||(e[82]=[u("OQC: 出货检验，可按 ",-1),U("b",null,"物料 + 客户",-1),u(" 匹配（无供应商）",-1)])])):r("",!0)]),_:1}),t(d,{label:"物料"},{default:a(()=>[t(w,{value:v.value.matchDimension.materialId,"onUpdate:value":e[9]||(e[9]=l=>v.value.matchDimension.materialId=l),"allow-clear":"",placeholder:"不限物料",onChange:e[10]||(e[10]=l=>{var n;return v.value.matchDimension.materialName=((n=X.value.find(A=>A.id===l))==null?void 0:n.name)||""})},{default:a(()=>[(i(!0),m(T,null,S(X.value,l=>(i(),o(f,{key:l.id,value:l.id},{default:a(()=>[u(p(l.code)+" - "+p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),v.value.contextType==="IQC"?(i(),o(d,{key:0,label:"供应商"},{default:a(()=>[t(w,{value:v.value.matchDimension.supplierId,"onUpdate:value":e[11]||(e[11]=l=>v.value.matchDimension.supplierId=l),"allow-clear":"",placeholder:"不限供应商",onChange:e[12]||(e[12]=l=>{var n;return v.value.matchDimension.supplierName=((n=oe.value.find(A=>A.id===l))==null?void 0:n.name)||""})},{default:a(()=>[(i(!0),m(T,null,S(oe.value,l=>(i(),o(f,{key:l.id,value:l.id},{default:a(()=>[u(p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="OQC"?(i(),o(d,{key:1,label:"客户"},{default:a(()=>[t(w,{value:v.value.matchDimension.customerId,"onUpdate:value":e[13]||(e[13]=l=>v.value.matchDimension.customerId=l),"allow-clear":"",placeholder:"不限客户",onChange:e[14]||(e[14]=l=>{var n;return v.value.matchDimension.customerName=((n=se.value.find(A=>A.id===l))==null?void 0:n.name)||""})},{default:a(()=>[(i(!0),m(T,null,S(se.value,l=>(i(),o(f,{key:l.id,value:l.id},{default:a(()=>[u(p(l.code)+" - "+p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="IPQC"?(i(),o(d,{key:2,label:"工序"},{default:a(()=>[t(w,{value:v.value.matchDimension.operationNo,"onUpdate:value":e[15]||(e[15]=l=>v.value.matchDimension.operationNo=l),"allow-clear":"",placeholder:"不限工序",onChange:e[16]||(e[16]=l=>{var n;return v.value.matchDimension.operationName=((n=de.value.find(A=>A.no===l))==null?void 0:n.name)||""})},{default:a(()=>[(i(!0),m(T,null,S(de.value,l=>(i(),o(f,{key:l.no,value:l.no},{default:a(()=>[u(p(l.no)+" "+p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),v.value.contextType==="IPQC"?(i(),o(d,{key:3,label:"IPQC 类型"},{default:a(()=>[t(w,{value:v.value.matchDimension.ipqcType,"onUpdate:value":e[17]||(e[17]=l=>v.value.matchDimension.ipqcType=l),"allow-clear":"",placeholder:"不限类型"},{default:a(()=>[t(f,{value:"FAI"},{default:a(()=>[...e[83]||(e[83]=[u("FAI 首件检验",-1)])]),_:1}),t(f,{value:"PATROL"},{default:a(()=>[...e[84]||(e[84]=[u("PATROL 巡检",-1)])]),_:1}),t(f,{value:"LAI"},{default:a(()=>[...e[85]||(e[85]=[u("LAI 末件检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):r("",!0),t(ve,null,{default:a(()=>[...e[86]||(e[86]=[u("策略参数",-1)])]),_:1}),t(d,{label:"触发条件"},{default:a(()=>[t(w,{value:v.value.triggerCondition,"onUpdate:value":e[18]||(e[18]=l=>v.value.triggerCondition=l)},{default:a(()=>[t(f,{value:"ALWAYS"},{default:a(()=>[...e[87]||(e[87]=[u("总是触发",-1)])]),_:1}),t(f,{value:"ON_NEW_SUPPLIER_FIRST_N_BATCHES"},{default:a(()=>[...e[88]||(e[88]=[u("新供应商前N批",-1)])]),_:1}),t(f,{value:"ON_ECN_FIRST_N_BATCHES"},{default:a(()=>[...e[89]||(e[89]=[u("工程变更后前N批",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),v.value.triggerCondition!=="ALWAYS"?(i(),o(d,{key:4,label:"前N批"},{default:a(()=>[t(Z,{value:v.value.triggerValue,"onUpdate:value":e[19]||(e[19]=l=>v.value.triggerValue=l),min:1,max:99,style:{width:"120px"}},null,8,["value"]),e[90]||(e[90]=U("span",{style:{"margin-left":"8px",color:"#8c8c8c"}},"批",-1))]),_:1})):r("",!0),t(d,{label:"优先级",extra:"数值越小越优先，建议：精确匹配=10，通用匹配=99"},{default:a(()=>[t(Z,{value:v.value.priority,"onUpdate:value":e[20]||(e[20]=l=>v.value.priority=l),min:1,max:999,style:{width:"120px"}},null,8,["value"])]),_:1}),t(d,{label:"备注"},{default:a(()=>[t(pe,{value:v.value.description,"onUpdate:value":e[21]||(e[21]=l=>v.value.description=l),rows:2},null,8,["value"])]),_:1})]),_:1},8,["model"])):r("",!0)]),_:1},8,["visible","title"]),t(fe,{visible:ue.value,"onUpdate:visible":e[29]||(e[29]=l=>ue.value=l),title:"策略匹配模拟器",width:"700px",onOk:Ze,"ok-text":"开始模拟"},{default:a(()=>{var l;return[t(B,{type:"info","show-icon":"",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[91]||(e[91]=[u("输入业务上下文参数，验证当前方案策略的匹配逻辑是否符合预期。",-1)])]),_:1}),t(ee,{model:b,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(d,{label:"业务类型"},{default:a(()=>[t(w,{value:b.contextType,"onUpdate:value":e[23]||(e[23]=n=>b.contextType=n)},{default:a(()=>[t(f,{value:"IQC"},{default:a(()=>[...e[92]||(e[92]=[u("IQC",-1)])]),_:1}),t(f,{value:"IPQC"},{default:a(()=>[...e[93]||(e[93]=[u("IPQC",-1)])]),_:1}),t(f,{value:"FQC"},{default:a(()=>[...e[94]||(e[94]=[u("FQC",-1)])]),_:1}),t(f,{value:"OQC"},{default:a(()=>[...e[95]||(e[95]=[u("OQC",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(d,{label:"物料"},{default:a(()=>[t(w,{value:b.materialId,"onUpdate:value":e[24]||(e[24]=n=>b.materialId=n),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(i(!0),m(T,null,S(X.value,n=>(i(),o(f,{key:n.id,value:n.id},{default:a(()=>[u(p(n.code)+" - "+p(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),b.contextType==="IQC"?(i(),o(d,{key:0,label:"供应商"},{default:a(()=>[t(w,{value:b.supplierId,"onUpdate:value":e[25]||(e[25]=n=>b.supplierId=n),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(i(!0),m(T,null,S(oe.value,n=>(i(),o(f,{key:n.id,value:n.id},{default:a(()=>[u(p(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="OQC"?(i(),o(d,{key:1,label:"客户"},{default:a(()=>[t(w,{value:b.customerId,"onUpdate:value":e[26]||(e[26]=n=>b.customerId=n),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(i(!0),m(T,null,S(se.value,n=>(i(),o(f,{key:n.id,value:n.id},{default:a(()=>[u(p(n.code)+" - "+p(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="IPQC"?(i(),o(d,{key:2,label:"工序"},{default:a(()=>[t(w,{value:b.operationNo,"onUpdate:value":e[27]||(e[27]=n=>b.operationNo=n),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[(i(!0),m(T,null,S(de.value,n=>(i(),o(f,{key:n.no,value:n.no},{default:a(()=>[u(p(n.no)+" "+p(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})):r("",!0),b.contextType==="IPQC"?(i(),o(d,{key:3,label:"IPQC类型"},{default:a(()=>[t(w,{value:b.ipqcType,"onUpdate:value":e[28]||(e[28]=n=>b.ipqcType=n),"allow-clear":"",placeholder:"请选择"},{default:a(()=>[t(f,{value:"FAI"},{default:a(()=>[...e[96]||(e[96]=[u("FAI 首件检验",-1)])]),_:1}),t(f,{value:"PATROL"},{default:a(()=>[...e[97]||(e[97]=[u("PATROL 巡检",-1)])]),_:1}),t(f,{value:"LAI"},{default:a(()=>[...e[98]||(e[98]=[u("LAI 末件检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):r("",!0)]),_:1},8,["model"]),t(ve,null,{default:a(()=>[...e[99]||(e[99]=[u("模拟结果",-1)])]),_:1}),h.value?(i(),m("div",Ha,[t(va,{status:h.value.matched?"success":"warning",title:h.value.matched?`✅ 匹配到策略 (优先级 P${(l=h.value.strategy)==null?void 0:l.priority})`:"⚠️ 未匹配到任何策略"},{subTitle:a(()=>[h.value.matched?(i(),m("div",Ya,[t(ma,{bordered:"",size:"small",column:2},{default:a(()=>[t(Le,{label:"匹配类型"},{default:a(()=>[u(p(h.value.matchType),1)]),_:1}),t(Le,{label:"触发条件"},{default:a(()=>{var n;return[u(p(be((n=h.value.strategy)==null?void 0:n.triggerCondition)),1)]}),_:1})]),_:1})])):(i(),m("div",Ja,"当前方案无策略可匹配此业务上下文，建议添加兜底（通用）策略。"))]),_:1},8,["status","title"])])):(i(),o(fa,{key:1,description:"请填写条件后点击「开始模拟」"}))]}),_:1},8,["visible"]),t(fe,{visible:G.value,"onUpdate:visible":e[40]||(e[40]=l=>G.value=l),title:"物料检验规格",width:"600px",onOk:la},{default:a(()=>[c.value?(i(),o(ee,{key:0,model:c.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(d,{label:"物料"},{default:a(()=>[t(w,{value:c.value.materialId,"onUpdate:value":e[30]||(e[30]=l=>c.value.materialId=l),placeholder:"请选择物料",onChange:e[31]||(e[31]=l=>{var n;return c.value.materialCode=((n=X.value.find(A=>A.id===l))==null?void 0:n.code)||""})},{default:a(()=>[(i(!0),m(T,null,S(X.value,l=>(i(),o(f,{key:l.id,value:l.id},{default:a(()=>[u(p(l.code)+" - "+p(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(d,{label:"检验项目"},{default:a(()=>[t(w,{value:c.value.inspItemCode,"onUpdate:value":e[32]||(e[32]=l=>c.value.inspItemCode=l),placeholder:"请选择项目"},{default:a(()=>[(i(!0),m(T,null,S(O.value,l=>(i(),o(f,{key:l.inspItemId,value:l.inspItemId},{default:a(()=>[u(p(l.inspItemName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(d,{label:"数据类型"},{default:a(()=>[t(ya,{value:c.value.dataType,"onUpdate:value":e[33]||(e[33]=l=>c.value.dataType=l)},{default:a(()=>[t(Oe,{value:"QUANTITATIVE"},{default:a(()=>[...e[100]||(e[100]=[u("计量型（有公差）",-1)])]),_:1}),t(Oe,{value:"QUALITATIVE"},{default:a(()=>[...e[101]||(e[101]=[u("计数型（描述标准）",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),c.value.dataType==="QUANTITATIVE"?(i(),m(T,{key:0},[t(d,{label:"目标值"},{default:a(()=>[t(Z,{value:c.value.targetValue,"onUpdate:value":e[34]||(e[34]=l=>c.value.targetValue=l),style:{width:"140px"}},null,8,["value"]),t(L,{value:c.value.uom,"onUpdate:value":e[35]||(e[35]=l=>c.value.uom=l),placeholder:"单位",style:{width:"70px","margin-left":"8px"}},null,8,["value"])]),_:1}),t(d,{label:"上限 (USL)"},{default:a(()=>[t(Z,{value:c.value.upperLimit,"onUpdate:value":e[36]||(e[36]=l=>c.value.upperLimit=l),style:{width:"140px"}},null,8,["value"])]),_:1}),t(d,{label:"下限 (LSL)"},{default:a(()=>[t(Z,{value:c.value.lowerLimit,"onUpdate:value":e[37]||(e[37]=l=>c.value.lowerLimit=l),style:{width:"140px"}},null,8,["value"])]),_:1})],64)):(i(),m(T,{key:1},[t(d,{label:"标准描述"},{default:a(()=>[t(pe,{value:c.value.standardDesc,"onUpdate:value":e[38]||(e[38]=l=>c.value.standardDesc=l),rows:3,placeholder:"如：表面无划伤，色泽均匀"},null,8,["value"])]),_:1}),t(d,{label:"期望值"},{default:a(()=>[t(L,{value:c.value.expectedValue,"onUpdate:value":e[39]||(e[39]=l=>c.value.expectedValue=l),placeholder:"如：OK / PASS"},null,8,["value"])]),_:1})],64))]),_:1},8,["model"])):r("",!0)]),_:1},8,["visible"])])}}}),Za=Aa(Ga,[["__scopeId","data-v-43dda17c"]]);export{Za as default};
