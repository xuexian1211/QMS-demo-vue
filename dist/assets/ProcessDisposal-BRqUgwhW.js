import{a as w,r as p,k as de,m as re,c as A,o as v,e as z,x as o,q as s,h as n,y as m,P as ce,s as r,G as ue,H as pe,I as fe,R as ve,p as h,f as me,t as x,F as ye,B as ge,E as b,u as ke,C as _,J as he}from"./index-BPMZt9Bz.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as Ce}from"./ExportOutlined-D_JI9KKd.js";const De={class:"process-disposal-container"},we={class:"toolbar"},xe={class:"table-container"},be={__name:"ProcessDisposal",setup(Oe){const g=ke(),a=w({disposalNo:"",workOrder:"",productCode:"",status:void 0}),c=p([]),C=p(!1),i=p([]),f=w({current:1,pageSize:20,showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,e)=>`第 ${e[0]}-${e[1]} 条/共 ${t} 条`}),L={selectedRowKeys:i,onChange:t=>{i.value=t}},O=de(()=>{let t=c.value;return a.disposalNo&&(t=t.filter(e=>e.disposalNo.includes(a.disposalNo))),a.workOrder&&(t=t.filter(e=>e.workOrder.includes(a.workOrder))),a.productCode&&(t=t.filter(e=>e.productCode.includes(a.productCode))),a.status&&(t=t.filter(e=>e.status===a.status)),t}),P=[{title:"处置单号",dataIndex:"disposalNo",key:"disposalNo",width:140,customRender:({text:t,record:e})=>he("a",{onClick:()=>I(e),style:{color:"#1890ff",textDecoration:"underline"}},t)},{title:"生产工单",dataIndex:"workOrder",key:"workOrder",width:120},{title:"生产线",dataIndex:"productionLine",key:"productionLine"},{title:"工序",dataIndex:"process",key:"process"},{title:"产品编码",dataIndex:"productCode",key:"productCode",width:120},{title:"产品名称",dataIndex:"productName",key:"productName"},{title:"不合格数量",dataIndex:"defectQuantity",key:"defectQuantity",width:100},{title:"处置方式",dataIndex:"disposalMethod",key:"disposalMethod",width:100},{title:"处置状态",dataIndex:"status",key:"status",width:100},{title:"发现日期",dataIndex:"discoveryDate",key:"discoveryDate",width:120},{title:"操作",key:"action",width:200,fixed:"right"}],Q=p(!1),$=p(!1);p();const B=w({id:null,disposalNo:"",workOrder:"",discoveryDate:null,productionLine:"",process:"",shift:"day",productCode:"",productName:"",defectQuantity:null,discoverer:"",defectDescription:"",causeAnalysis:"",disposalMethod:"rework",urgencyLevel:"medium",processor:"",processingDate:null,disposalResult:"",correctiveAction:"",remark:"",status:"pending"});p([{id:1,name:"生产线A"},{id:2,name:"生产线B"},{id:3,name:"生产线C"}]),p([{id:1,name:"装配"},{id:2,name:"焊接"},{id:3,name:"喷涂"},{id:4,name:"包装"}]);const N=[{id:1,disposalNo:"IPQCD20240115001",workOrder:"WO20240115001",discoveryDate:"2024-01-15",productionLine:"生产线A",process:"装配",shift:"day",productCode:"PROD001",productName:"产品A",defectQuantity:25,discoverer:"张三",defectDescription:"装配尺寸偏差",causeAnalysis:"工装夹具磨损",disposalMethod:"rework",urgencyLevel:"high",processor:"李四",processingDate:"2024-01-16",disposalResult:"已重新装配，检验合格",correctiveAction:"更换工装夹具，定期维护",status:"completed"},{id:2,disposalNo:"IPQCD20240116001",workOrder:"WO20240116001",discoveryDate:"2024-01-16",productionLine:"生产线B",process:"焊接",shift:"night",productCode:"PROD002",productName:"产品B",defectQuantity:15,discoverer:"王五",defectDescription:"焊接强度不足",causeAnalysis:"焊接参数设置不当",disposalMethod:"repair",urgencyLevel:"medium",processor:"赵六",processingDate:"2024-01-17",disposalResult:"已重新焊接，强度达标",correctiveAction:"优化焊接参数，加强培训",status:"processing"},{id:3,disposalNo:"IPQCD20240117001",workOrder:"WO20240117001",discoveryDate:"2024-01-17",productionLine:"生产线C",process:"喷涂",shift:"day",productCode:"PROD003",productName:"产品C",defectQuantity:10,discoverer:"钱七",defectDescription:"表面涂层不均匀",causeAnalysis:"喷枪堵塞，涂料粘度不当",disposalMethod:"scrap",urgencyLevel:"low",processor:"",processingDate:null,disposalResult:"",correctiveAction:"",status:"pending"}],E=t=>({pending:"orange",processing:"blue",completed:"green",closed:"gray"})[t]||"default",T=t=>({pending:"待处理",processing:"处理中",completed:"已完成",closed:"已关闭"})[t]||t,V=t=>({rework:"orange",scrap:"red",repair:"blue",concession:"green",downgrade:"purple"})[t]||"default",q=t=>({rework:"返工",scrap:"报废",repair:"维修",concession:"让步接收",downgrade:"降级使用"})[t]||t,U=t=>t?b(t).format("YYYY-MM-DD"):"",Y=()=>{g.push("/production-quality/exception-handling/process-disposal/create")},F=()=>{if(i.value.length===1){const t=c.value.find(e=>e.id===i.value[0]);t&&g.push(`/production-quality/exception-handling/process-disposal/edit/${t.id}`)}},W=()=>{if(i.value.length===1){const t=c.value.find(e=>e.id===i.value[0]);t&&g.push(`/production-quality/exception-handling/process-disposal/view/${t.id}`)}},j=()=>{if(i.value.length>0){const t=i.value.length;c.value=c.value.filter(e=>!i.value.includes(e.id)),i.value=[],f.total-=t,_.success(`成功删除 ${t} 条记录`)}},J=()=>{_.info("导出功能开发中...")},K=()=>{k(),_.success("刷新成功")},G=t=>{ee(t)},k=()=>{C.value=!0,setTimeout(()=>{c.value=N,f.total=N.length,C.value=!1},500)},R=()=>{f.current=1,k()},H=()=>{a.disposalNo="",a.workOrder="",a.productCode="",a.status="",R()},X=t=>{f.current=t.current,f.pageSize=t.pageSize,k()},Z=t=>{$.value=!0,Q.value=!0,Object.assign(B,{...t,discoveryDate:t.discoveryDate?b(t.discoveryDate):null,processingDate:t.processingDate?b(t.processingDate):null})},I=t=>{g.push(`/production-quality/exception-handling/process-disposal/view/${t.id}`)},ee=t=>{const e=c.value.findIndex(d=>d.id===t);e>-1&&(c.value.splice(e,1),f.total--,_.success("删除成功"))};return re(()=>{k()}),(t,e)=>{const d=r("a-button"),D=r("a-input"),y=r("a-form-item"),te=r("a-select"),oe=r("a-form"),se=r("a-card"),M=r("a-tag"),ae=r("a-popconfirm"),le=r("a-space"),ne=r("a-table"),ie=r("router-view");return v(),A("div",De,[z("div",we,[o(d,{type:"primary",onClick:Y},{icon:s(()=>[o(m(ce))]),default:s(()=>[e[4]||(e[4]=n(" 新增 ",-1))]),_:1}),o(d,{onClick:F,disabled:i.value.length!==1},{icon:s(()=>[o(m(ue))]),default:s(()=>[e[5]||(e[5]=n(" 编辑 ",-1))]),_:1},8,["disabled"]),o(d,{onClick:W,disabled:i.value.length!==1},{icon:s(()=>[o(m(pe))]),default:s(()=>[e[6]||(e[6]=n(" 查看 ",-1))]),_:1},8,["disabled"]),o(d,{onClick:j,disabled:i.value.length===0,danger:""},{icon:s(()=>[o(m(fe))]),default:s(()=>[e[7]||(e[7]=n(" 删除 ",-1))]),_:1},8,["disabled"]),o(d,{onClick:J},{icon:s(()=>[o(m(Ce))]),default:s(()=>[e[8]||(e[8]=n(" 导出 ",-1))]),_:1}),o(d,{onClick:K},{icon:s(()=>[o(m(ve))]),default:s(()=>[e[9]||(e[9]=n(" 刷新 ",-1))]),_:1})]),o(se,{title:"搜索条件",size:"small",class:"search-card"},{default:s(()=>[o(oe,{layout:"inline",model:a},{default:s(()=>[o(y,{label:"处置单号"},{default:s(()=>[o(D,{value:a.disposalNo,"onUpdate:value":e[0]||(e[0]=l=>a.disposalNo=l),placeholder:"请输入处置单号"},null,8,["value"])]),_:1}),o(y,{label:"生产工单"},{default:s(()=>[o(D,{value:a.workOrder,"onUpdate:value":e[1]||(e[1]=l=>a.workOrder=l),placeholder:"请输入生产工单号"},null,8,["value"])]),_:1}),o(y,{label:"产品编码"},{default:s(()=>[o(D,{value:a.productCode,"onUpdate:value":e[2]||(e[2]=l=>a.productCode=l),placeholder:"请输入产品编码"},null,8,["value"])]),_:1}),o(y,{label:"处置状态"},{default:s(()=>[o(te,{value:a.status,"onUpdate:value":e[3]||(e[3]=l=>a.status=l),placeholder:"请选择处置状态",style:{width:"120px"},options:[{value:"pending",label:"待处理"},{value:"processing",label:"处理中"},{value:"completed",label:"已完成"},{value:"closed",label:"已关闭"}]},null,8,["value"])]),_:1}),o(y,null,{default:s(()=>[o(d,{type:"primary",onClick:R},{default:s(()=>[...e[10]||(e[10]=[n("查询",-1)])]),_:1}),o(d,{style:{"margin-left":"8px"},onClick:H},{default:s(()=>[...e[11]||(e[11]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),z("div",xe,[o(ne,{columns:P,"data-source":O.value,loading:C.value,pagination:{...f,total:O.value.length,pageSize:20},scroll:{x:1200,y:"calc(100vh - 220px)"},"row-selection":L,"row-key":"id",size:"small",onChange:X,class:"compact-table"},{bodyCell:s(({column:l,record:u})=>[l.key==="disposalMethod"?(v(),h(M,{key:0,color:V(u.disposalMethod),class:"method-tag"},{default:s(()=>[n(x(q(u.disposalMethod)),1)]),_:2},1032,["color"])):l.key==="status"?(v(),h(M,{key:1,color:E(u.status),class:"status-tag"},{default:s(()=>[n(x(T(u.status)),1)]),_:2},1032,["color"])):l.key==="discoveryDate"?(v(),A(ye,{key:2},[n(x(U(u.discoveryDate)),1)],64)):l.key==="action"?(v(),h(le,{key:3},{default:s(()=>[o(d,{type:"link",size:"small",onClick:S=>I(u)},{default:s(()=>[...e[12]||(e[12]=[n("查看",-1)])]),_:1},8,["onClick"]),o(d,{type:"link",size:"small",onClick:S=>Z(u)},{default:s(()=>[...e[13]||(e[13]=[n("编辑",-1)])]),_:1},8,["onClick"]),o(ae,{title:"确定要删除这条记录吗？",onConfirm:S=>G(u.id),"ok-text":"确定","cancel-text":"取消"},{default:s(()=>[o(d,{type:"link",size:"small",danger:""},{default:s(()=>[...e[14]||(e[14]=[n("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):me("",!0)]),_:1},8,["data-source","loading","pagination"])]),o(ie,null,{default:s(({Component:l})=>[(v(),h(ge(l)))]),_:1})])}}},Me=_e(be,[["__scopeId","data-v-3741a31d"]]);export{Me as default};
