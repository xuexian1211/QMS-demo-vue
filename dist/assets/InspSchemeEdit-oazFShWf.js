import{x as a,N as lt,d as nt,k as ke,j as ot,r as I,a as oe,m as it,c as x,q as t,s as v,C as y,o as i,h as o,p as d,f as k,t as h,e as K,y as A,P as ie,I as st,F as M,z as L,n as dt,R as ut,u as rt,M as se}from"./index-Ozo2vowX.js";import{b as pt,e as mt,u as ct,f as vt,h as ft,i as yt,t as kt,j as gt}from"./inspScheme-DkHmZ4go.js";import{S as It}from"./SyncOutlined-LrPHMa3W.js";import{_ as _t}from"./_plugin-vue_export-helper-DlAUqK2U.js";var ht={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM653.3 424.6l52.2 52.2a8.01 8.01 0 01-4.7 13.6l-179.4 21c-5.1.6-9.5-3.7-8.9-8.9l21-179.4c.8-6.6 8.9-9.4 13.6-4.7l52.4 52.4 256.2-256.2c3.1-3.1 8.2-3.1 11.3 0l42.4 42.4c3.1 3.1 3.1 8.2 0 11.3L653.3 424.6z"}}]},name:"import",theme:"outlined"};function ge(T){for(var _=1;_<arguments.length;_++){var b=arguments[_]!=null?Object(arguments[_]):{},w=Object.keys(b);typeof Object.getOwnPropertySymbols=="function"&&(w=w.concat(Object.getOwnPropertySymbols(b).filter(function(U){return Object.getOwnPropertyDescriptor(b,U).enumerable}))),w.forEach(function(U){Ct(T,U,b[U])})}return T}function Ct(T,_,b){return _ in T?Object.defineProperty(T,_,{value:b,enumerable:!0,configurable:!0,writable:!0}):T[_]=b,T}var de=function(_,b){var w=ge({},_,b.attrs);return a(lt,ge({},w,{icon:ht}),null)};de.displayName="ImportOutlined";de.inheritAttrs=!1;const bt={class:"insp-scheme-edit"},wt={class:"detail-toolbar"},Dt={class:"strategy-toolbar"},St={key:1,class:"match-dimension"},Ot={class:"spec-toolbar"},Nt=nt({__name:"InspSchemeEdit",setup(T){const _=ot(),b=rt(),w=ke(()=>!!_.params.id),U=I("basic"),J=I(!1);_.path.includes("/strategies")&&(U.value="strategies");const u=oe({schemeCode:"",schemeName:"",version:"V1.0",status:"DRAFT",description:"",details:[]}),V=I([]),Ie=[{title:"序号",key:"sortOrder",width:80},{title:"检验项目",key:"inspItemName",width:250},{title:"特性分类",key:"characteristicClass",width:120},{title:"抽样规则",key:"samplingRule",width:200},{title:"检验方法",key:"inspMethod",width:180},{title:"SPC",key:"spcEnabled",width:80},{title:"送检",key:"labRequired",width:80},{title:"操作",key:"action",fixed:"right",width:150}],ue=I([]),X=I(!1),_e=[{title:"策略名称",dataIndex:"strategyName",key:"strategyName"},{title:"上下文",key:"contextType",width:100},{title:"匹配维度",key:"matchDimension",width:300},{title:"优先级",dataIndex:"priority",key:"priority",width:100},{title:"状态",key:"status",width:100},{title:"操作",key:"action",width:150}],F=I([]),re=I([]),pe=I([]),q=I(!1),Z=I("添加检验项目"),g=oe({sortOrder:1,characteristicClass:"Major",spcEnabled:!1,labRequired:!1}),z=I(!1),ee=I("新增策略"),r=oe({strategyName:"",contextType:"IQC",matchDimension:{},priority:100,triggerCondition:"ALWAYS",status:"enabled"}),P=I(null),B=I(!1),Q=I([]),me=I([{id:"1",phenomenonName:"尺寸超差"},{id:"2",phenomenonName:"表面划伤"},{id:"3",phenomenonName:"毛刺"},{id:"4",phenomenonName:"变形"},{id:"5",phenomenonName:"裂纹"}]),he=[{title:"现象名称",dataIndex:"phenomenonName",key:"phenomenonName"},{title:"操作",key:"action",width:100}],Ce=ke(()=>{var e;if(!P.value)return[];const n=(e=u.details)==null?void 0:e.find(p=>p.id===P.value);return!n||!n.relatedPhenomenonIds?[]:me.value.filter(p=>{var C;return(C=n.relatedPhenomenonIds)==null?void 0:C.includes(p.id)})}),ce=I([]),te=I(!1),ve=I(!1),be=[{title:"物料ID",dataIndex:"materialId",key:"materialId",width:120},{title:"检验项目",dataIndex:"inspItemName",key:"inspItemName",width:150},{title:"目标值",key:"targetValue",width:120},{title:"上限(USL)",key:"upperLimit",width:120},{title:"下限(LSL)",key:"lowerLimit",width:120},{title:"单位",dataIndex:"uom",key:"uom",width:80},{title:"操作",key:"action",width:100}],we=async()=>{if(w.value)try{const n=await pt(_.params.id);n.data.success&&Object.assign(u,n.data.data)}catch{y.error("加载数据失败")}},$=async()=>{if(w.value){X.value=!0;try{const n=await mt(_.params.id);n.data.success&&(ue.value=n.data.data)}catch{y.error("加载策略失败")}finally{X.value=!1}}},De=async()=>{if(!u.schemeCode||!u.schemeName){y.warning("请填写必填项");return}J.value=!0;try{if(w.value)await ct(_.params.id,u),await vt(_.params.id,u.details||[]),y.success("保存成功");else{const n=await ft(u);n.data.success&&(y.success("创建成功"),b.push(`/inspection-model/insp-scheme/edit/${n.data.data.id}`))}}catch{y.error("保存失败")}finally{J.value=!1}},fe=()=>{b.back()},Se=()=>{var n;Z.value="添加检验项目",Object.assign(g,{sortOrder:(((n=u.details)==null?void 0:n.length)||0)+1,characteristicClass:"Major",spcEnabled:!1,labRequired:!1}),q.value=!0},Oe=()=>{if(!g.inspItemId){y.warning("请选择检验项目");return}u.details||(u.details=[]),u.details.push({...g}),q.value=!1},Ne=n=>{var e;(e=u.details)==null||e.splice(n,1)},xe=()=>{se.confirm({title:"确认删除选中的项目？",onOk:()=>{var n;u.details=(n=u.details)==null?void 0:n.filter(e=>!V.value.includes(e.id)),V.value=[]}})},Te=n=>{V.value=n},ae=(n,e)=>e.children.toLowerCase().indexOf(n.toLowerCase())>=0,Ue=(n,e)=>{const p=F.value.find(C=>C.id===n);p&&(e.inspItemName=p.name,e.inspItemCode=p.code)},Pe=n=>{const e=F.value.find(p=>p.id===n);e&&(g.inspItemName=e.name,g.inspItemCode=e.code)},Me=n=>{Z.value="编辑检验项目",Object.assign(g,{...n}),q.value=!0},Re=()=>{y.info("从模板导入功能开发中...")},Ae=()=>{u.sourceTemplateId&&b.push(`/inspection-model/insp-templates/view/${u.sourceTemplateId}`)},Le=n=>{ee.value="编辑策略",Object.assign(r,{...n}),z.value=!0},Ee=()=>{ee.value="新增策略",Object.assign(r,{schemeId:_.params.id,strategyName:"",contextType:"IQC",matchDimension:{},priority:100,triggerCondition:"ALWAYS",status:"enabled"}),z.value=!0},Ve=async()=>{if(!r.strategyName){y.warning("请输入策略名称");return}try{await gt(r),y.success("创建成功"),z.value=!1,$()}catch{y.error("创建失败")}},qe=async n=>{se.confirm({title:"确认删除？",onOk:async()=>{try{await yt(n.id),y.success("删除成功"),$()}catch{y.error("删除失败")}}})},ze=async(n,e)=>{try{await kt(n.id,e?"enabled":"disabled"),y.success("状态更新成功"),$()}catch{y.error("状态更新失败")}},Qe=n=>{P.value=n.id},je=()=>{Q.value=[],B.value=!0},Fe=()=>{var e;if(!P.value||Q.value.length===0){y.warning("请选择不良现象");return}const n=(e=u.details)==null?void 0:e.find(p=>p.id===P.value);n&&(n.relatedPhenomenonIds||(n.relatedPhenomenonIds=[]),n.relatedPhenomenonIds=[...new Set([...n.relatedPhenomenonIds,...Q.value])]),B.value=!1,y.success("添加成功")},Be=n=>{var p;if(!P.value)return;const e=(p=u.details)==null?void 0:p.find(C=>C.id===P.value);e&&e.relatedPhenomenonIds&&(e.relatedPhenomenonIds=e.relatedPhenomenonIds.filter(C=>C!==n.id),y.success("移除成功"))},ye=async()=>{te.value=!0;try{ce.value=[{id:"1",orgId:"1",materialId:"M001",inspItemCode:"ITEM001",inspItemName:"长度",specType:"QUANTITATIVE",targetValue:100,upperLimit:100.5,lowerLimit:99.5,uom:"mm",createTime:"",updateTime:"",creator:"",updater:""}],y.success("刷新成功")}catch{y.error("刷新失败")}finally{te.value=!1}},$e=async()=>{se.confirm({title:"确认同步",content:"是否将当前修改的规格同步至物料档案？",onOk:async()=>{try{y.success("同步成功"),ve.value=!1}catch{y.error("同步失败")}}})},We=n=>{y.info("编辑规格功能待实现")},Ge=n=>({DRAFT:"default",IN_APPROVAL:"processing",APPROVED:"success",OBSOLETE:"error"})[n||"DRAFT"]||"default",He=n=>({DRAFT:"草稿",IN_APPROVAL:"审批中",APPROVED:"已批准",OBSOLETE:"已作废"})[n||"DRAFT"]||"草稿";return it(()=>{we(),w.value&&($(),U.value==="specs"&&ye())}),(n,e)=>{const p=v("a-button"),C=v("a-space"),Ye=v("a-page-header"),N=v("a-input"),f=v("a-form-item"),R=v("a-col"),W=v("a-row"),O=v("a-tag"),Ke=v("a-textarea"),le=v("a-form"),G=v("a-card"),E=v("a-input-number"),c=v("a-select-option"),S=v("a-select"),j=v("a-switch"),H=v("a-table"),Y=v("a-tab-pane"),Je=v("a-list-item-meta"),Xe=v("a-list-item"),Ze=v("a-list"),et=v("a-empty"),tt=v("a-alert"),at=v("a-tabs"),ne=v("a-modal");return i(),x("div",bt,[a(Ye,{title:w.value?"编辑检验方案":"新建检验方案",onBack:fe},{extra:t(()=>[a(C,null,{default:t(()=>[a(p,{onClick:fe},{default:t(()=>[...e[26]||(e[26]=[o("取消",-1)])]),_:1}),a(p,{type:"primary",onClick:De,loading:J.value},{default:t(()=>[...e[27]||(e[27]=[o("保存",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["title"]),a(G,{title:"基本信息",bordered:!1,style:{"margin-top":"16px"}},{default:t(()=>[a(le,{model:u,"label-col":{span:4},"wrapper-col":{span:16}},{default:t(()=>[a(W,{gutter:16},{default:t(()=>[a(R,{span:12},{default:t(()=>[a(f,{label:"方案编码",required:""},{default:t(()=>[a(N,{value:u.schemeCode,"onUpdate:value":e[0]||(e[0]=l=>u.schemeCode=l),placeholder:"请输入方案编码"},null,8,["value"])]),_:1})]),_:1}),a(R,{span:12},{default:t(()=>[a(f,{label:"方案名称",required:""},{default:t(()=>[a(N,{value:u.schemeName,"onUpdate:value":e[1]||(e[1]=l=>u.schemeName=l),placeholder:"请输入方案名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(W,{gutter:16},{default:t(()=>[a(R,{span:12},{default:t(()=>[a(f,{label:"版本号",required:""},{default:t(()=>[a(N,{value:u.version,"onUpdate:value":e[2]||(e[2]=l=>u.version=l),placeholder:"请输入版本号"},null,8,["value"])]),_:1})]),_:1}),a(R,{span:12},{default:t(()=>[a(f,{label:"状态"},{default:t(()=>[a(O,{color:Ge(u.status)},{default:t(()=>[o(h(He(u.status)),1)]),_:1},8,["color"])]),_:1})]),_:1})]),_:1}),u.sourceTemplateId?(i(),d(W,{key:0,gutter:16},{default:t(()=>[a(R,{span:12},{default:t(()=>[a(f,{label:"源模板"},{default:t(()=>[a(N,{value:u.sourceTemplateName,disabled:""},null,8,["value"]),a(p,{type:"link",size:"small",onClick:Ae},{default:t(()=>[...e[28]||(e[28]=[o("查看模板",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0),a(f,{label:"描述"},{default:t(()=>[a(Ke,{value:u.description,"onUpdate:value":e[3]||(e[3]=l=>u.description=l),rows:3,placeholder:"请输入描述"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),a(G,{bordered:!1,style:{"margin-top":"16px"}},{default:t(()=>[a(at,{activeKey:U.value,"onUpdate:activeKey":e[4]||(e[4]=l=>U.value=l)},{default:t(()=>[a(Y,{key:"details",tab:"检验项目明细"},{default:t(()=>[K("div",wt,[a(C,null,{default:t(()=>[a(p,{type:"primary",onClick:Se},{icon:t(()=>[a(A(ie))]),default:t(()=>[e[29]||(e[29]=o(" 添加项目 ",-1))]),_:1}),u.sourceTemplateId?k("",!0):(i(),d(p,{key:0,onClick:Re},{icon:t(()=>[a(A(de))]),default:t(()=>[e[30]||(e[30]=o(" 从模板导入 ",-1))]),_:1})),a(p,{danger:"",onClick:xe,disabled:V.value.length===0},{icon:t(()=>[a(A(st))]),default:t(()=>[e[31]||(e[31]=o(" 批量删除 ",-1))]),_:1},8,["disabled"])]),_:1})]),a(H,{columns:Ie,"data-source":u.details,"row-selection":{selectedRowKeys:V.value,onChange:Te},pagination:!1,"row-key":"id",scroll:{x:1500}},{bodyCell:t(({column:l,record:s,index:D})=>[l.key==="sortOrder"?(i(),d(E,{key:0,value:s.sortOrder,"onUpdate:value":m=>s.sortOrder=m,min:1,style:{width:"80px"}},null,8,["value","onUpdate:value"])):l.key==="inspItemName"?(i(),x(M,{key:1},[a(S,{value:s.inspItemId,"onUpdate:value":m=>s.inspItemId=m,placeholder:"请选择检验项目","show-search":"","filter-option":ae,onChange:m=>Ue(m,s),style:{width:"200px"}},{default:t(()=>[(i(!0),x(M,null,L(F.value,m=>(i(),d(c,{key:m.id,value:m.id},{default:t(()=>[o(h(m.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value","onChange"]),s.fromTemplate?(i(),d(O,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:t(()=>[...e[32]||(e[32]=[o("模板",-1)])]),_:1})):k("",!0)],64)):l.key==="characteristicClass"?(i(),d(S,{key:2,value:s.characteristicClass,"onUpdate:value":m=>s.characteristicClass=m,style:{width:"100px"}},{default:t(()=>[a(c,{value:"SC"},{default:t(()=>[...e[33]||(e[33]=[o("SC",-1)])]),_:1}),a(c,{value:"CC"},{default:t(()=>[...e[34]||(e[34]=[o("CC",-1)])]),_:1}),a(c,{value:"Major"},{default:t(()=>[...e[35]||(e[35]=[o("Major",-1)])]),_:1}),a(c,{value:"Minor"},{default:t(()=>[...e[36]||(e[36]=[o("Minor",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])):l.key==="samplingRule"?(i(),d(S,{key:3,value:s.samplingRuleId,"onUpdate:value":m=>s.samplingRuleId=m,placeholder:"请选择抽样规则",style:{width:"180px"}},{default:t(()=>[(i(!0),x(M,null,L(re.value,m=>(i(),d(c,{key:m.id,value:m.id},{default:t(()=>[o(h(m.ruleName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value"])):l.key==="inspMethod"?(i(),d(S,{key:4,value:s.inspMethodId,"onUpdate:value":m=>s.inspMethodId=m,placeholder:"请选择检验方法","allow-clear":"",style:{width:"150px"}},{default:t(()=>[(i(!0),x(M,null,L(pe.value,m=>(i(),d(c,{key:m.id,value:m.id},{default:t(()=>[o(h(m.methodName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","onUpdate:value"])):l.key==="spcEnabled"?(i(),d(j,{key:5,checked:s.spcEnabled,"onUpdate:checked":m=>s.spcEnabled=m},null,8,["checked","onUpdate:checked"])):l.key==="labRequired"?(i(),d(j,{key:6,checked:s.labRequired,"onUpdate:checked":m=>s.labRequired=m},null,8,["checked","onUpdate:checked"])):l.key==="action"?(i(),d(C,{key:7},{default:t(()=>[a(p,{type:"link",size:"small",onClick:m=>Me(s)},{default:t(()=>[...e[37]||(e[37]=[o("编辑",-1)])]),_:1},8,["onClick"]),a(p,{type:"link",size:"small",danger:"",onClick:m=>Ne(D)},{default:t(()=>[...e[38]||(e[38]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):k("",!0)]),_:1},8,["data-source","row-selection"])]),_:1}),a(Y,{key:"defects",tab:"明细不良现象绑定"},{default:t(()=>[a(W,{gutter:16},{default:t(()=>[a(R,{span:10},{default:t(()=>[a(G,{title:"检验项目",size:"small"},{default:t(()=>[a(Ze,{"data-source":u.details||[],size:"small"},{renderItem:t(({item:l})=>[a(Xe,{class:dt({"selected-item":P.value===l.id}),onClick:s=>Qe(l),style:{cursor:"pointer"}},{default:t(()=>[a(Je,null,{title:t(()=>[o(h(l.inspItemName),1)]),description:t(()=>{var s;return[a(O,{size:"small"},{default:t(()=>[o(h(l.characteristicClass),1)]),_:2},1024),(s=l.relatedPhenomenonIds)!=null&&s.length?(i(),d(O,{key:0,color:"blue",size:"small"},{default:t(()=>[o(" 已绑定 "+h(l.relatedPhenomenonIds.length)+" 个现象 ",1)]),_:2},1024)):k("",!0)]}),_:2},1024)]),_:2},1032,["class","onClick"])]),_:1},8,["data-source"])]),_:1})]),_:1}),a(R,{span:14},{default:t(()=>[P.value?(i(),d(G,{key:0,title:"关联不良现象",size:"small"},{extra:t(()=>[a(p,{type:"primary",size:"small",onClick:je},{icon:t(()=>[a(A(ie))]),default:t(()=>[e[39]||(e[39]=o(" 添加现象 ",-1))]),_:1})]),default:t(()=>[a(H,{columns:he,"data-source":Ce.value,pagination:!1,size:"small","row-key":"id"},{bodyCell:t(({column:l,record:s})=>[l.key==="action"?(i(),d(p,{key:0,type:"link",size:"small",danger:"",onClick:D=>Be(s)},{default:t(()=>[...e[40]||(e[40]=[o(" 移除 ",-1)])]),_:1},8,["onClick"])):k("",!0)]),_:1},8,["data-source"])]),_:1})):(i(),d(et,{key:1,description:"请先选择左侧的检验项目"}))]),_:1})]),_:1})]),_:1}),w.value?(i(),d(Y,{key:"strategies",tab:"策略绑定"},{default:t(()=>[K("div",Dt,[a(p,{type:"primary",onClick:Ee},{icon:t(()=>[a(A(ie))]),default:t(()=>[e[41]||(e[41]=o(" 新增策略 ",-1))]),_:1})]),a(H,{columns:_e,"data-source":ue.value,loading:X.value,pagination:!1,"row-key":"id"},{bodyCell:t(({column:l,record:s})=>[l.key==="contextType"?(i(),d(O,{key:0},{default:t(()=>[o(h(s.contextType),1)]),_:2},1024)):l.key==="matchDimension"?(i(),x("div",St,[s.matchDimension.materialId?(i(),d(O,{key:0,color:"blue"},{default:t(()=>[o(" 物料: "+h(s.matchDimension.materialId),1)]),_:2},1024)):k("",!0),s.matchDimension.materialGroupId?(i(),d(O,{key:1,color:"cyan"},{default:t(()=>[o(" 物料组: "+h(s.matchDimension.materialGroupId),1)]),_:2},1024)):k("",!0),s.matchDimension.supplierId?(i(),d(O,{key:2,color:"green"},{default:t(()=>[o(" 供应商: "+h(s.matchDimension.supplierId),1)]),_:2},1024)):k("",!0),s.matchDimension.customerId?(i(),d(O,{key:3,color:"purple"},{default:t(()=>[o(" 客户: "+h(s.matchDimension.customerId),1)]),_:2},1024)):k("",!0),s.matchDimension.operationNo?(i(),d(O,{key:4,color:"orange"},{default:t(()=>[o(" 工序: "+h(s.matchDimension.operationNo),1)]),_:2},1024)):k("",!0),s.matchDimension.ipqcType?(i(),d(O,{key:5,color:"red"},{default:t(()=>[o(" IPQC类型: "+h(s.matchDimension.ipqcType),1)]),_:2},1024)):k("",!0)])):l.key==="status"?(i(),d(j,{key:2,checked:s.status==="enabled",onChange:D=>ze(s,D)},null,8,["checked","onChange"])):l.key==="action"?(i(),d(C,{key:3},{default:t(()=>[a(p,{type:"link",size:"small",onClick:D=>Le(s)},{default:t(()=>[...e[42]||(e[42]=[o("编辑",-1)])]),_:1},8,["onClick"]),a(p,{type:"link",size:"small",danger:"",onClick:D=>qe(s)},{default:t(()=>[...e[43]||(e[43]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):k("",!0)]),_:1},8,["data-source","loading"])]),_:1})):k("",!0),w.value?(i(),d(Y,{key:"specs",tab:"物料检验规格"},{default:t(()=>[a(tt,{message:"规格说明",description:"此页签展示基于策略绑定的物料及方案项目自动聚合的检验规格。您可以在此编辑规格，并同步至物料档案。",type:"info","show-icon":"",style:{"margin-bottom":"16px"}}),K("div",Ot,[a(C,null,{default:t(()=>[a(p,{type:"primary",onClick:ye},{icon:t(()=>[a(A(ut))]),default:t(()=>[e[44]||(e[44]=o(" 刷新规格 ",-1))]),_:1}),a(p,{onClick:$e,disabled:!ve.value},{icon:t(()=>[a(A(It))]),default:t(()=>[e[45]||(e[45]=o(" 同步至物料档案 ",-1))]),_:1},8,["disabled"])]),_:1})]),a(H,{columns:be,"data-source":ce.value,loading:te.value,pagination:!1,"row-key":"id"},{bodyCell:t(({column:l,record:s})=>[l.key==="targetValue"?(i(),d(E,{key:0,value:s.targetValue,"onUpdate:value":D=>s.targetValue=D,precision:2,style:{width:"100px"}},null,8,["value","onUpdate:value"])):l.key==="upperLimit"?(i(),d(E,{key:1,value:s.upperLimit,"onUpdate:value":D=>s.upperLimit=D,precision:2,style:{width:"100px"}},null,8,["value","onUpdate:value"])):l.key==="lowerLimit"?(i(),d(E,{key:2,value:s.lowerLimit,"onUpdate:value":D=>s.lowerLimit=D,precision:2,style:{width:"100px"}},null,8,["value","onUpdate:value"])):l.key==="action"?(i(),d(p,{key:3,type:"link",size:"small",onClick:D=>We(s)},{default:t(()=>[...e[46]||(e[46]=[o("编辑",-1)])]),_:1},8,["onClick"])):k("",!0)]),_:1},8,["data-source","loading"])]),_:1})):k("",!0)]),_:1},8,["activeKey"])]),_:1}),a(ne,{open:q.value,"onUpdate:open":e[11]||(e[11]=l=>q.value=l),title:Z.value,onOk:Oe,width:"800px"},{default:t(()=>[a(le,{model:g,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(f,{label:"检验项目",required:""},{default:t(()=>[a(S,{value:g.inspItemId,"onUpdate:value":e[5]||(e[5]=l=>g.inspItemId=l),placeholder:"请选择检验项目","show-search":"","filter-option":ae,onChange:Pe},{default:t(()=>[(i(!0),x(M,null,L(F.value,l=>(i(),d(c,{key:l.id,value:l.id},{default:t(()=>[o(h(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(f,{label:"特性分类",required:""},{default:t(()=>[a(S,{value:g.characteristicClass,"onUpdate:value":e[6]||(e[6]=l=>g.characteristicClass=l)},{default:t(()=>[a(c,{value:"SC"},{default:t(()=>[...e[47]||(e[47]=[o("SC-特殊特性",-1)])]),_:1}),a(c,{value:"CC"},{default:t(()=>[...e[48]||(e[48]=[o("CC-关键特性",-1)])]),_:1}),a(c,{value:"Major"},{default:t(()=>[...e[49]||(e[49]=[o("Major-主要",-1)])]),_:1}),a(c,{value:"Minor"},{default:t(()=>[...e[50]||(e[50]=[o("Minor-次要",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),a(f,{label:"抽样规则",required:""},{default:t(()=>[a(S,{value:g.samplingRuleId,"onUpdate:value":e[7]||(e[7]=l=>g.samplingRuleId=l),placeholder:"请选择抽样规则"},{default:t(()=>[(i(!0),x(M,null,L(re.value,l=>(i(),d(c,{key:l.id,value:l.id},{default:t(()=>[o(h(l.ruleName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(f,{label:"检验方法"},{default:t(()=>[a(S,{value:g.inspMethodId,"onUpdate:value":e[8]||(e[8]=l=>g.inspMethodId=l),placeholder:"请选择检验方法","allow-clear":""},{default:t(()=>[(i(!0),x(M,null,L(pe.value,l=>(i(),d(c,{key:l.id,value:l.id},{default:t(()=>[o(h(l.methodName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(f,{label:"SPC监控"},{default:t(()=>[a(j,{checked:g.spcEnabled,"onUpdate:checked":e[9]||(e[9]=l=>g.spcEnabled=l)},null,8,["checked"])]),_:1}),a(f,{label:"送检实验室"},{default:t(()=>[a(j,{checked:g.labRequired,"onUpdate:checked":e[10]||(e[10]=l=>g.labRequired=l)},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"]),a(ne,{open:z.value,"onUpdate:open":e[23]||(e[23]=l=>z.value=l),title:ee.value,onOk:Ve,width:"700px"},{default:t(()=>[a(le,{model:r,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(f,{label:"策略名称",required:""},{default:t(()=>[a(N,{value:r.strategyName,"onUpdate:value":e[12]||(e[12]=l=>r.strategyName=l),placeholder:"请输入策略名称"},null,8,["value"])]),_:1}),a(f,{label:"业务上下文",required:""},{default:t(()=>[a(S,{value:r.contextType,"onUpdate:value":e[13]||(e[13]=l=>r.contextType=l)},{default:t(()=>[a(c,{value:"IQC"},{default:t(()=>[...e[51]||(e[51]=[o("IQC",-1)])]),_:1}),a(c,{value:"IPQC"},{default:t(()=>[...e[52]||(e[52]=[o("IPQC",-1)])]),_:1}),a(c,{value:"FQC"},{default:t(()=>[...e[53]||(e[53]=[o("FQC",-1)])]),_:1}),a(c,{value:"OQC"},{default:t(()=>[...e[54]||(e[54]=[o("OQC",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),a(f,{label:"物料"},{default:t(()=>[a(N,{value:r.matchDimension.materialId,"onUpdate:value":e[14]||(e[14]=l=>r.matchDimension.materialId=l),placeholder:"请输入物料ID"},null,8,["value"])]),_:1}),a(f,{label:"物料组"},{default:t(()=>[a(N,{value:r.matchDimension.materialGroupId,"onUpdate:value":e[15]||(e[15]=l=>r.matchDimension.materialGroupId=l),placeholder:"请输入物料组ID"},null,8,["value"])]),_:1}),r.contextType==="IQC"?(i(),d(f,{key:0,label:"供应商"},{default:t(()=>[a(N,{value:r.matchDimension.supplierId,"onUpdate:value":e[16]||(e[16]=l=>r.matchDimension.supplierId=l),placeholder:"请输入供应商ID"},null,8,["value"])]),_:1})):k("",!0),r.contextType==="OQC"||r.contextType==="FQC"?(i(),d(f,{key:1,label:"客户"},{default:t(()=>[a(N,{value:r.matchDimension.customerId,"onUpdate:value":e[17]||(e[17]=l=>r.matchDimension.customerId=l),placeholder:"请输入客户ID"},null,8,["value"])]),_:1})):k("",!0),r.contextType==="IPQC"?(i(),d(f,{key:2,label:"工序号"},{default:t(()=>[a(N,{value:r.matchDimension.operationNo,"onUpdate:value":e[18]||(e[18]=l=>r.matchDimension.operationNo=l),placeholder:"请输入工序号"},null,8,["value"])]),_:1})):k("",!0),r.contextType==="IPQC"?(i(),d(f,{key:3,label:"IPQC类型"},{default:t(()=>[a(S,{value:r.matchDimension.ipqcType,"onUpdate:value":e[19]||(e[19]=l=>r.matchDimension.ipqcType=l),placeholder:"请选择IPQC类型","allow-clear":""},{default:t(()=>[a(c,{value:"FAI"},{default:t(()=>[...e[55]||(e[55]=[o("FAI-首件检",-1)])]),_:1}),a(c,{value:"PATROL"},{default:t(()=>[...e[56]||(e[56]=[o("PATROL-巡检",-1)])]),_:1}),a(c,{value:"LAI"},{default:t(()=>[...e[57]||(e[57]=[o("LAI-末件检",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):k("",!0),a(f,{label:"优先级",required:""},{default:t(()=>[a(E,{value:r.priority,"onUpdate:value":e[20]||(e[20]=l=>r.priority=l),min:1,max:999,style:{width:"100%"}},null,8,["value"]),e[58]||(e[58]=K("div",{style:{color:"#999","font-size":"12px"}},"数值越小优先级越高",-1))]),_:1}),a(f,{label:"触发条件"},{default:t(()=>[a(S,{value:r.triggerCondition,"onUpdate:value":e[21]||(e[21]=l=>r.triggerCondition=l)},{default:t(()=>[a(c,{value:"ALWAYS"},{default:t(()=>[...e[59]||(e[59]=[o("总是触发",-1)])]),_:1}),a(c,{value:"ON_NEW_SUPPLIER_FIRST_N_BATCHES"},{default:t(()=>[...e[60]||(e[60]=[o("新供应商前N批",-1)])]),_:1}),a(c,{value:"ON_ECN_FIRST_N_BATCHES"},{default:t(()=>[...e[61]||(e[61]=[o("工程变更前N批",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),r.triggerCondition!=="ALWAYS"?(i(),d(f,{key:4,label:"触发阈值"},{default:t(()=>[a(E,{value:r.triggerValue,"onUpdate:value":e[22]||(e[22]=l=>r.triggerValue=l),min:1,placeholder:"请输入批次数"},null,8,["value"])]),_:1})):k("",!0)]),_:1},8,["model"])]),_:1},8,["open","title"]),a(ne,{open:B.value,"onUpdate:open":e[25]||(e[25]=l=>B.value=l),title:"添加不良现象",onOk:Fe,width:"600px"},{default:t(()=>[a(S,{value:Q.value,"onUpdate:value":e[24]||(e[24]=l=>Q.value=l),mode:"multiple",placeholder:"请选择不良现象",style:{width:"100%"},"filter-option":ae,"show-search":""},{default:t(()=>[(i(!0),x(M,null,L(me.value,l=>(i(),d(c,{key:l.id,value:l.id},{default:t(()=>[o(h(l.phenomenonName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1},8,["open"])])}}}),Mt=_t(Nt,[["__scopeId","data-v-15b86726"]]);export{Mt as default};
