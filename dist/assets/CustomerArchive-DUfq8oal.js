import{u as we}from"./excel-B07CBqJs.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as k,a as z,k as Le,m as xe,c as Ne,o as S,e as Z,x as l,q as a,s as n,h as u,y as N,P as Te,G as Ae,I as Ue,Y as Ie,R as Se,p as D,f as M,t as c,M as R,C as L}from"./index-Ozo2vowX.js";import{E as Be}from"./ExportOutlined-Bxr6hJMG.js";const Oe={class:"page-container"},De={class:"toolbar"},Me={class:"table-container"},Pe={__name:"CustomerArchive",setup(Ee){const P=k(!1),y=k(!1),q=k(!1),T=k(!1),m=k(!1),E=k(),b=k([]),r=z({customerCode:"",customerName:"",customerLevel:void 0,status:void 0}),d=z({id:"",customerCode:"",customerName:"",customerLevel:"B",creditLevel:3,creditCode:"",legalPerson:"",phone:"",email:"",address:"",bankName:"",bankAccount:"",remark:"",status:"1"}),ee=[{title:"客户编码",dataIndex:"customerCode",key:"customerCode",width:120},{title:"客户名称",dataIndex:"customerName",key:"customerName",width:180},{title:"客户等级",dataIndex:"customerLevel",key:"customerLevel",width:100},{title:"信用等级",dataIndex:"creditLevel",key:"creditLevel",width:140},{title:"联系电话",dataIndex:"phone",key:"phone",width:130},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:180,fixed:"right"}],f=k([{id:"1",customerCode:"CUST001",customerName:"华为技术有限公司",customerLevel:"A",creditLevel:5,creditCode:"91440300708461136T",legalPerson:"任正非",phone:"0755-28780808",email:"contact@huawei.com",address:"广东省深圳市龙岗区坂田华为基地",bankName:"中国工商银行深圳分行",bankAccount:"622202400001234567",remark:"重要战略客户",status:"1",createTime:"2024-01-15 10:30:00",updateTime:"2024-01-15 10:30:00"},{id:"2",customerCode:"CUST002",customerName:"腾讯科技有限公司",customerLevel:"A",creditLevel:4.5,creditCode:"91440300708461136T",legalPerson:"马化腾",phone:"0755-86013388",email:"contact@tencent.com",address:"广东省深圳市南山区科技园",bankName:"中国建设银行深圳分行",bankAccount:"622700720001234567",remark:"长期合作客户",status:"1",createTime:"2024-01-15 10:35:00",updateTime:"2024-01-15 10:35:00"},{id:"3",customerCode:"CUST003",customerName:"阿里巴巴集团",customerLevel:"A",creditLevel:4.5,creditCode:"91330100MA2802X12X",legalPerson:"张勇",phone:"0571-85022088",email:"contact@alibaba.com",address:"浙江省杭州市余杭区文一西路969号",bankName:"中国工商银行杭州分行",bankAccount:"622202120001234567",remark:"电商领域重要客户",status:"1",createTime:"2024-01-15 10:40:00",updateTime:"2024-01-15 10:40:00"}]),A=z({current:1,pageSize:20,total:3,showSizeChanger:!0,showQuickJumper:!0}),v=k({}),le={customerCode:[{required:!0,message:"请输入客户编码",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户名称",trigger:"blur"}],customerLevel:[{required:!0,message:"请选择客户等级",trigger:"change"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"}]},h=t=>({A:"A级客户",B:"B级客户",C:"C级客户"})[t]||"未知",j=t=>({A:"red",B:"orange",C:"blue"})[t]||"default",ae=Le(()=>m.value?"查看客户档案":T.value?"编辑客户档案":"新增客户档案"),te=t=>{b.value=t},F=()=>{A.current=1,x()},oe=()=>{Object.assign(r,{customerCode:"",customerName:"",customerLevel:void 0,status:void 0}),F()},ue=t=>{A.current=t.current,A.pageSize=t.pageSize,x()},de=()=>{T.value=!1,y.value=!0,X()},ne=()=>{const t=f.value.find(e=>e.id===b.value[0]);t&&K(t)},K=t=>{T.value=!0,m.value=!1,y.value=!0,Object.assign(d,{...t})},se=t=>{T.value=!0,m.value=!0,Object.assign(d,{...t}),y.value=!0},re=t=>{R.confirm({title:"确认删除",content:`确定删除客户 ${t.customerName} 吗？`,okType:"danger",onOk(){const e=f.value.findIndex(s=>s.id===t.id);e>-1&&(f.value.splice(e,1),L.success("删除成功"),x())}})},ie=()=>{R.confirm({title:"确认批量删除",content:`确定删除选中的 ${b.value.length} 条记录吗？`,okType:"danger",onOk(){f.value=f.value.filter(t=>!b.value.includes(t.id)),b.value=[],L.success("删除成功")}})},me=async()=>{try{if(await E.value.validate(),T.value){const t=f.value.findIndex(e=>e.id===d.id);t>-1&&(f.value[t]={...d,updateTime:new Date().toLocaleString()},L.success("更新成功"))}else{const t=(Math.max(...f.value.map(s=>parseInt(s.id)))+1).toString(),e={...d,id:t,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};f.value.push(e),L.success("新增成功")}y.value=!1,x()}catch(t){console.error("表单验证失败:",t)}},ve=()=>{y.value=!1,X()},X=()=>{var t;Object.assign(d,{id:"",customerCode:"",customerName:"",customerLevel:"B",creditLevel:3,creditCode:"",legalPerson:"",phone:"",email:"",address:"",bankName:"",bankAccount:"",remark:"",status:"1"}),(t=E.value)==null||t.resetFields()},ce=()=>{if(f.value.length===0){L.warning("暂无数据可导出");return}const t=[{title:"客户编码",dataIndex:"customerCode"},{title:"客户名称",dataIndex:"customerName"},{title:"客户等级",dataIndex:"customerLevel"},{title:"联系人",dataIndex:"contact"},{title:"联系电话",dataIndex:"phone"},{title:"电子邮箱",dataIndex:"email"},{title:"状态",dataIndex:"status"}],{exportToCSV:e}=we();e(f.value,t,"客户档案"),L.success("导出成功")},fe=({key:t})=>{const e=t==="enable"?"1":"0",s=t==="enable"?"启用":"禁用";R.confirm({title:`确认批量${s}`,content:`确定${s}选中的 ${b.value.length} 条记录吗？`,onOk(){f.value.forEach(U=>{b.value.includes(U.id)&&(U.status=e)}),b.value=[],L.success(`批量${s}成功`)}})},x=()=>{P.value=!0,setTimeout(()=>{let t=[...f.value];r.customerCode&&(t=t.filter(e=>e.customerCode.includes(r.customerCode))),r.customerName&&(t=t.filter(e=>e.customerName.includes(r.customerName))),r.customerLevel&&(t=t.filter(e=>e.customerLevel===r.customerLevel)),r.status!==void 0&&(t=t.filter(e=>e.status===r.status)),A.total=t.length,P.value=!1},300)};return xe(()=>{x()}),(t,e)=>{const s=n("a-button"),U=n("a-menu-item"),pe=n("a-menu"),be=n("a-dropdown"),G=n("a-space"),g=n("a-input"),i=n("a-form-item"),C=n("a-select-option"),V=n("a-select"),J=n("a-form"),_e=n("a-card"),B=n("a-tag"),$=n("a-rate"),O=n("a-divider"),ge=n("a-table"),_=n("a-col"),I=n("a-row"),Q=n("a-radio"),ke=n("a-radio-group"),Y=n("a-textarea"),H=n("a-modal"),p=n("a-descriptions-item"),Ce=n("a-descriptions");return S(),Ne("div",Oe,[Z("div",De,[l(G,null,{default:a(()=>[l(s,{type:"primary",onClick:de},{icon:a(()=>[l(N(Te))]),default:a(()=>[e[19]||(e[19]=u("新增 ",-1))]),_:1}),l(s,{disabled:b.value.length!==1,onClick:ne},{icon:a(()=>[l(N(Ae))]),default:a(()=>[e[20]||(e[20]=u("编辑 ",-1))]),_:1},8,["disabled"]),l(s,{danger:"",disabled:b.value.length===0,onClick:ie},{icon:a(()=>[l(N(Ue))]),default:a(()=>[e[21]||(e[21]=u("删除 ",-1))]),_:1},8,["disabled"]),l(be,{disabled:b.value.length===0},{overlay:a(()=>[l(pe,{onClick:fe},{default:a(()=>[l(U,{key:"enable"},{default:a(()=>[...e[23]||(e[23]=[u("批量启用",-1)])]),_:1}),l(U,{key:"disable"},{default:a(()=>[...e[24]||(e[24]=[u("批量禁用",-1)])]),_:1})]),_:1})]),default:a(()=>[l(s,null,{default:a(()=>[e[22]||(e[22]=u("状态操作 ",-1)),l(N(Ie))]),_:1})]),_:1},8,["disabled"]),l(s,{onClick:ce},{icon:a(()=>[l(N(Be))]),default:a(()=>[e[25]||(e[25]=u("导出 ",-1))]),_:1}),l(s,{onClick:x},{icon:a(()=>[l(N(Se))]),default:a(()=>[e[26]||(e[26]=u("刷新 ",-1))]),_:1})]),_:1})]),l(_e,{class:"search-card",bordered:!1},{default:a(()=>[l(J,{layout:"inline",model:r},{default:a(()=>[l(i,{label:"客户编码"},{default:a(()=>[l(g,{value:r.customerCode,"onUpdate:value":e[0]||(e[0]=o=>r.customerCode=o),placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1}),l(i,{label:"客户名称"},{default:a(()=>[l(g,{value:r.customerName,"onUpdate:value":e[1]||(e[1]=o=>r.customerName=o),placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1}),l(i,{label:"客户等级"},{default:a(()=>[l(V,{value:r.customerLevel,"onUpdate:value":e[2]||(e[2]=o=>r.customerLevel=o),style:{width:"120px"},placeholder:"请选择","allow-clear":""},{default:a(()=>[l(C,{value:"A"},{default:a(()=>[...e[27]||(e[27]=[u("A级客户",-1)])]),_:1}),l(C,{value:"B"},{default:a(()=>[...e[28]||(e[28]=[u("B级客户",-1)])]),_:1}),l(C,{value:"C"},{default:a(()=>[...e[29]||(e[29]=[u("C级客户",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(i,{label:"状态"},{default:a(()=>[l(V,{value:r.status,"onUpdate:value":e[3]||(e[3]=o=>r.status=o),style:{width:"100px"},placeholder:"请选择","allow-clear":""},{default:a(()=>[l(C,{value:"1"},{default:a(()=>[...e[30]||(e[30]=[u("启用",-1)])]),_:1}),l(C,{value:"0"},{default:a(()=>[...e[31]||(e[31]=[u("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),l(i,null,{default:a(()=>[l(s,{type:"primary",onClick:F},{default:a(()=>[...e[32]||(e[32]=[u("查询",-1)])]),_:1}),l(s,{style:{"margin-left":"8px"},onClick:oe},{default:a(()=>[...e[33]||(e[33]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),Z("div",Me,[l(ge,{columns:ee,"data-source":f.value,loading:P.value,"row-key":"id",size:"middle","row-selection":{selectedRowKeys:b.value,onChange:te},pagination:A,onChange:ue},{bodyCell:a(({column:o,record:w})=>[o.key==="customerLevel"?(S(),D(B,{key:0,color:j(w.customerLevel)},{default:a(()=>[u(c(h(w.customerLevel)),1)]),_:2},1032,["color"])):M("",!0),o.key==="creditLevel"?(S(),D($,{key:1,value:w.creditLevel,disabled:"","allow-half":""},null,8,["value"])):M("",!0),o.key==="status"?(S(),D(B,{key:2,color:w.status==="1"?"green":"red"},{default:a(()=>[u(c(w.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):M("",!0),o.key==="action"?(S(),D(G,{key:3},{default:a(()=>[l(s,{type:"link",size:"small",onClick:W=>se(w)},{default:a(()=>[...e[34]||(e[34]=[u("查看",-1)])]),_:1},8,["onClick"]),l(O,{type:"vertical"}),l(s,{type:"link",size:"small",onClick:W=>K(w)},{default:a(()=>[...e[35]||(e[35]=[u("编辑",-1)])]),_:1},8,["onClick"]),l(O,{type:"vertical"}),l(s,{type:"link",danger:"",size:"small",onClick:W=>re(w)},{default:a(()=>[...e[36]||(e[36]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):M("",!0)]),_:1},8,["data-source","loading","row-selection","pagination"])]),l(H,{visible:y.value,"onUpdate:visible":e[17]||(e[17]=o=>y.value=o),title:ae.value,width:"1000px",onOk:me,onCancel:ve,footer:m.value?null:void 0},{default:a(()=>[l(J,{ref_key:"formRef",ref:E,model:d,rules:le,layout:"vertical"},{default:a(()=>[l(I,{gutter:16},{default:a(()=>[l(_,{span:12},{default:a(()=>[l(i,{label:"客户编码",name:"customerCode"},{default:a(()=>[l(g,{value:d.customerCode,"onUpdate:value":e[4]||(e[4]=o=>d.customerCode=o),placeholder:"请输入客户编码",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:12},{default:a(()=>[l(i,{label:"客户名称",name:"customerName"},{default:a(()=>[l(g,{value:d.customerName,"onUpdate:value":e[5]||(e[5]=o=>d.customerName=o),placeholder:"请输入客户名称",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(I,{gutter:16},{default:a(()=>[l(_,{span:8},{default:a(()=>[l(i,{label:"客户等级",name:"customerLevel"},{default:a(()=>[l(V,{value:d.customerLevel,"onUpdate:value":e[6]||(e[6]=o=>d.customerLevel=o),placeholder:"请选择客户等级",disabled:m.value},{default:a(()=>[l(C,{value:"A"},{default:a(()=>[...e[37]||(e[37]=[u("A级客户",-1)])]),_:1}),l(C,{value:"B"},{default:a(()=>[...e[38]||(e[38]=[u("B级客户",-1)])]),_:1}),l(C,{value:"C"},{default:a(()=>[...e[39]||(e[39]=[u("C级客户",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:8},{default:a(()=>[l(i,{label:"信用等级",name:"creditLevel"},{default:a(()=>[l($,{value:d.creditLevel,"onUpdate:value":e[7]||(e[7]=o=>d.creditLevel=o),"allow-half":"",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:8},{default:a(()=>[l(i,{label:"状态",name:"status"},{default:a(()=>[l(ke,{value:d.status,"onUpdate:value":e[8]||(e[8]=o=>d.status=o),disabled:m.value},{default:a(()=>[l(Q,{value:"1"},{default:a(()=>[...e[40]||(e[40]=[u("启用",-1)])]),_:1}),l(Q,{value:"0"},{default:a(()=>[...e[41]||(e[41]=[u("禁用",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:a(()=>[...e[42]||(e[42]=[u("基本信息",-1)])]),_:1}),l(I,{gutter:16},{default:a(()=>[l(_,{span:12},{default:a(()=>[l(i,{label:"统一社会信用代码",name:"creditCode"},{default:a(()=>[l(g,{value:d.creditCode,"onUpdate:value":e[9]||(e[9]=o=>d.creditCode=o),placeholder:"请输入统一社会信用代码",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:12},{default:a(()=>[l(i,{label:"法定代表人",name:"legalPerson"},{default:a(()=>[l(g,{value:d.legalPerson,"onUpdate:value":e[10]||(e[10]=o=>d.legalPerson=o),placeholder:"请输入法定代表人",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(I,{gutter:16},{default:a(()=>[l(_,{span:12},{default:a(()=>[l(i,{label:"联系电话",name:"phone"},{default:a(()=>[l(g,{value:d.phone,"onUpdate:value":e[11]||(e[11]=o=>d.phone=o),placeholder:"请输入联系电话",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:12},{default:a(()=>[l(i,{label:"邮箱地址",name:"email"},{default:a(()=>[l(g,{value:d.email,"onUpdate:value":e[12]||(e[12]=o=>d.email=o),placeholder:"请输入邮箱地址",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(i,{label:"详细地址",name:"address"},{default:a(()=>[l(Y,{value:d.address,"onUpdate:value":e[13]||(e[13]=o=>d.address=o),placeholder:"请输入详细地址",rows:2,disabled:m.value},null,8,["value","disabled"])]),_:1}),l(O,null,{default:a(()=>[...e[43]||(e[43]=[u("其他信息",-1)])]),_:1}),l(I,{gutter:16},{default:a(()=>[l(_,{span:12},{default:a(()=>[l(i,{label:"开户银行",name:"bankName"},{default:a(()=>[l(g,{value:d.bankName,"onUpdate:value":e[14]||(e[14]=o=>d.bankName=o),placeholder:"请输入开户银行",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1}),l(_,{span:12},{default:a(()=>[l(i,{label:"银行账号",name:"bankAccount"},{default:a(()=>[l(g,{value:d.bankAccount,"onUpdate:value":e[15]||(e[15]=o=>d.bankAccount=o),placeholder:"请输入银行账号",disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),l(i,{label:"备注",name:"remark"},{default:a(()=>[l(Y,{value:d.remark,"onUpdate:value":e[16]||(e[16]=o=>d.remark=o),placeholder:"请输入备注信息",rows:3,disabled:m.value},null,8,["value","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","footer"]),l(H,{visible:q.value,"onUpdate:visible":e[18]||(e[18]=o=>q.value=o),title:"客户详情",width:"900px",footer:null},{default:a(()=>[l(Ce,{column:3,bordered:""},{default:a(()=>[l(p,{label:"客户编码"},{default:a(()=>[u(c(v.value.customerCode),1)]),_:1}),l(p,{label:"客户名称"},{default:a(()=>[u(c(v.value.customerName),1)]),_:1}),l(p,{label:"客户等级"},{default:a(()=>[l(B,{color:j(v.value.customerLevel)},{default:a(()=>[u(c(h(v.value.customerLevel)),1)]),_:1},8,["color"])]),_:1}),l(p,{label:"信用等级"},{default:a(()=>[l($,{value:v.value.creditLevel,disabled:"","allow-half":""},null,8,["value"])]),_:1}),l(p,{label:"统一社会信用代码"},{default:a(()=>[u(c(v.value.creditCode),1)]),_:1}),l(p,{label:"法定代表人"},{default:a(()=>[u(c(v.value.legalPerson),1)]),_:1}),l(p,{label:"联系电话"},{default:a(()=>[u(c(v.value.phone),1)]),_:1}),l(p,{label:"邮箱地址"},{default:a(()=>[u(c(v.value.email),1)]),_:1}),l(p,{label:"状态"},{default:a(()=>[l(B,{color:v.value.status==="1"?"green":"red"},{default:a(()=>[u(c(v.value.status==="1"?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),l(p,{label:"详细地址",span:3},{default:a(()=>[u(c(v.value.address),1)]),_:1}),l(p,{label:"开户银行"},{default:a(()=>[u(c(v.value.bankName),1)]),_:1}),l(p,{label:"银行账号"},{default:a(()=>[u(c(v.value.bankAccount),1)]),_:1}),l(p,{label:"创建时间"},{default:a(()=>[u(c(v.value.createTime),1)]),_:1}),l(p,{label:"备注",span:3},{default:a(()=>[u(c(v.value.remark||"无"),1)]),_:1})]),_:1})]),_:1},8,["visible"])])}}},qe=ye(Pe,[["__scopeId","data-v-e48f6a85"]]);export{qe as default};
