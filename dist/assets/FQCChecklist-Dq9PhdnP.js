import{a as I,r as C,m as re,c as M,o as y,e as Y,x as e,q as a,h as v,y as z,P,s as d,p as q,f as B,t as pe,F as ce,z as ve,E as F,C as N}from"./index-BsO03Xlk.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"page-container"},ge={class:"page-header"},_e={class:"search-form"},be={__name:"FQCChecklist",setup(ye){const p=I({inspectionNo:"",batchNo:"",productCode:"",status:""}),f=C([]),D=C(!1),g=I({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:o=>`共 ${o} 条数据`}),R=[{title:"检验单号",dataIndex:"inspectionNo",key:"inspectionNo",width:140},{title:"生产批次",dataIndex:"batchNo",key:"batchNo",width:120},{title:"产品编码",dataIndex:"productCode",key:"productCode",width:120},{title:"产品名称",dataIndex:"productName",key:"productName"},{title:"生产数量",dataIndex:"productionQuantity",key:"productionQuantity",width:100},{title:"抽样数量",dataIndex:"sampleQuantity",key:"sampleQuantity",width:100},{title:"检验状态",dataIndex:"status",key:"status",width:100},{title:"检验日期",dataIndex:"inspectionDate",key:"inspectionDate",width:120},{title:"检验员",dataIndex:"inspector",key:"inspector",width:100},{title:"操作",key:"action",width:200,fixed:"right"}],_=C(!1),h=C(!1),U=C(),n=I({id:null,inspectionNo:"",batchNo:"",inspectionDate:null,productCode:"",productName:"",specification:"",productionQuantity:null,sampleQuantity:null,inspector:"",inspectionStandard:"",inspectionLevel:"normal",items:[],conclusion:"passed",disposalMethod:"release",remark:"",status:"pending"}),T={batchNo:[{required:!0,message:"请输入生产批次号",trigger:"blur"}],inspectionDate:[{required:!0,message:"请选择检验日期",trigger:"change"}],productCode:[{required:!0,message:"请输入产品编码",trigger:"blur"}],productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],productionQuantity:[{required:!0,message:"请输入生产数量",trigger:"blur"}],sampleQuantity:[{required:!0,message:"请输入抽样数量",trigger:"blur"}],inspector:[{required:!0,message:"请输入检验员姓名",trigger:"blur"}],inspectionStandard:[{required:!0,message:"请选择检验标准",trigger:"change"}],inspectionLevel:[{required:!0,message:"请选择检验级别",trigger:"change"}],conclusion:[{required:!0,message:"请选择检验结论",trigger:"change"}],disposalMethod:[{required:!0,message:"请选择处理方式",trigger:"change"}]},L=[{id:1,inspectionNo:"FQC20240115001",batchNo:"BATCH20240115001",inspectionDate:"2024-01-15",productCode:"PROD001",productName:"成品A",specification:"SPEC-A001",productionQuantity:1e3,sampleQuantity:80,inspector:"张三",inspectionStandard:"GB2828",inspectionLevel:"normal",status:"passed",conclusion:"passed",disposalMethod:"release",remark:"检验合格，准予放行"},{id:2,inspectionNo:"FQC20240116001",batchNo:"BATCH20240116001",inspectionDate:"2024-01-16",productCode:"PROD002",productName:"成品B",specification:"SPEC-B001",productionQuantity:500,sampleQuantity:50,inspector:"李四",inspectionStandard:"ISO9001",inspectionLevel:"tightened",status:"failed",conclusion:"failed",disposalMethod:"rework",remark:"外观缺陷，需要返工处理"},{id:3,inspectionNo:"FQC20240117001",batchNo:"BATCH20240117001",inspectionDate:"2024-01-17",productCode:"PROD003",productName:"成品C",specification:"SPEC-C001",productionQuantity:800,sampleQuantity:64,inspector:"王五",inspectionStandard:"enterprise",inspectionLevel:"normal",status:"pending",conclusion:"passed",disposalMethod:"release",remark:""}],$=o=>({pending:"orange",inspecting:"blue",passed:"green",failed:"red"})[o]||"default",E=o=>({pending:"待检验",inspecting:"检验中",passed:"合格",failed:"不合格"})[o]||o,w=()=>{D.value=!0,setTimeout(()=>{f.value=L,g.total=L.length,D.value=!1},500)},O=()=>{g.current=1,w()},A=()=>{p.inspectionNo="",p.batchNo="",p.productCode="",p.status="",O()},j=o=>{g.current=o.current,g.pageSize=o.pageSize,w()},G=()=>{h.value=!1,_.value=!0,x()},H=o=>{h.value=!0,_.value=!0,Object.assign(n,{...o,inspectionDate:o.inspectionDate?F(o.inspectionDate):null,items:o.items||[{category:"",name:"",standard:"",unit:"",actualValue:null,result:"pass",remark:""}]})},J=o=>{N.info("查看功能开发中...")},K=o=>{o.status="inspecting",N.success("已开始检验")},W=o=>{const t=f.value.findIndex(c=>c.id===o);t>-1&&(f.value.splice(t,1),g.total--,N.success("删除成功"))},X=()=>{n.items.push({category:"",name:"",standard:"",unit:"",actualValue:null,result:"pass",remark:""})},Z=o=>{n.items.length>1&&n.items.splice(o,1)},ee=async()=>{try{if(await U.value.validate(),h.value){const o=f.value.findIndex(t=>t.id===n.id);o>-1&&(f.value[o]={...n,inspectionDate:n.inspectionDate?n.inspectionDate.format("YYYY-MM-DD"):null}),N.success("更新成功")}else{const o=Math.max(...f.value.map(r=>r.id))+1,t=`FQC${F().format("YYYYMMDD")}${String(o).padStart(3,"0")}`,c={...n,id:o,inspectionNo:t,inspectionDate:n.inspectionDate?n.inspectionDate.format("YYYY-MM-DD"):F().format("YYYY-MM-DD"),status:"pending"};f.value.unshift(c),g.total++,N.success("创建成功")}_.value=!1,x()}catch(o){console.error("表单验证失败:",o)}},te=()=>{_.value=!1,x()},x=()=>{var o;Object.assign(n,{id:null,inspectionNo:"",batchNo:"",inspectionDate:null,productCode:"",productName:"",specification:"",productionQuantity:null,sampleQuantity:null,inspector:"",inspectionStandard:"",inspectionLevel:"normal",items:[{category:"",name:"",standard:"",unit:"",actualValue:null,result:"pass",remark:""}],conclusion:"passed",disposalMethod:"release",remark:"",status:"pending"}),(o=U.value)==null||o.resetFields()};return re(()=>{w()}),(o,t)=>{const c=d("a-button"),r=d("a-input"),u=d("a-form-item"),k=d("a-select"),V=d("a-form"),ae=d("a-tag"),le=d("a-popconfirm"),ne=d("a-space"),oe=d("a-table"),s=d("a-col"),se=d("a-date-picker"),b=d("a-row"),Q=d("a-input-number"),S=d("a-radio"),ue=d("a-radio-group"),ie=d("a-textarea"),de=d("a-modal");return y(),M("div",fe,[Y("div",ge,[t[20]||(t[20]=Y("h1",null,"成品检验单(FQC)",-1)),e(c,{type:"primary",onClick:G},{icon:a(()=>[e(z(P))]),default:a(()=>[t[19]||(t[19]=v(" 新建检验单 ",-1))]),_:1})]),Y("div",_e,[e(V,{layout:"inline",model:p},{default:a(()=>[e(u,{label:"检验单号"},{default:a(()=>[e(r,{value:p.inspectionNo,"onUpdate:value":t[0]||(t[0]=l=>p.inspectionNo=l),placeholder:"请输入检验单号"},null,8,["value"])]),_:1}),e(u,{label:"生产批次"},{default:a(()=>[e(r,{value:p.batchNo,"onUpdate:value":t[1]||(t[1]=l=>p.batchNo=l),placeholder:"请输入生产批次号"},null,8,["value"])]),_:1}),e(u,{label:"产品编码"},{default:a(()=>[e(r,{value:p.productCode,"onUpdate:value":t[2]||(t[2]=l=>p.productCode=l),placeholder:"请输入产品编码"},null,8,["value"])]),_:1}),e(u,{label:"检验状态"},{default:a(()=>[e(k,{value:p.status,"onUpdate:value":t[3]||(t[3]=l=>p.status=l),placeholder:"请选择检验状态",style:{width:"120px"},options:[{value:"pending",label:"待检验"},{value:"inspecting",label:"检验中"},{value:"passed",label:"合格"},{value:"failed",label:"不合格"}]},null,8,["value"])]),_:1}),e(u,null,{default:a(()=>[e(c,{type:"primary",onClick:O},{default:a(()=>[...t[21]||(t[21]=[v("查询",-1)])]),_:1}),e(c,{style:{"margin-left":"8px"},onClick:A},{default:a(()=>[...t[22]||(t[22]=[v("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),e(oe,{columns:R,"data-source":f.value,pagination:g,loading:D.value,onChange:j,"row-key":"id"},{bodyCell:a(({column:l,record:m})=>[l.key==="status"?(y(),q(ae,{key:0,color:$(m.status)},{default:a(()=>[v(pe(E(m.status)),1)]),_:2},1032,["color"])):B("",!0),l.key==="action"?(y(),q(ne,{key:1},{default:a(()=>[e(c,{type:"link",size:"small",onClick:i=>H(m)},{default:a(()=>[...t[23]||(t[23]=[v("编辑",-1)])]),_:1},8,["onClick"]),e(c,{type:"link",size:"small",onClick:i=>J(m)},{default:a(()=>[...t[24]||(t[24]=[v("查看",-1)])]),_:1},8,["onClick"]),m.status==="pending"?(y(),q(c,{key:0,type:"link",size:"small",onClick:i=>K(m)},{default:a(()=>[...t[25]||(t[25]=[v(" 开始检验 ",-1)])]),_:1},8,["onClick"])):B("",!0),e(le,{title:"确定要删除这个检验单吗？",onConfirm:i=>W(m.id)},{default:a(()=>[e(c,{type:"link",size:"small",danger:""},{default:a(()=>[...t[26]||(t[26]=[v("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):B("",!0)]),_:1},8,["data-source","pagination","loading"]),e(de,{visible:_.value,"onUpdate:visible":t[18]||(t[18]=l=>_.value=l),title:h.value?"编辑检验单":"新建检验单",width:"1100px",onOk:ee,onCancel:te},{default:a(()=>[e(V,{ref_key:"formRef",ref:U,model:n,rules:T,layout:"vertical"},{default:a(()=>[e(b,{gutter:16},{default:a(()=>[e(s,{span:8},{default:a(()=>[e(u,{label:"检验单号",name:"inspectionNo"},{default:a(()=>[e(r,{value:n.inspectionNo,"onUpdate:value":t[4]||(t[4]=l=>n.inspectionNo=l),placeholder:"系统自动生成",disabled:""},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"生产批次",name:"batchNo"},{default:a(()=>[e(r,{value:n.batchNo,"onUpdate:value":t[5]||(t[5]=l=>n.batchNo=l),placeholder:"请输入生产批次号"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"检验日期",name:"inspectionDate"},{default:a(()=>[e(se,{value:n.inspectionDate,"onUpdate:value":t[6]||(t[6]=l=>n.inspectionDate=l),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(b,{gutter:16},{default:a(()=>[e(s,{span:8},{default:a(()=>[e(u,{label:"产品编码",name:"productCode"},{default:a(()=>[e(r,{value:n.productCode,"onUpdate:value":t[7]||(t[7]=l=>n.productCode=l),placeholder:"请输入产品编码"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"产品名称",name:"productName"},{default:a(()=>[e(r,{value:n.productName,"onUpdate:value":t[8]||(t[8]=l=>n.productName=l),placeholder:"请输入产品名称"},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"规格型号",name:"specification"},{default:a(()=>[e(r,{value:n.specification,"onUpdate:value":t[9]||(t[9]=l=>n.specification=l),placeholder:"请输入规格型号"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(b,{gutter:16},{default:a(()=>[e(s,{span:8},{default:a(()=>[e(u,{label:"生产数量",name:"productionQuantity"},{default:a(()=>[e(Q,{value:n.productionQuantity,"onUpdate:value":t[10]||(t[10]=l=>n.productionQuantity=l),placeholder:"请输入生产数量",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"抽样数量",name:"sampleQuantity"},{default:a(()=>[e(Q,{value:n.sampleQuantity,"onUpdate:value":t[11]||(t[11]=l=>n.sampleQuantity=l),placeholder:"请输入抽样数量",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),e(s,{span:8},{default:a(()=>[e(u,{label:"检验员",name:"inspector"},{default:a(()=>[e(r,{value:n.inspector,"onUpdate:value":t[12]||(t[12]=l=>n.inspector=l),placeholder:"请输入检验员姓名"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(b,{gutter:16},{default:a(()=>[e(s,{span:12},{default:a(()=>[e(u,{label:"检验标准",name:"inspectionStandard"},{default:a(()=>[e(k,{value:n.inspectionStandard,"onUpdate:value":t[13]||(t[13]=l=>n.inspectionStandard=l),placeholder:"请选择检验标准",options:[{value:"GB2828",label:"GB2828"},{value:"ISO9001",label:"ISO9001"},{value:"enterprise",label:"企业标准"},{value:"custom",label:"自定义标准"}]},null,8,["value"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{label:"检验级别",name:"inspectionLevel"},{default:a(()=>[e(k,{value:n.inspectionLevel,"onUpdate:value":t[14]||(t[14]=l=>n.inspectionLevel=l),placeholder:"请选择检验级别",options:[{value:"normal",label:"正常检验"},{value:"tightened",label:"加严检验"},{value:"relaxed",label:"放宽检验"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(u,{label:"检验项目",name:"items"},{default:a(()=>[(y(!0),M(ce,null,ve(n.items,(l,m)=>(y(),M("div",{key:m,class:"inspection-item"},[e(b,{gutter:8},{default:a(()=>[e(s,{span:3},{default:a(()=>[e(r,{value:l.category,"onUpdate:value":i=>l.category=i,placeholder:"类别"},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:4},{default:a(()=>[e(r,{value:l.name,"onUpdate:value":i=>l.name=i,placeholder:"检验项目"},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:3},{default:a(()=>[e(r,{value:l.standard,"onUpdate:value":i=>l.standard=i,placeholder:"标准值"},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:2},{default:a(()=>[e(r,{value:l.unit,"onUpdate:value":i=>l.unit=i,placeholder:"单位"},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:2},{default:a(()=>[e(Q,{value:l.actualValue,"onUpdate:value":i=>l.actualValue=i,placeholder:"实测值",style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:2},{default:a(()=>[e(k,{value:l.result,"onUpdate:value":i=>l.result=i,placeholder:"结果",options:[{value:"pass",label:"合格"},{value:"fail",label:"不合格"}]},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:4},{default:a(()=>[e(r,{value:l.remark,"onUpdate:value":i=>l.remark=i,placeholder:"备注"},null,8,["value","onUpdate:value"])]),_:2},1024),e(s,{span:2},{default:a(()=>[e(c,{type:"text",danger:"",onClick:i=>Z(m)},{default:a(()=>[...t[27]||(t[27]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),e(c,{type:"dashed",onClick:X,style:{width:"100%","margin-top":"8px"}},{icon:a(()=>[e(z(P))]),default:a(()=>[t[28]||(t[28]=v(" 添加检验项目 ",-1))]),_:1})]),_:1}),e(b,{gutter:16},{default:a(()=>[e(s,{span:12},{default:a(()=>[e(u,{label:"检验结论",name:"conclusion"},{default:a(()=>[e(ue,{value:n.conclusion,"onUpdate:value":t[15]||(t[15]=l=>n.conclusion=l)},{default:a(()=>[e(S,{value:"passed"},{default:a(()=>[...t[29]||(t[29]=[v("合格",-1)])]),_:1}),e(S,{value:"failed"},{default:a(()=>[...t[30]||(t[30]=[v("不合格",-1)])]),_:1}),e(S,{value:"conditional"},{default:a(()=>[...t[31]||(t[31]=[v("有条件接收",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{label:"处理方式",name:"disposalMethod"},{default:a(()=>[e(k,{value:n.disposalMethod,"onUpdate:value":t[16]||(t[16]=l=>n.disposalMethod=l),placeholder:"请选择处理方式",options:[{value:"release",label:"放行"},{value:"rework",label:"返工"},{value:"scrap",label:"报废"},{value:"hold",label:"暂扣"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(u,{label:"备注",name:"remark"},{default:a(()=>[e(ie,{value:n.remark,"onUpdate:value":t[17]||(t[17]=l=>n.remark=l),rows:3,placeholder:"请输入备注信息"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}},Ne=me(be,[["__scopeId","data-v-5b2d5233"]]);export{Ne as default};
