import{x as t,N as ke,d as Qe,r as A,a as H,k as j,j as we,l as Me,m as Se,c as O,e as k,f as P,q as a,s as v,p as _,t as Q,o as y,h as o,y as W,K as Le,F as B,z as Ue,P as Ee,a8 as Re,C as R,u as Ve}from"./index-CAjnGs0g.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M251.2 387H320v68.8c0 1.8 1.8 3.2 4 3.2h48c2.2 0 4-1.4 4-3.3V387h68.8c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H376v-68.8c0-1.8-1.8-3.2-4-3.2h-48c-2.2 0-4 1.4-4 3.2V331h-68.8c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm328 0h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm0 265h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm0 104h193.6c1.8 0 3.2-1.8 3.2-4v-48c0-2.2-1.4-4-3.3-4H579.2c-1.8 0-3.2 1.8-3.2 4v48c0 2.2 1.4 4 3.2 4zm-195.7-81l61.2-74.9c4.3-5.2.7-13.1-5.9-13.1H388c-2.3 0-4.5 1-5.9 2.9l-34 41.6-34-41.6a7.85 7.85 0 00-5.9-2.9h-50.9c-6.6 0-10.2 7.9-5.9 13.1l61.2 74.9-62.7 76.8c-4.4 5.2-.8 13.1 5.8 13.1h50.8c2.3 0 4.5-1 5.9-2.9l35.5-43.5 35.5 43.5c1.5 1.8 3.7 2.9 5.9 2.9h50.8c6.6 0 10.2-7.9 5.9-13.1L383.5 675zM880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-36 732H180V180h664v664z"}}]},name:"calculator",theme:"outlined"};function de(d){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?Object(arguments[s]):{},T=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(T=T.concat(Object.getOwnPropertySymbols(r).filter(function(b){return Object.getOwnPropertyDescriptor(r,b).enumerable}))),T.forEach(function(b){De(d,b,r[b])})}return d}function De(d,s,r){return s in d?Object.defineProperty(d,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):d[s]=r,d}var Y=function(s,r){var T=de({},s,r.attrs);return t(ke,de({},T,{icon:Ge}),null)};Y.displayName="CalculatorOutlined";Y.inheritAttrs=!1;function qe(d,s){var T;if(d.contextType!==s.contextType||d.orgId!==s.orgId||d.triggerCondition&&d.triggerCondition!=="ALWAYS"&&!((T=s.activeTriggers)!=null&&T.includes(d.triggerCondition)))return-1;let r=0;if(d.triggerCondition&&d.triggerCondition!=="ALWAYS"&&(r+=2e3),d.materialId)if(d.materialId===s.materialId)r+=300;else return-1;if(d.materialGroupId)if(d.materialGroupId===s.materialGroupId)r+=200;else return-1;if(s.contextType==="IQC"&&d.supplierId)if(d.supplierId===s.supplierId)r+=500;else return-1;if(s.contextType==="OQC"&&d.customerId)if(d.customerId===s.customerId)r+=500;else return-1;if(s.contextType==="IPQC"&&d.operationNo)if(d.operationNo===s.operationNo)r+=400;else return-1;if(s.contextType==="IPQC"&&d.ipqcType)if(d.ipqcType===s.ipqcType)r+=300;else return-1;return r+=100,r-=(d.priority||0)*.1,r}function Be(d,s){const r=[];if(d.triggerCondition&&d.triggerCondition!=="ALWAYS"){const T={ON_NEW_SUPPLIER_FIRST_N_BATCHES:"新供应商",ON_ECN_FIRST_N_BATCHES:"ECN变更"};r.push(T[d.triggerCondition]||d.triggerCondition)}if(d.materialId?r.push("物料"):d.materialGroupId&&r.push("物料组"),d.supplierId&&r.push("供应商"),d.customerId&&r.push("客户"),d.operationNo&&r.push("工序"),d.ipqcType){const T={FAI:"首检",PATROL:"巡检",LAI:"末检"};r.push(T[d.ipqcType]||d.ipqcType)}return r.length===0?"通用方案":r.join(" + ")+" 匹配"}function ze(d,s){const r=d.filter(n=>n.status==="APPROVED");if(r.length===0)return{plan:null,matchType:"无可用方案",isExactMatch:!1,candidates:[]};const T=r.map(n=>({plan:n,score:qe(n,s)})).filter(n=>n.score>0).sort((n,N)=>N.score-n.score);if(T.length===0)return{plan:null,matchType:"无匹配方案",isExactMatch:!1,candidates:[]};const b=T[0],V=Be(b.plan),S=b.score>=400;return{plan:b.plan,matchType:V,isExactMatch:S,candidates:T.map(n=>n.plan)}}const He={class:"page-container"},je={class:"page-header"},We={class:"header-left"},Ye={class:"title-section"},$e={class:"page-title"},Ke={key:0,class:"header-actions"},Je={key:0,class:"tab-toolbar"},Xe={key:0,style:{color:"#999"}},Ze={style:{"margin-left":"8px"}},he={style:{"margin-top":"8px"}},et=Qe({__name:"InspPlanEdit",setup(d){const s=Ve(),r=we(),T=A(),b=A(!1),V=A("context"),S=A(!1),n=H({contextType:"IQC",materialId:void 0,supplierId:void 0,operationNo:void 0,ipqcType:void 0,orgId:"ORG001",activeTriggers:[]}),N=A(null),g=j(()=>r.path.includes("/view/")),$=j(()=>r.path.includes("/edit/")),ue=j(()=>g.value?"查看检验方案":$.value?"编辑检验方案":"新增检验方案"),ie=A([{id:"1",name:"IQC原材料检验模板"},{id:"2",name:"IPQC过程检验模板"},{id:"3",name:"FQC成品检验模板"},{id:"4",name:"OQC出货检验模板"}]),u=H({id:"",planCode:"",planName:"",version:"V1.0",status:"DRAFT",orgId:"ORG001",templateCode:"",contextType:void 0,materialId:void 0,materialGroupId:void 0,supplierId:void 0,customerId:void 0,operationNo:void 0,ipqcType:void 0,triggerCondition:"ALWAYS",triggerValue:void 0,priority:50,description:""}),F=A(void 0);Me(F,I=>{u.templateCode=I?`TPL-${I}`:""});const K={planCode:[{required:!0,message:"请输入方案编码",trigger:"blur"}],planName:[{required:!0,message:"请输入方案名称",trigger:"blur"}],contextType:[{required:!0,message:"请选择业务类型",trigger:"change"}],templateCode:[{required:!0,message:"请关联检验模板",trigger:"change"}],priority:[{required:!0,message:"请设置优先级",trigger:"change"}]},re=I=>({DRAFT:"default",IN_APPROVAL:"processing",APPROVED:"success",OBSOLETE:"error"})[I||"DRAFT"]||"default",ne=I=>({DRAFT:"草稿",IN_APPROVAL:"审批中",APPROVED:"已批准",OBSOLETE:"已作废"})[I||"DRAFT"]||I,J=A([]),se=[{title:"检验项目",dataIndex:"itemName",key:"itemName",width:150},{title:"抽样规则",dataIndex:"samplingRuleName",key:"samplingRuleName",width:150},{title:"检验方法",dataIndex:"methodName",key:"methodName",width:120},{title:"量检具",dataIndex:"instrumentName",key:"instrumentName",width:100},{title:"操作",key:"action",width:80}],x=A([]),pe=[{title:"物料编码",dataIndex:"materialCode",key:"materialCode",width:120},{title:"检验项目",dataIndex:"inspItemName",key:"inspItemName",width:120},{title:"数据类型",dataIndex:"dataType",key:"dataType",width:100},{title:"目标值",dataIndex:"targetValue",key:"targetValue",width:80},{title:"上限",dataIndex:"upperLimit",key:"upperLimit",width:80},{title:"下限",dataIndex:"lowerLimit",key:"lowerLimit",width:80},{title:"标准描述",dataIndex:"standardDesc",key:"standardDesc",width:150},{title:"单位",dataIndex:"uom",key:"uom",width:60},{title:"操作",key:"action",width:120}],L=A(!1),X=A(),m=H({id:"",materialCode:"",inspItemName:"",dataType:"QUANTITATIVE",targetValue:void 0,upperLimit:void 0,lowerLimit:void 0,uom:"",standardDesc:"",expectedValue:""}),G=A(!1),me=()=>{s.push("/inspection-model/insp-plans")},ve=async()=>{var I;try{b.value=!0,await((I=T.value)==null?void 0:I.validate()),R.success("保存成功"),s.push("/inspection-model/insp-plans")}catch(e){console.error(e),R.error("请完善必填项")}finally{b.value=!1}},fe=()=>{G.value=!1,Object.assign(m,{id:Date.now().toString(),materialCode:u.materialId||"M001",inspItemName:"",dataType:"QUANTITATIVE",targetValue:void 0,upperLimit:void 0,lowerLimit:void 0,uom:"mm",standardDesc:"",expectedValue:""}),L.value=!0},Ie=I=>{G.value=!0,Object.assign(m,I),L.value=!0},ye=I=>{x.value=x.value.filter(e=>e.id!==I.id),R.success("已删除物料规格")},Te=()=>{X.value.validate().then(()=>{if(G.value){const I=x.value.findIndex(e=>e.id===m.id);I>-1&&(x.value[I]={...m})}else x.value.push({...m});L.value=!1,R.success("规格保存成功")})},ge=[{id:"P001",planName:"IQC通用方案",planCode:"IP-IQC-COMMON",templateCode:"TPL-IQC-001",contextType:"IQC",materialId:void 0,materialGroupId:"MG01",supplierId:void 0,operationNo:void 0,orgId:"ORG001",priority:99,status:"APPROVED"},{id:"P002",planName:"IQC-电子元器件方案",planCode:"IP-IQC-ELEC",templateCode:"TPL-IQC-001",contextType:"IQC",materialId:"MAT001",materialGroupId:"MG01",supplierId:void 0,operationNo:void 0,orgId:"ORG001",priority:50,status:"APPROVED"},{id:"P003",planName:"IQC-供应商甲专用方案",planCode:"IP-IQC-SUP001",templateCode:"TPL-IQC-002",contextType:"IQC",materialId:"MAT001",materialGroupId:"MG01",supplierId:"SUP001",operationNo:void 0,orgId:"ORG001",priority:10,status:"APPROVED"},{id:"P004",planName:"IPQC通用方案",planCode:"IP-IPQC-COMMON",templateCode:"TPL-IPQC-001",contextType:"IPQC",materialId:void 0,materialGroupId:void 0,supplierId:void 0,operationNo:void 0,orgId:"ORG001",priority:99,status:"APPROVED"},{id:"P005",planName:"IPQC-焊接工序方案",planCode:"IP-IPQC-OP010",templateCode:"TPL-IPQC-002",contextType:"IPQC",materialId:void 0,materialGroupId:void 0,supplierId:void 0,operationNo:"OP010",orgId:"ORG001",priority:30,status:"APPROVED"},{id:"P006",planName:"IPQC-电子件焊接方案",planCode:"IP-IPQC-ELEC-OP010",templateCode:"TPL-IPQC-003",contextType:"IPQC",materialId:"MAT001",materialGroupId:"MG01",supplierId:void 0,operationNo:"OP010",orgId:"ORG001",priority:10,status:"APPROVED"}],Ce=()=>{const I={contextType:n.contextType,materialId:n.materialId,supplierId:n.supplierId,operationNo:n.operationNo,ipqcType:n.ipqcType,activeTriggers:n.activeTriggers,orgId:n.orgId};N.value=ze(ge,I),R.success("匹配完成")};return Se(()=>{const I=r.params.id;I&&(Object.assign(u,{id:I,planCode:"IP-HFC-CASTING-FAI",planName:"合肥工厂-压铸件首检方案",version:"V1.0",status:"APPROVED",orgId:"ORG001",templateCode:"TPL-IPQC-002",contextType:"IPQC",materialId:"M007",operationNo:"OP020",ipqcType:"FAI",priority:10,triggerCondition:"ALWAYS",remark:"用于压铸件首件检验"}),F.value="2",J.value=[{id:"701",itemName:"壳体A面平面度",samplingRuleName:"全检",methodName:"三坐标测量",instrumentName:"三坐标测量机"}],x.value=[{id:"901",materialCode:"M007",inspItemName:"壳体A面平面度",dataType:"QUANTITATIVE",targetValue:.05,upperLimit:.08,lowerLimit:0,uom:"mm"}])}),(I,e)=>{const w=v("a-button"),U=v("a-tag"),M=v("a-input"),p=v("a-form-item"),f=v("a-col"),D=v("a-input-number"),c=v("a-row"),Z=v("a-textarea"),q=v("a-form"),z=v("a-card"),i=v("a-select-option"),C=v("a-select"),_e=v("a-space"),h=v("a-table"),ee=v("a-tab-pane"),te=v("a-alert"),Pe=v("a-tabs"),ae=v("a-radio"),be=v("a-radio-group"),le=v("a-modal"),oe=v("a-checkbox"),ce=v("a-checkbox-group"),Ae=v("a-divider"),Ne=v("a-result"),Oe=v("a-empty");return y(),O("div",He,[k("div",je,[k("div",We,[t(w,{type:"text",onClick:me,class:"back-button"},{icon:a(()=>[t(W(Le))]),default:a(()=>[e[34]||(e[34]=o(" 返回 ",-1))]),_:1}),k("div",Ye,[k("h2",$e,Q(ue.value),1),u.version?(y(),_(U,{key:0,color:"blue"},{default:a(()=>[o(Q(u.version),1)]),_:1})):P("",!0),t(U,{color:re(u.status)},{default:a(()=>[o(Q(ne(u.status)),1)]),_:1},8,["color"])])]),g.value?P("",!0):(y(),O("div",Ke,[t(w,{size:"small",style:{"margin-right":"8px"},onClick:e[0]||(e[0]=l=>S.value=!0)},{icon:a(()=>[t(W(Y))]),default:a(()=>[e[35]||(e[35]=o("匹配模拟器 ",-1))]),_:1}),t(w,{type:"primary",onClick:ve,loading:b.value},{default:a(()=>[...e[36]||(e[36]=[o("保存",-1)])]),_:1},8,["loading"])]))]),t(z,{class:"form-card",title:"基本信息"},{default:a(()=>[t(q,{ref_key:"formRef",ref:T,model:u,rules:K,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(c,{gutter:24},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"方案编码",name:"planCode"},{default:a(()=>[t(M,{value:u.planCode,"onUpdate:value":e[1]||(e[1]=l=>u.planCode=l),disabled:g.value||$.value,placeholder:"请输入"},null,8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"方案名称",name:"planName"},{default:a(()=>[t(M,{value:u.planName,"onUpdate:value":e[2]||(e[2]=l=>u.planName=l),disabled:g.value,placeholder:"请输入"},null,8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"优先级",name:"priority"},{default:a(()=>[t(D,{value:u.priority,"onUpdate:value":e[3]||(e[3]=l=>u.priority=l),min:0,max:100,disabled:g.value,placeholder:"数值越小越优先",style:{width:"100%"}},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:24},{default:a(()=>[t(f,{span:16},{default:a(()=>[t(p,{label:"备注",name:"description","label-col":{span:3},"wrapper-col":{span:20}},{default:a(()=>[t(Z,{value:u.description,"onUpdate:value":e[4]||(e[4]=l=>u.description=l),disabled:g.value,rows:2,placeholder:"请输入备注"},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(z,{class:"form-card",title:"业务上下文配置"},{default:a(()=>[t(q,{model:u,rules:K,layout:"horizontal","label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(c,{gutter:24},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"业务类型",name:"contextType"},{default:a(()=>[t(C,{value:u.contextType,"onUpdate:value":e[5]||(e[5]=l=>u.contextType=l),disabled:g.value,placeholder:"请选择"},{default:a(()=>[t(i,{value:"IQC"},{default:a(()=>[...e[37]||(e[37]=[o("IQC来料检验",-1)])]),_:1}),t(i,{value:"IPQC"},{default:a(()=>[...e[38]||(e[38]=[o("IPQC过程检验",-1)])]),_:1}),t(i,{value:"FQC"},{default:a(()=>[...e[39]||(e[39]=[o("FQC成品检验",-1)])]),_:1}),t(i,{value:"OQC"},{default:a(()=>[...e[40]||(e[40]=[o("OQC出货检验",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"关联模板",name:"templateCode"},{default:a(()=>[t(C,{value:F.value,"onUpdate:value":e[6]||(e[6]=l=>F.value=l),disabled:g.value,placeholder:"请选择"},{default:a(()=>[(y(!0),O(B,null,Ue(ie.value,l=>(y(),_(i,{key:l.id,value:l.id},{default:a(()=>[o(Q(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"触发条件"},{default:a(()=>[t(C,{value:u.triggerCondition,"onUpdate:value":e[7]||(e[7]=l=>u.triggerCondition=l),disabled:g.value},{default:a(()=>[t(i,{value:"ALWAYS"},{default:a(()=>[...e[41]||(e[41]=[o("总是触发",-1)])]),_:1}),t(i,{value:"ON_NEW_SUPPLIER_FIRST_N_BATCHES"},{default:a(()=>[...e[42]||(e[42]=[o("新供应商前N批",-1)])]),_:1}),t(i,{value:"ON_ECN_FIRST_N_BATCHES"},{default:a(()=>[...e[43]||(e[43]=[o("工程变更前N批",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1}),u.contextType==="IQC"?(y(),_(c,{key:0,gutter:24},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"物料"},{default:a(()=>[t(C,{value:u.materialId,"onUpdate:value":e[8]||(e[8]=l=>u.materialId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有物料"},{default:a(()=>[t(i,{value:"MAT001"},{default:a(()=>[...e[44]||(e[44]=[o("MAT001 - 电子元器件A",-1)])]),_:1}),t(i,{value:"MAT002"},{default:a(()=>[...e[45]||(e[45]=[o("MAT002 - 电子元器件B",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"物料组"},{default:a(()=>[t(C,{value:u.materialGroupId,"onUpdate:value":e[9]||(e[9]=l=>u.materialGroupId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有物料组"},{default:a(()=>[t(i,{value:"MG01"},{default:a(()=>[...e[46]||(e[46]=[o("电子料",-1)])]),_:1}),t(i,{value:"MG02"},{default:a(()=>[...e[47]||(e[47]=[o("结构件",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"供应商"},{default:a(()=>[t(C,{value:u.supplierId,"onUpdate:value":e[10]||(e[10]=l=>u.supplierId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有供应商"},{default:a(()=>[t(i,{value:"SUP001"},{default:a(()=>[...e[48]||(e[48]=[o("SUP001 - 供应商甲",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1})):P("",!0),u.contextType==="IPQC"?(y(),_(c,{key:1,gutter:24},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"物料"},{default:a(()=>[t(C,{value:u.materialId,"onUpdate:value":e[11]||(e[11]=l=>u.materialId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有物料"},{default:a(()=>[t(i,{value:"MAT001"},{default:a(()=>[...e[49]||(e[49]=[o("MAT001 - 电子元器件A",-1)])]),_:1}),t(i,{value:"M007"},{default:a(()=>[...e[50]||(e[50]=[o("M007 - 压铸件壳体",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"工序"},{default:a(()=>[t(C,{value:u.operationNo,"onUpdate:value":e[12]||(e[12]=l=>u.operationNo=l),disabled:g.value,"allow-clear":"",placeholder:"请选择工序"},{default:a(()=>[t(i,{value:"OP010"},{default:a(()=>[...e[51]||(e[51]=[o("OP010 - 压铸",-1)])]),_:1}),t(i,{value:"OP020"},{default:a(()=>[...e[52]||(e[52]=[o("OP020 - 机加",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"检查类型"},{default:a(()=>[t(C,{value:u.ipqcType,"onUpdate:value":e[13]||(e[13]=l=>u.ipqcType=l),disabled:g.value,"allow-clear":"",placeholder:"请选择"},{default:a(()=>[t(i,{value:"FAI"},{default:a(()=>[...e[53]||(e[53]=[o("首检 (FAI)",-1)])]),_:1}),t(i,{value:"PATROL"},{default:a(()=>[...e[54]||(e[54]=[o("巡检 (PATROL)",-1)])]),_:1}),t(i,{value:"LAI"},{default:a(()=>[...e[55]||(e[55]=[o("末检 (LAI)",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1})):P("",!0),u.contextType==="OQC"?(y(),_(c,{key:2,gutter:24},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"物料"},{default:a(()=>[t(C,{value:u.materialId,"onUpdate:value":e[14]||(e[14]=l=>u.materialId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有物料"},{default:a(()=>[t(i,{value:"MAT001"},{default:a(()=>[...e[56]||(e[56]=[o("MAT001 - 电子元器件A",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"客户"},{default:a(()=>[t(C,{value:u.customerId,"onUpdate:value":e[15]||(e[15]=l=>u.customerId=l),disabled:g.value,"allow-clear":"",placeholder:"适用所有客户"},{default:a(()=>[t(i,{value:"CUST001"},{default:a(()=>[...e[57]||(e[57]=[o("CUST001 - 客户A",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1})):P("",!0)]),_:1},8,["model"])]),_:1}),t(z,{class:"tab-card"},{default:a(()=>[t(Pe,{activeKey:V.value,"onUpdate:activeKey":e[16]||(e[16]=l=>V.value=l)},{default:a(()=>[t(ee,{key:"materialSpec",tab:"物料检验规格"},{default:a(()=>[g.value?P("",!0):(y(),O("div",Je,[t(w,{type:"primary",size:"small",onClick:fe},{icon:a(()=>[t(W(Ee))]),default:a(()=>[e[58]||(e[58]=o("新增规格 ",-1))]),_:1})])),t(h,{columns:pe,"data-source":x.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:l,record:E})=>[l.key==="dataType"?(y(),_(U,{key:0,color:E.dataType==="QUANTITATIVE"?"blue":"purple"},{default:a(()=>[o(Q(E.dataType==="QUANTITATIVE"?"计量型":"计数型"),1)]),_:2},1032,["color"])):P("",!0),l.key==="action"?(y(),O(B,{key:1},[g.value?P("",!0):(y(),_(_e,{key:0},{default:a(()=>[t(w,{type:"link",size:"small",onClick:xe=>Ie(E)},{default:a(()=>[...e[59]||(e[59]=[o("编辑",-1)])]),_:1},8,["onClick"]),t(w,{type:"link",danger:"",size:"small",onClick:xe=>ye(E)},{default:a(()=>[...e[60]||(e[60]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024))],64)):P("",!0)]),_:1},8,["data-source"])]),_:1}),t(ee,{key:"details",tab:"方案明细(预览)"},{default:a(()=>[t(te,{message:"此列表由关联模板自动加载，方案执行时将结合物料规格生成最终任务。",type:"info","show-icon":"",style:{"margin-bottom":"12px"}}),t(h,{columns:se,"data-source":J.value,"row-key":"id",size:"small",pagination:!1},{bodyCell:a(({column:l,record:E})=>[l.key==="action"?(y(),O("span",Xe,"继承模板")):P("",!0)]),_:1},8,["data-source"])]),_:1})]),_:1},8,["activeKey"])]),_:1}),t(le,{open:L.value,"onUpdate:open":e[26]||(e[26]=l=>L.value=l),title:G.value?"编辑物料规格":"新增物料规格",onOk:Te},{default:a(()=>[t(q,{ref_key:"specFormRef",ref:X,model:m,layout:"vertical"},{default:a(()=>[t(c,{gutter:16},{default:a(()=>[t(f,{span:12},{default:a(()=>[t(p,{label:"物料编码",name:"materialCode",rules:[{required:!0,message:"请输入物料编码"}]},{default:a(()=>[t(M,{value:m.materialCode,"onUpdate:value":e[17]||(e[17]=l=>m.materialCode=l),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1}),t(f,{span:12},{default:a(()=>[t(p,{label:"检验项目",name:"inspItemName",rules:[{required:!0,message:"请输入检验项目"}]},{default:a(()=>[t(M,{value:m.inspItemName,"onUpdate:value":e[18]||(e[18]=l=>m.inspItemName=l),placeholder:"请输入"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:16},{default:a(()=>[t(f,{span:12},{default:a(()=>[t(p,{label:"数据类型",name:"dataType"},{default:a(()=>[t(be,{value:m.dataType,"onUpdate:value":e[19]||(e[19]=l=>m.dataType=l)},{default:a(()=>[t(ae,{value:"QUANTITATIVE"},{default:a(()=>[...e[61]||(e[61]=[o("计量型",-1)])]),_:1}),t(ae,{value:"QUALITATIVE"},{default:a(()=>[...e[62]||(e[62]=[o("计数型",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),m.dataType==="QUANTITATIVE"?(y(),O(B,{key:0},[t(c,{gutter:16},{default:a(()=>[t(f,{span:8},{default:a(()=>[t(p,{label:"目标值",name:"targetValue"},{default:a(()=>[t(D,{value:m.targetValue,"onUpdate:value":e[20]||(e[20]=l=>m.targetValue=l),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"上限(USL)",name:"upperLimit"},{default:a(()=>[t(D,{value:m.upperLimit,"onUpdate:value":e[21]||(e[21]=l=>m.upperLimit=l),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(f,{span:8},{default:a(()=>[t(p,{label:"下限(LSL)",name:"lowerLimit"},{default:a(()=>[t(D,{value:m.lowerLimit,"onUpdate:value":e[22]||(e[22]=l=>m.lowerLimit=l),style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:16},{default:a(()=>[t(f,{span:12},{default:a(()=>[t(p,{label:"单位",name:"uom"},{default:a(()=>[t(M,{value:m.uom,"onUpdate:value":e[23]||(e[23]=l=>m.uom=l),placeholder:"mm, kg, etc."},null,8,["value"])]),_:1})]),_:1})]),_:1})],64)):(y(),O(B,{key:1},[t(c,{gutter:16},{default:a(()=>[t(f,{span:24},{default:a(()=>[t(p,{label:"标准描述",name:"standardDesc",rules:[{required:!0,message:"请输入标准描述"}]},{default:a(()=>[t(Z,{value:m.standardDesc,"onUpdate:value":e[24]||(e[24]=l=>m.standardDesc=l),rows:3,placeholder:"例如：表面无划痕，无色差"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(c,{gutter:16},{default:a(()=>[t(f,{span:12},{default:a(()=>[t(p,{label:"期望值",name:"expectedValue"},{default:a(()=>[t(M,{value:m.expectedValue,"onUpdate:value":e[25]||(e[25]=l=>m.expectedValue=l),placeholder:"例如：OK/PASS"},null,8,["value"])]),_:1})]),_:1})]),_:1})],64))]),_:1},8,["model"])]),_:1},8,["open","title"]),t(le,{visible:S.value,"onUpdate:visible":e[33]||(e[33]=l=>S.value=l),title:"方案匹配模拟器",width:"700px",onOk:Ce},{default:a(()=>[t(te,{type:"info",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[63]||(e[63]=[o(" 输入业务上下文参数，测试优先级匹配引擎将匹配到哪个检验方案。 ",-1)])]),_:1}),t(q,{"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[t(p,{label:"业务类型"},{default:a(()=>[t(C,{value:n.contextType,"onUpdate:value":e[27]||(e[27]=l=>n.contextType=l),placeholder:"请选择"},{default:a(()=>[t(i,{value:"IQC"},{default:a(()=>[...e[64]||(e[64]=[o("IQC来料检验",-1)])]),_:1}),t(i,{value:"IPQC"},{default:a(()=>[...e[65]||(e[65]=[o("IPQC过程检验",-1)])]),_:1}),t(i,{value:"FQC"},{default:a(()=>[...e[66]||(e[66]=[o("FQC成品检验",-1)])]),_:1}),t(i,{value:"OQC"},{default:a(()=>[...e[67]||(e[67]=[o("OQC出货检验",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"物料"},{default:a(()=>[t(C,{value:n.materialId,"onUpdate:value":e[28]||(e[28]=l=>n.materialId=l),placeholder:"请选择","allow-clear":""},{default:a(()=>[t(i,{value:"MAT001"},{default:a(()=>[...e[68]||(e[68]=[o("MAT001 - 电子元器件A",-1)])]),_:1}),t(i,{value:"MAT002"},{default:a(()=>[...e[69]||(e[69]=[o("MAT002 - 电子元器件B",-1)])]),_:1}),t(i,{value:"MAT003"},{default:a(()=>[...e[70]||(e[70]=[o("MAT003 - 塑料件C",-1)])]),_:1}),t(i,{value:"M007"},{default:a(()=>[...e[71]||(e[71]=[o("M007 - 压铸件壳体",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),n.contextType==="IQC"?(y(),_(p,{key:0,label:"供应商"},{default:a(()=>[t(C,{value:n.supplierId,"onUpdate:value":e[29]||(e[29]=l=>n.supplierId=l),placeholder:"请选择","allow-clear":""},{default:a(()=>[t(i,{value:"SUP001"},{default:a(()=>[...e[72]||(e[72]=[o("SUP001 - 供应商甲",-1)])]),_:1}),t(i,{value:"SUP002"},{default:a(()=>[...e[73]||(e[73]=[o("SUP002 - 供应商乙",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):P("",!0),n.contextType==="IPQC"?(y(),_(p,{key:1,label:"工序"},{default:a(()=>[t(C,{value:n.operationNo,"onUpdate:value":e[30]||(e[30]=l=>n.operationNo=l),placeholder:"请选择","allow-clear":""},{default:a(()=>[t(i,{value:"OP010"},{default:a(()=>[...e[74]||(e[74]=[o("OP010 - 压铸",-1)])]),_:1}),t(i,{value:"OP020"},{default:a(()=>[...e[75]||(e[75]=[o("OP020 - 机加",-1)])]),_:1}),t(i,{value:"OP030"},{default:a(()=>[...e[76]||(e[76]=[o("OP030 - 测试",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):P("",!0),n.contextType==="IPQC"?(y(),_(p,{key:2,label:"检查类型"},{default:a(()=>[t(C,{value:n.ipqcType,"onUpdate:value":e[31]||(e[31]=l=>n.ipqcType=l),placeholder:"请选择","allow-clear":""},{default:a(()=>[t(i,{value:"FAI"},{default:a(()=>[...e[77]||(e[77]=[o("首检 (FAI)",-1)])]),_:1}),t(i,{value:"PATROL"},{default:a(()=>[...e[78]||(e[78]=[o("巡检 (PATROL)",-1)])]),_:1}),t(i,{value:"LAI"},{default:a(()=>[...e[79]||(e[79]=[o("末检 (LAI)",-1)])]),_:1})]),_:1},8,["value"])]),_:1})):P("",!0),t(p,{label:"特殊触发条件"},{default:a(()=>[t(ce,{value:n.activeTriggers,"onUpdate:value":e[32]||(e[32]=l=>n.activeTriggers=l)},{default:a(()=>[t(oe,{value:"ON_NEW_SUPPLIER_FIRST_N_BATCHES"},{default:a(()=>[...e[80]||(e[80]=[o("新供应商前3批",-1)])]),_:1}),t(oe,{value:"ON_ECN_FIRST_N_BATCHES"},{default:a(()=>[...e[81]||(e[81]=[o("工程变更前3批",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(Ae,null,{default:a(()=>[...e[82]||(e[82]=[o("匹配结果",-1)])]),_:1}),N.value?(y(),_(Ne,{key:0,status:N.value.plan?"success":"warning",title:N.value.plan?`匹配到方案: ${N.value.plan.planName}`:"未找到匹配的方案"},Re({_:2},[N.value.plan?{name:"subTitle",fn:a(()=>[k("div",null,[N.value.isExactMatch?(y(),_(U,{key:0,color:"green"},{default:a(()=>[...e[83]||(e[83]=[o("精确匹配",-1)])]),_:1})):(y(),_(U,{key:1,color:"orange"},{default:a(()=>[...e[84]||(e[84]=[o("模糊匹配",-1)])]),_:1})),k("span",Ze,"匹配类型: "+Q(N.value.matchType),1)]),k("div",he," 候选方案数量: "+Q(N.value.candidates.length),1)]),key:"0"}:void 0]),1032,["status","title"])):(y(),_(Oe,{key:1,description:"请填写测试条件后点击确定进行匹配"}))]),_:1},8,["visible"])])}}}),lt=Fe(et,[["__scopeId","data-v-7fec2150"]]);export{lt as default};
