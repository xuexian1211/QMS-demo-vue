import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as g,a as $,k as K,m as ve,c as Q,o as U,e as S,x as t,q as a,h as n,y as k,P as ce,s,S as _e,p as x,f as M,t as f,G as be,H as ye,I as ge,F as Ue,z as Te,C as q}from"./index-D0CfuKge.js";const we={class:"unit-management"},Ce={class:"page-header"},Ne={class:"search-form"},ke={class:"table-container"},xe={__name:"UnitManagement",setup(Ie){const D=g(!1),T=g(!1),z=g(!1),I=g(!1),V=g(),d=$({unitCode:"",unitName:"",unitType:void 0,status:void 0}),u=$({id:"",unitCode:"",unitName:"",unitType:void 0,baseUnitId:void 0,conversionFactor:1,isBaseUnit:"0",sortOrder:0,description:"",status:"1"}),Z=[{title:"单位编码",dataIndex:"unitCode",key:"unitCode",width:100,fixed:"left"},{title:"单位名称",dataIndex:"unitName",key:"unitName",width:120,fixed:"left"},{title:"单位类型",dataIndex:"unitType",key:"unitType",width:100},{title:"换算基准单位",dataIndex:"baseUnitName",key:"baseUnitName",width:120},{title:"换算系数",dataIndex:"conversionFactor",key:"conversionFactor",width:100,sorter:!0},{title:"基准单位",dataIndex:"isBaseUnit",key:"isBaseUnit",width:100},{title:"排序",dataIndex:"sortOrder",key:"sortOrder",width:80,sorter:!0},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:200,fixed:"right"}],v=g([{id:"1",unitCode:"KG",unitName:"千克",unitType:"weight",baseUnitId:null,baseUnitName:"无",conversionFactor:1,isBaseUnit:"1",sortOrder:1,description:"国际标准重量单位",status:"1",createTime:"2024-01-15 10:30:00",updateTime:"2024-01-15 10:30:00"},{id:"2",unitCode:"TON",unitName:"吨",unitType:"weight",baseUnitId:"1",baseUnitName:"千克",conversionFactor:1e3,isBaseUnit:"0",sortOrder:2,description:"重量单位，1吨=1000千克",status:"1",createTime:"2024-01-15 10:35:00",updateTime:"2024-01-15 10:35:00"},{id:"3",unitCode:"G",unitName:"克",unitType:"weight",baseUnitId:"1",baseUnitName:"千克",conversionFactor:.001,isBaseUnit:"0",sortOrder:3,description:"重量单位，1千克=1000克",status:"1",createTime:"2024-01-15 10:40:00",updateTime:"2024-01-15 10:40:00"},{id:"4",unitCode:"M",unitName:"米",unitType:"length",baseUnitId:null,baseUnitName:"无",conversionFactor:1,isBaseUnit:"1",sortOrder:1,description:"国际标准长度单位",status:"1",createTime:"2024-01-15 10:45:00",updateTime:"2024-01-15 10:45:00"},{id:"5",unitCode:"CM",unitName:"厘米",unitType:"length",baseUnitId:"4",baseUnitName:"米",conversionFactor:.01,isBaseUnit:"0",sortOrder:2,description:"长度单位，1米=100厘米",status:"1",createTime:"2024-01-15 10:50:00",updateTime:"2024-01-15 10:50:00"},{id:"6",unitCode:"PCS",unitName:"个",unitType:"count",baseUnitId:null,baseUnitName:"无",conversionFactor:1,isBaseUnit:"1",sortOrder:1,description:"数量单位",status:"1",createTime:"2024-01-15 10:55:00",updateTime:"2024-01-15 10:55:00"}]),C=$({current:1,pageSize:10,total:6,showSizeChanger:!0,showQuickJumper:!0,showTotal:(i,e)=>`第 ${e[0]}-${e[1]} 条，共 ${i} 条`}),m=g({}),W=K(()=>v.value.filter(i=>i.isBaseUnit==="1")),X={unitCode:[{required:!0,message:"请输入单位编码",trigger:"blur"},{pattern:/^[A-Z_]+$/,message:"单位编码只能包含大写字母和下划线",trigger:"blur"}],unitName:[{required:!0,message:"请输入单位名称",trigger:"blur"}],unitType:[{required:!0,message:"请选择单位类型",trigger:"change"}],conversionFactor:[{required:!0,message:"请输入换算系数",trigger:"blur"}]},E=i=>({weight:"重量",length:"长度",volume:"体积",count:"数量",area:"面积",time:"时间"})[i]||"未知",L=i=>({weight:"purple",length:"blue",volume:"cyan",count:"green",area:"orange",time:"red"})[i]||"default",Y=i=>{if(!i)return"无";const e=v.value.find(r=>r.id===i);return e?e.unitName:"未知"},h=K(()=>I.value?"编辑单位":"新增单位"),j=()=>{C.current=1,N()},ee=()=>{Object.assign(d,{unitCode:"",unitName:"",unitType:void 0,status:void 0}),j()},te=(i,e,r)=>{C.current=i.current,C.pageSize=i.pageSize,N()},ae=()=>{I.value=!1,T.value=!0,G()},ne=i=>{I.value=!0,T.value=!0,Object.assign(u,{...i})},le=i=>{m.value=i,z.value=!0},ie=i=>{const e=v.value.findIndex(r=>r.id===i);e>-1&&(v.value.splice(e,1),q.success("删除成功"),N())},ue=async()=>{var i,e;try{if(await V.value.validate(),I.value){const r=v.value.findIndex(_=>_.id===u.id);if(r>-1){const _=u.baseUnitId?(i=v.value.find(p=>p.id===u.baseUnitId))==null?void 0:i.unitName:"无";v.value[r]={...u,baseUnitName:_,updateTime:new Date().toLocaleString()},q.success("更新成功")}}else{const r=(Math.max(...v.value.map(o=>parseInt(o.id)))+1).toString(),_=u.baseUnitId?(e=v.value.find(o=>o.id===u.baseUnitId))==null?void 0:e.unitName:"无",p={...u,id:r,baseUnitName:_,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};v.value.push(p),q.success("新增成功")}T.value=!1,N()}catch(r){console.error("表单验证失败:",r)}},oe=()=>{T.value=!1,G()},G=()=>{var i;Object.assign(u,{id:"",unitCode:"",unitName:"",unitType:void 0,baseUnitId:void 0,conversionFactor:1,isBaseUnit:"0",sortOrder:0,description:"",status:"1"}),(i=V.value)==null||i.resetFields()},N=()=>{D.value=!0,setTimeout(()=>{let i=[...v.value];d.unitCode&&(i=i.filter(e=>e.unitCode.includes(d.unitCode))),d.unitName&&(i=i.filter(e=>e.unitName.includes(d.unitName))),d.unitType&&(i=i.filter(e=>e.unitType===d.unitType)),d.status!==void 0&&(i=i.filter(e=>e.status===d.status)),C.total=i.length,D.value=!1},500)};return ve(()=>{N()}),(i,e)=>{const r=s("a-button"),_=s("a-input"),p=s("a-form-item"),o=s("a-select-option"),B=s("a-select"),P=s("a-form"),w=s("a-tag"),se=s("a-popconfirm"),de=s("a-space"),re=s("a-table"),y=s("a-col"),O=s("a-row"),A=s("a-input-number"),F=s("a-radio"),R=s("a-radio-group"),pe=s("a-textarea"),H=s("a-modal"),c=s("a-descriptions-item"),me=s("a-descriptions");return U(),Q("div",we,[S("div",Ce,[e[16]||(e[16]=S("h2",null,"计量单位管理",-1)),t(r,{type:"primary",onClick:ae},{icon:a(()=>[t(k(ce))]),default:a(()=>[e[15]||(e[15]=n(" 新增单位 ",-1))]),_:1})]),S("div",Ne,[t(P,{layout:"inline",model:d,onFinish:j},{default:a(()=>[t(p,{label:"单位编码"},{default:a(()=>[t(_,{value:d.unitCode,"onUpdate:value":e[0]||(e[0]=l=>d.unitCode=l),placeholder:"请输入单位编码","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(p,{label:"单位名称"},{default:a(()=>[t(_,{value:d.unitName,"onUpdate:value":e[1]||(e[1]=l=>d.unitName=l),placeholder:"请输入单位名称","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(p,{label:"单位类型"},{default:a(()=>[t(B,{value:d.unitType,"onUpdate:value":e[2]||(e[2]=l=>d.unitType=l),placeholder:"请选择单位类型","allow-clear":"",style:{width:"150px"}},{default:a(()=>[t(o,{value:"weight"},{default:a(()=>[...e[17]||(e[17]=[n("重量",-1)])]),_:1}),t(o,{value:"length"},{default:a(()=>[...e[18]||(e[18]=[n("长度",-1)])]),_:1}),t(o,{value:"volume"},{default:a(()=>[...e[19]||(e[19]=[n("体积",-1)])]),_:1}),t(o,{value:"count"},{default:a(()=>[...e[20]||(e[20]=[n("数量",-1)])]),_:1}),t(o,{value:"area"},{default:a(()=>[...e[21]||(e[21]=[n("面积",-1)])]),_:1}),t(o,{value:"time"},{default:a(()=>[...e[22]||(e[22]=[n("时间",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,{label:"状态"},{default:a(()=>[t(B,{value:d.status,"onUpdate:value":e[3]||(e[3]=l=>d.status=l),placeholder:"请选择状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[t(o,{value:"1"},{default:a(()=>[...e[23]||(e[23]=[n("启用",-1)])]),_:1}),t(o,{value:"0"},{default:a(()=>[...e[24]||(e[24]=[n("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,null,{default:a(()=>[t(r,{type:"primary","html-type":"submit"},{icon:a(()=>[t(k(_e))]),default:a(()=>[e[25]||(e[25]=n(" 搜索 ",-1))]),_:1}),t(r,{style:{"margin-left":"8px"},onClick:ee},{default:a(()=>[...e[26]||(e[26]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),S("div",ke,[t(re,{columns:Z,"data-source":v.value,loading:D.value,pagination:C,"row-key":"id",onChange:te},{bodyCell:a(({column:l,record:b})=>[l.key==="unitType"?(U(),x(w,{key:0,color:L(b.unitType)},{default:a(()=>[n(f(E(b.unitType)),1)]),_:2},1032,["color"])):M("",!0),l.key==="status"?(U(),x(w,{key:1,color:b.status==="1"?"green":"red"},{default:a(()=>[n(f(b.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):M("",!0),l.key==="isBaseUnit"?(U(),x(w,{key:2,color:b.isBaseUnit==="1"?"blue":"default"},{default:a(()=>[n(f(b.isBaseUnit==="1"?"是":"否"),1)]),_:2},1032,["color"])):M("",!0),l.key==="action"?(U(),x(de,{key:3},{default:a(()=>[t(r,{type:"link",size:"small",onClick:J=>ne(b)},{icon:a(()=>[t(k(be))]),default:a(()=>[e[27]||(e[27]=n(" 编辑 ",-1))]),_:1},8,["onClick"]),t(r,{type:"link",size:"small",onClick:J=>le(b)},{icon:a(()=>[t(k(ye))]),default:a(()=>[e[28]||(e[28]=n(" 查看 ",-1))]),_:1},8,["onClick"]),t(se,{title:"确定要删除这个单位吗？",onConfirm:J=>ie(b.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[t(r,{type:"link",size:"small",danger:""},{icon:a(()=>[t(k(ge))]),default:a(()=>[e[29]||(e[29]=n(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):M("",!0)]),_:1},8,["data-source","loading","pagination"])]),t(H,{visible:T.value,"onUpdate:visible":e[13]||(e[13]=l=>T.value=l),title:h.value,width:"600px",onOk:ue,onCancel:oe},{default:a(()=>[t(P,{ref_key:"formRef",ref:V,model:u,rules:X,layout:"vertical"},{default:a(()=>[t(O,{gutter:16},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(p,{label:"单位编码",name:"unitCode"},{default:a(()=>[t(_,{value:u.unitCode,"onUpdate:value":e[4]||(e[4]=l=>u.unitCode=l),placeholder:"请输入单位编码"},null,8,["value"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(p,{label:"单位名称",name:"unitName"},{default:a(()=>[t(_,{value:u.unitName,"onUpdate:value":e[5]||(e[5]=l=>u.unitName=l),placeholder:"请输入单位名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:16},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(p,{label:"单位类型",name:"unitType"},{default:a(()=>[t(B,{value:u.unitType,"onUpdate:value":e[6]||(e[6]=l=>u.unitType=l),placeholder:"请选择单位类型"},{default:a(()=>[t(o,{value:"weight"},{default:a(()=>[...e[30]||(e[30]=[n("重量",-1)])]),_:1}),t(o,{value:"length"},{default:a(()=>[...e[31]||(e[31]=[n("长度",-1)])]),_:1}),t(o,{value:"volume"},{default:a(()=>[...e[32]||(e[32]=[n("体积",-1)])]),_:1}),t(o,{value:"count"},{default:a(()=>[...e[33]||(e[33]=[n("数量",-1)])]),_:1}),t(o,{value:"area"},{default:a(()=>[...e[34]||(e[34]=[n("面积",-1)])]),_:1}),t(o,{value:"time"},{default:a(()=>[...e[35]||(e[35]=[n("时间",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(p,{label:"换算基准单位",name:"baseUnitId"},{default:a(()=>[t(B,{value:u.baseUnitId,"onUpdate:value":e[7]||(e[7]=l=>u.baseUnitId=l),placeholder:"请选择基准单位","allow-clear":""},{default:a(()=>[(U(!0),Q(Ue,null,Te(W.value,l=>(U(),x(o,{key:l.id,value:l.id},{default:a(()=>[n(f(l.unitName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:16},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(p,{label:"换算系数",name:"conversionFactor"},{default:a(()=>[t(A,{value:u.conversionFactor,"onUpdate:value":e[8]||(e[8]=l=>u.conversionFactor=l),placeholder:"请输入换算系数",min:0,precision:6,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(p,{label:"是否基准单位",name:"isBaseUnit"},{default:a(()=>[t(R,{value:u.isBaseUnit,"onUpdate:value":e[9]||(e[9]=l=>u.isBaseUnit=l)},{default:a(()=>[t(F,{value:"1"},{default:a(()=>[...e[36]||(e[36]=[n("是",-1)])]),_:1}),t(F,{value:"0"},{default:a(()=>[...e[37]||(e[37]=[n("否",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(O,{gutter:16},{default:a(()=>[t(y,{span:12},{default:a(()=>[t(p,{label:"排序",name:"sortOrder"},{default:a(()=>[t(A,{value:u.sortOrder,"onUpdate:value":e[10]||(e[10]=l=>u.sortOrder=l),placeholder:"请输入排序号",min:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(y,{span:12},{default:a(()=>[t(p,{label:"状态",name:"status"},{default:a(()=>[t(R,{value:u.status,"onUpdate:value":e[11]||(e[11]=l=>u.status=l)},{default:a(()=>[t(F,{value:"1"},{default:a(()=>[...e[38]||(e[38]=[n("启用",-1)])]),_:1}),t(F,{value:"0"},{default:a(()=>[...e[39]||(e[39]=[n("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(p,{label:"描述",name:"description"},{default:a(()=>[t(pe,{value:u.description,"onUpdate:value":e[12]||(e[12]=l=>u.description=l),placeholder:"请输入单位描述",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(H,{visible:z.value,"onUpdate:visible":e[14]||(e[14]=l=>z.value=l),title:"单位详情",width:"600px",footer:null},{default:a(()=>[t(me,{column:2,bordered:""},{default:a(()=>[t(c,{label:"单位编码"},{default:a(()=>[n(f(m.value.unitCode),1)]),_:1}),t(c,{label:"单位名称"},{default:a(()=>[n(f(m.value.unitName),1)]),_:1}),t(c,{label:"单位类型"},{default:a(()=>[t(w,{color:L(m.value.unitType)},{default:a(()=>[n(f(E(m.value.unitType)),1)]),_:1},8,["color"])]),_:1}),t(c,{label:"换算基准单位"},{default:a(()=>[n(f(Y(m.value.baseUnitId)),1)]),_:1}),t(c,{label:"换算系数"},{default:a(()=>[n(f(m.value.conversionFactor),1)]),_:1}),t(c,{label:"是否基准单位"},{default:a(()=>[t(w,{color:m.value.isBaseUnit==="1"?"blue":"default"},{default:a(()=>[n(f(m.value.isBaseUnit==="1"?"是":"否"),1)]),_:1},8,["color"])]),_:1}),t(c,{label:"排序"},{default:a(()=>[n(f(m.value.sortOrder),1)]),_:1}),t(c,{label:"状态"},{default:a(()=>[t(w,{color:m.value.status==="1"?"green":"red"},{default:a(()=>[n(f(m.value.status==="1"?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),t(c,{label:"创建时间"},{default:a(()=>[n(f(m.value.createTime),1)]),_:1}),t(c,{label:"更新时间"},{default:a(()=>[n(f(m.value.updateTime),1)]),_:1}),t(c,{label:"描述",span:2},{default:a(()=>[n(f(m.value.description||"无"),1)]),_:1})]),_:1})]),_:1},8,["visible"])])}}},Fe=fe(xe,[["__scopeId","data-v-0e5531b4"]]);export{Fe as default};
