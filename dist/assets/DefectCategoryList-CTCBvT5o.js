import{d as M,r as g,a as b,l as O,m as S,c as T,e as $,x as a,q as n,s,o as E,h as i,u as V,J as w,M as q,C as J}from"./index-D0CfuKge.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"page-container"},Q={class:"toolbar"},F=M({__name:"DefectCategoryList",setup(G){const m=V(),v=g([]),o=b({categoryCode:"",categoryName:"",parentId:null}),x=[{title:"分类代码",dataIndex:"categoryCode",key:"categoryCode"},{title:"分类名称",dataIndex:"categoryName",key:"categoryName"},{title:"父级ID",dataIndex:"parentId",key:"parentId"},{title:"描述",dataIndex:"description",key:"description"},{title:"操作",key:"actions",customRender:({record:l})=>{const e=s("a-space"),t=s("a-button");return w(e,null,{default:()=>[w(t,{size:"small",type:"link",onClick:()=>m.push(`/inspection-model/defect-categories/edit/${l.id}`)},{default:()=>"编辑"}),w(t,{size:"small",type:"link",onClick:()=>m.push(`/inspection-model/defect-categories/view/${l.id}`)},{default:()=>"查看"})]})}}],u=g([]),_=g([]),N=b({selectedRowKeys:u,onChange:(l,e)=>{u.value=l,_.value=e}}),C=b({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0}),k=g(!1);let f=null;O(k,l=>{l?f=setInterval(y,15e3):f&&(clearInterval(f),f=null)});const y=()=>{let e=[{id:1,categoryCode:"DCAT-APP",categoryName:"外观缺陷",parentId:null,description:"表面相关缺陷"},{id:2,categoryCode:"DCAT-DIM",categoryName:"尺寸缺陷",parentId:null,description:"尺寸公差相关缺陷"}];o.categoryCode&&(e=e.filter(t=>t.categoryCode.includes(o.categoryCode))),o.categoryName&&(e=e.filter(t=>t.categoryName.includes(o.categoryName))),o.parentId!=null&&(e=e.filter(t=>t.parentId===o.parentId)),C.total=e.length,v.value=e},h=()=>{C.current=1,y()},D=()=>{Object.assign(o,{categoryCode:"",categoryName:"",parentId:null}),h()},R=()=>m.push("/inspection-model/defect-categories/create"),U=()=>{_.value[0]&&m.push(`/inspection-model/defect-categories/edit/${_.value[0].id}`)},z=()=>{u.value.length!==0&&q.confirm({title:"确认删除",content:`确定删除选中的${u.value.length}条记录？`,okType:"danger",onOk(){J.success("删除成功")}})},L=()=>{const l=["分类代码","分类名称","父级ID","描述"],e=v.value.map(r=>[r.categoryCode,r.categoryName,r.parentId??"",r.description]),t=[l,...e].map(r=>r.join(",")).join(`
`),I=new Blob([t],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(I),c=document.createElement("a");c.href=p,c.download="缺陷分类.csv",c.click(),URL.revokeObjectURL(p)};return S(y),(l,e)=>{const t=s("a-button"),I=s("a-switch"),p=s("a-input"),c=s("a-form-item"),r=s("a-input-number"),j=s("a-form"),A=s("a-card"),B=s("a-table");return E(),T("div",K,[$("div",Q,[a(t,{type:"primary",onClick:R},{default:n(()=>[...e[4]||(e[4]=[i("新增",-1)])]),_:1}),a(t,{disabled:u.value.length!==1,onClick:U},{default:n(()=>[...e[5]||(e[5]=[i("编辑",-1)])]),_:1},8,["disabled"]),a(t,{disabled:u.value.length===0,danger:"",onClick:z},{default:n(()=>[...e[6]||(e[6]=[i("删除",-1)])]),_:1},8,["disabled"]),a(t,{onClick:L},{default:n(()=>[...e[7]||(e[7]=[i("导出",-1)])]),_:1}),a(I,{checked:k.value,"onUpdate:checked":e[0]||(e[0]=d=>k.value=d),"checked-children":"自动刷新","un-checked-children":"自动刷新"},null,8,["checked"]),a(t,{onClick:y},{default:n(()=>[...e[8]||(e[8]=[i("刷新",-1)])]),_:1})]),a(A,{title:"搜索条件",size:"small",class:"search-card"},{default:n(()=>[a(j,{layout:"inline",model:o},{default:n(()=>[a(c,{label:"分类代码"},{default:n(()=>[a(p,{value:o.categoryCode,"onUpdate:value":e[1]||(e[1]=d=>o.categoryCode=d),style:{width:"180px"}},null,8,["value"])]),_:1}),a(c,{label:"分类名称"},{default:n(()=>[a(p,{value:o.categoryName,"onUpdate:value":e[2]||(e[2]=d=>o.categoryName=d),style:{width:"200px"}},null,8,["value"])]),_:1}),a(c,{label:"父级ID"},{default:n(()=>[a(r,{value:o.parentId,"onUpdate:value":e[3]||(e[3]=d=>o.parentId=d),style:{width:"160px"}},null,8,["value"])]),_:1}),a(c,null,{default:n(()=>[a(t,{type:"primary",onClick:h},{default:n(()=>[...e[9]||(e[9]=[i("查询",-1)])]),_:1}),a(t,{style:{"margin-left":"8px"},onClick:D},{default:n(()=>[...e[10]||(e[10]=[i("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(B,{columns:x,"data-source":v.value,pagination:C,"row-selection":N,"row-key":"id",size:"small",class:"compact-table"},null,8,["data-source","pagination","row-selection"])])}}}),X=P(F,[["__scopeId","data-v-24d29711"]]);export{X as default};
