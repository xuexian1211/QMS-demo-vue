function u(e,n,t="export"){if(!e||e.length===0){console.warn("没有数据可导出");return}const o=n.map(i=>i.title),r=e.map(i=>n.map(m=>{const l=i[m.dataIndex];if(l==null)return"";const s=String(l);return s.includes(",")||s.includes('"')||s.includes(`
`)?`"${s.replace(/"/g,'""')}"`:s})),x="\uFEFF"+[o.join(","),...r.map(i=>i.join(","))].join(`
`),b=new Blob([x],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(b),c=document.createElement("a");c.setAttribute("href",a),c.setAttribute("download",`${t}.csv`),c.style.visibility="hidden",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(a)}function f(e,n,t="export"){u(e,n,t)}function d(e,n,t="export"){const o=Object.entries(n).map(([r,p])=>({title:p,dataIndex:r}));u(e,o,t)}function h(){return{exportTableToCSV:(t,o,r)=>{u(t,o,r)},exportWithMapping:(t,o,r)=>{d(t,o,r)},exportToCSV:u,exportToExcel:f,exportData:d}}export{h as u};
