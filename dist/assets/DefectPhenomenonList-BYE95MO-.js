import{d as B,r as m,a as I,l as E,m as O,c as S,e as $,x as t,q as n,s as i,o as V,h as d,u as q,J as h,M as F,C as J}from"./index-D0CfuKge.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"page-container"},G={class:"toolbar"},H=B({__name:"DefectPhenomenonList",setup(W){const f=q(),R=m([{id:1,categoryName:"外观缺陷"},{id:2,categoryName:"尺寸缺陷"}]),k=m([]),a=I({code:"",name:"",severity:""}),U=[{title:"不良类型",dataIndex:"categoryId",key:"categoryId",customRender:({text:l})=>{var e;return((e=R.value.find(o=>o.id===l))==null?void 0:e.categoryName)||l}},{title:"现象代码",dataIndex:"code",key:"code"},{title:"现象名称",dataIndex:"name",key:"name"},{title:"严重等级",dataIndex:"severity",key:"severity"},{title:"适用工序类型",dataIndex:"processType",key:"processType"},{title:"描述",dataIndex:"Description",key:"Description"},{title:"操作",key:"actions",customRender:({record:l})=>{const e=i("a-space"),o=i("a-button");return h(e,null,{default:()=>[h(o,{size:"small",type:"link",onClick:()=>f.push(`/inspection-model/defect-phenomena/edit/${l.id}`)},{default:()=>"编辑"}),h(o,{size:"small",type:"link",onClick:()=>f.push(`/inspection-model/defect-phenomena/view/${l.id}`)},{default:()=>"查看"})]})}}],u=m([]),g=m([]),M=I({selectedRowKeys:u,onChange:(l,e)=>{u.value=l,g.value=e}}),b=I({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0}),w=m(!1);let v=null;E(w,l=>{l?v=setInterval(y,15e3):v&&(clearInterval(v),v=null)});const y=()=>{let e=[{id:401,categoryId:1,code:"DEF-APP-01",name:"划伤",severity:"MI",processType:"机加工",Description:"表面细微划伤"},{id:402,categoryId:1,code:"DEF-APP-02",name:"碰伤",severity:"MA",processType:"装配",Description:"表面压痕"}];a.code&&(e=e.filter(o=>o.code.includes(a.code))),a.name&&(e=e.filter(o=>o.name.includes(a.name))),a.severity&&(e=e.filter(o=>o.severity===a.severity)),b.total=e.length,k.value=e},D=()=>{b.current=1,y()},N=()=>{Object.assign(a,{code:"",name:"",severity:""}),D()},T=()=>f.push("/inspection-model/defect-phenomena/create"),z=()=>{g.value[0]&&f.push(`/inspection-model/defect-phenomena/edit/${g.value[0].id}`)},A=()=>{u.value.length!==0&&F.confirm({title:"确认删除",content:`确定删除选中的${u.value.length}条记录？`,okType:"danger",onOk(){J.success("删除成功")}})},L=()=>{const l=["不良类型","现象代码","现象名称","严重等级","适用工序类型","描述"],e=k.value.map(s=>{var _;return[((_=R.value.find(x=>x.id===s.categoryId))==null?void 0:_.categoryName)||s.categoryId,s.code,s.name,s.severity,s.processType,s.Description]}),o=[l,...e].map(s=>s.join(",")).join(`
`),C=new Blob([o],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(C),c=document.createElement("a");c.href=p,c.download="不良现象.csv",c.click(),URL.revokeObjectURL(p)};return O(y),(l,e)=>{const o=i("a-button"),C=i("a-switch"),p=i("a-input"),c=i("a-form-item"),s=i("a-select-option"),_=i("a-select"),x=i("a-form"),P=i("a-card"),j=i("a-table");return V(),S("div",Q,[$("div",G,[t(o,{type:"primary",onClick:T},{default:n(()=>[...e[4]||(e[4]=[d("新增",-1)])]),_:1}),t(o,{disabled:u.value.length!==1,onClick:z},{default:n(()=>[...e[5]||(e[5]=[d("编辑",-1)])]),_:1},8,["disabled"]),t(o,{disabled:u.value.length===0,danger:"",onClick:A},{default:n(()=>[...e[6]||(e[6]=[d("删除",-1)])]),_:1},8,["disabled"]),t(o,{onClick:L},{default:n(()=>[...e[7]||(e[7]=[d("导出",-1)])]),_:1}),t(C,{checked:w.value,"onUpdate:checked":e[0]||(e[0]=r=>w.value=r),"checked-children":"自动刷新","un-checked-children":"自动刷新"},null,8,["checked"]),t(o,{onClick:y},{default:n(()=>[...e[8]||(e[8]=[d("刷新",-1)])]),_:1})]),t(P,{title:"搜索条件",size:"small",class:"search-card"},{default:n(()=>[t(x,{layout:"inline",model:a},{default:n(()=>[t(c,{label:"编码"},{default:n(()=>[t(p,{value:a.code,"onUpdate:value":e[1]||(e[1]=r=>a.code=r),style:{width:"160px"}},null,8,["value"])]),_:1}),t(c,{label:"名称"},{default:n(()=>[t(p,{value:a.name,"onUpdate:value":e[2]||(e[2]=r=>a.name=r),style:{width:"200px"}},null,8,["value"])]),_:1}),t(c,{label:"严重等级"},{default:n(()=>[t(_,{value:a.severity,"onUpdate:value":e[3]||(e[3]=r=>a.severity=r),style:{width:"120px"},allowClear:""},{default:n(()=>[t(s,{value:"CR"},{default:n(()=>[...e[9]||(e[9]=[d("致命",-1)])]),_:1}),t(s,{value:"MA"},{default:n(()=>[...e[10]||(e[10]=[d("主要",-1)])]),_:1}),t(s,{value:"MI"},{default:n(()=>[...e[11]||(e[11]=[d("次要",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(c,null,{default:n(()=>[t(o,{type:"primary",onClick:D},{default:n(()=>[...e[12]||(e[12]=[d("查询",-1)])]),_:1}),t(o,{style:{"margin-left":"8px"},onClick:N},{default:n(()=>[...e[13]||(e[13]=[d("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(j,{columns:U,"data-source":k.value,pagination:b,"row-selection":M,"row-key":"id",size:"small",class:"compact-table"},null,8,["data-source","pagination","row-selection"])])}}}),Z=K(H,[["__scopeId","data-v-3881162f"]]);export{Z as default};
