import{d as E,r as y,a as w,l as F,m as H,c as N,e as O,x as t,q as a,s as i,o as S,h as s,u as $,J as x,M as V,C as G}from"./index-D0CfuKge.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"page-container"},K={class:"toolbar"},Q=E({__name:"DefectCauseList",setup(P){const p=$(),g=y([]),o=w({code:"",name:"",category:""}),I=[{title:"原因代码",dataIndex:"code",key:"code"},{title:"原因名称",dataIndex:"name",key:"name"},{title:"父级ID",dataIndex:"parentId",key:"parentId"},{title:"原因大类",dataIndex:"category",key:"category"},{title:"高频",dataIndex:"isHighFrequency",key:"isHighFrequency",customRender:({text:d})=>d?"是":"否"},{title:"操作",key:"actions",customRender:({record:d})=>{const e=i("a-space"),n=i("a-button");return x(e,null,{default:()=>[x(n,{size:"small",type:"link",onClick:()=>p.push(`/inspection-model/defect-causes/edit/${d.id}`)},{default:()=>"编辑"}),x(n,{size:"small",type:"link",onClick:()=>p.push(`/inspection-model/defect-causes/view/${d.id}`)},{default:()=>"查看"})]})}}],r=y([]),_=y([]),h=w({selectedRowKeys:r,onChange:(d,e)=>{r.value=d,_.value=e}}),k=w({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0}),C=y(!1);let f=null;F(C,d=>{d?f=setInterval(v,15e3):f&&(clearInterval(f),f=null)});const v=()=>{let e=[{id:500,parentId:null,code:"CA-MAC",name:"设备问题",category:"Machine",isHighFrequency:!1},{id:501,parentId:500,code:"CA-MAC-AGING",name:"设备老化",category:"Machine",isHighFrequency:!0}];o.code&&(e=e.filter(n=>n.code.includes(o.code))),o.name&&(e=e.filter(n=>n.name.includes(o.name))),o.category&&(e=e.filter(n=>n.category===o.category)),k.total=e.length,g.value=e},M=()=>{k.current=1,v()},R=()=>{Object.assign(o,{code:"",name:"",category:""}),M()},U=()=>p.push("/inspection-model/defect-causes/create"),q=()=>{_.value[0]&&p.push(`/inspection-model/defect-causes/edit/${_.value[0].id}`)},A=()=>{r.value.length!==0&&V.confirm({title:"确认删除",content:`确定删除选中的${r.value.length}条记录？`,okType:"danger",onOk(){G.success("删除成功")}})},z=()=>{const d=["原因代码","原因名称","父级ID","原因大类","高频"],e=g.value.map(l=>[l.code,l.name,l.parentId??"",l.category,l.isHighFrequency?"是":"否"]),n=[d,...e].map(l=>l.join(",")).join(`
`),b=new Blob([n],{type:"text/csv;charset=utf-8;"}),m=URL.createObjectURL(b),c=document.createElement("a");c.href=m,c.download="不良原因.csv",c.click(),URL.revokeObjectURL(m)};return H(v),(d,e)=>{const n=i("a-button"),b=i("a-switch"),m=i("a-input"),c=i("a-form-item"),l=i("a-select-option"),L=i("a-select"),j=i("a-form"),B=i("a-card"),D=i("a-table");return S(),N("div",T,[O("div",K,[t(n,{type:"primary",onClick:U},{default:a(()=>[...e[4]||(e[4]=[s("新增",-1)])]),_:1}),t(n,{disabled:r.value.length!==1,onClick:q},{default:a(()=>[...e[5]||(e[5]=[s("编辑",-1)])]),_:1},8,["disabled"]),t(n,{disabled:r.value.length===0,danger:"",onClick:A},{default:a(()=>[...e[6]||(e[6]=[s("删除",-1)])]),_:1},8,["disabled"]),t(n,{onClick:z},{default:a(()=>[...e[7]||(e[7]=[s("导出",-1)])]),_:1}),t(b,{checked:C.value,"onUpdate:checked":e[0]||(e[0]=u=>C.value=u),"checked-children":"自动刷新","un-checked-children":"自动刷新"},null,8,["checked"]),t(n,{onClick:v},{default:a(()=>[...e[8]||(e[8]=[s("刷新",-1)])]),_:1})]),t(B,{title:"搜索条件",size:"small",class:"search-card"},{default:a(()=>[t(j,{layout:"inline",model:o},{default:a(()=>[t(c,{label:"编码"},{default:a(()=>[t(m,{value:o.code,"onUpdate:value":e[1]||(e[1]=u=>o.code=u),style:{width:"160px"}},null,8,["value"])]),_:1}),t(c,{label:"名称"},{default:a(()=>[t(m,{value:o.name,"onUpdate:value":e[2]||(e[2]=u=>o.name=u),style:{width:"200px"}},null,8,["value"])]),_:1}),t(c,{label:"原因大类"},{default:a(()=>[t(L,{value:o.category,"onUpdate:value":e[3]||(e[3]=u=>o.category=u),style:{width:"160px"},allowClear:""},{default:a(()=>[t(l,{value:"Man"},{default:a(()=>[...e[9]||(e[9]=[s("Man",-1)])]),_:1}),t(l,{value:"Machine"},{default:a(()=>[...e[10]||(e[10]=[s("Machine",-1)])]),_:1}),t(l,{value:"Material"},{default:a(()=>[...e[11]||(e[11]=[s("Material",-1)])]),_:1}),t(l,{value:"Method"},{default:a(()=>[...e[12]||(e[12]=[s("Method",-1)])]),_:1}),t(l,{value:"Measurement"},{default:a(()=>[...e[13]||(e[13]=[s("Measurement",-1)])]),_:1}),t(l,{value:"Environment"},{default:a(()=>[...e[14]||(e[14]=[s("Environment",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(c,null,{default:a(()=>[t(n,{type:"primary",onClick:M},{default:a(()=>[...e[15]||(e[15]=[s("查询",-1)])]),_:1}),t(n,{style:{"margin-left":"8px"},onClick:R},{default:a(()=>[...e[16]||(e[16]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(D,{columns:I,"data-source":g.value,pagination:k,"row-selection":h,"row-key":"id",size:"small",class:"compact-table"},null,8,["data-source","pagination","row-selection"])])}}}),Y=J(Q,[["__scopeId","data-v-896e1d8a"]]);export{Y as default};
