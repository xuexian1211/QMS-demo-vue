import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as _,a as B,k as ye,m as ge,c as be,o as y,e as W,x as t,q as a,h as s,y as g,P as X,s as d,S as Ne,p as T,f as x,t as c,G as Te,H as xe,I as Y,C as F}from"./index-D0CfuKge.js";const Ie={class:"process-route"},qe={class:"page-header"},Ue={class:"search-form"},Re={class:"table-container"},We={__name:"ProcessRoute",setup(Se){const S=_(!1),b=_(!1),P=_(!1),U=_(!1),z=_(),j=_([]),r=B({routeCode:"",routeName:"",productName:"",status:void 0}),n=B({id:"",routeCode:"",routeName:"",productId:void 0,version:"",standardTime:0,capacity:0,description:"",status:"1",processes:[]}),D=[{title:"序号",dataIndex:"sequence",key:"sequence",width:60,customRender:({index:o})=>o+1},{title:"工序名称",dataIndex:"processName",key:"processName",width:150},{title:"工作中心",dataIndex:"workCenter",key:"workCenter",width:120},{title:"标准工时(分钟)",dataIndex:"standardTime",key:"standardTime",width:120},{title:"操作",key:"action",width:80}],Z=[{title:"路线编码",dataIndex:"routeCode",key:"routeCode",width:120,fixed:"left"},{title:"路线名称",dataIndex:"routeName",key:"routeName",width:150,fixed:"left"},{title:"适用产品",dataIndex:"productName",key:"productName",width:120,customRender:({text:o,record:e})=>O(e.productId)},{title:"版本",dataIndex:"version",key:"version",width:80},{title:"标准工时(分钟)",dataIndex:"standardTime",key:"standardTime",width:120,sorter:!0},{title:"产能(件/小时)",dataIndex:"capacity",key:"capacity",width:120,sorter:!0},{title:"工序数量",dataIndex:"processCount",key:"processCount",width:100,customRender:({record:o})=>{var e;return((e=o.processes)==null?void 0:e.length)||0}},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:200,fixed:"right"}],C=_([{id:"1",routeCode:"PR001",routeName:"电子控制器装配路线",productId:"1",version:"V1.0",standardTime:120,capacity:50,description:"电子控制器标准装配工艺路线",status:"1",createTime:"2024-01-15 10:30:00",updateTime:"2024-01-15 10:30:00",processes:[{sequence:1,processName:"PCB贴片",workCenter:"WC001",standardTime:30},{sequence:2,processName:"元件焊接",workCenter:"WC001",standardTime:45},{sequence:3,processName:"功能测试",workCenter:"WC002",standardTime:25},{sequence:4,processName:"外壳组装",workCenter:"WC001",standardTime:15},{sequence:5,processName:"最终测试",workCenter:"WC002",standardTime:5}]},{id:"2",routeCode:"PR002",routeName:"电路板组件生产线",productId:"2",version:"V2.1",standardTime:90,capacity:80,description:"电路板组件生产工艺路线",status:"1",createTime:"2024-01-15 10:35:00",updateTime:"2024-01-15 10:35:00",processes:[{sequence:1,processName:"基板准备",workCenter:"WC001",standardTime:10},{sequence:2,processName:"SMT贴片",workCenter:"WC001",standardTime:40},{sequence:3,processName:"回流焊接",workCenter:"WC001",standardTime:20},{sequence:4,processName:"AOI检测",workCenter:"WC002",standardTime:15},{sequence:5,processName:"功能测试",workCenter:"WC002",standardTime:5}]},{id:"3",routeCode:"PR003",routeName:"机械外壳加工路线",productId:"3",version:"V1.5",standardTime:180,capacity:30,description:"机械外壳加工工艺路线",status:"1",createTime:"2024-01-15 10:40:00",updateTime:"2024-01-15 10:40:00",processes:[{sequence:1,processName:"材料切割",workCenter:"WC001",standardTime:30},{sequence:2,processName:"CNC加工",workCenter:"WC001",standardTime:80},{sequence:3,processName:"表面处理",workCenter:"WC001",standardTime:40},{sequence:4,processName:"质量检验",workCenter:"WC002",standardTime:20},{sequence:5,processName:"包装入库",workCenter:"WC003",standardTime:10}]}]),I=B({current:1,pageSize:10,total:3,showSizeChanger:!0,showQuickJumper:!0,showTotal:(o,e)=>`第 ${e[0]}-${e[1]} 条，共 ${o} 条`}),p=_({}),ee={routeCode:[{required:!0,message:"请输入路线编码",trigger:"blur"}],routeName:[{required:!0,message:"请输入路线名称",trigger:"blur"}],productId:[{required:!0,message:"请选择适用产品",trigger:"change"}],version:[{required:!0,message:"请输入版本号",trigger:"blur"}]},O=o=>({1:"电子控制器",2:"电路板组件",3:"机械外壳",4:"传感器模块"})[o]||"未知",te=o=>h("div",{style:{margin:0}},[h("h4",{style:{marginBottom:"8px"}},"工序列表"),h("a-table",{columns:D,dataSource:o.processes||[],pagination:!1,size:"small",showHeader:!0})]),ae=ye(()=>U.value?"编辑工艺路线":"新增工艺路线"),L=()=>{I.current=1,q()},oe=()=>{Object.assign(r,{routeCode:"",routeName:"",productName:"",status:void 0}),L()},le=(o,e,u)=>{I.current=o.current,I.pageSize=o.pageSize,q()},se=o=>{j.value=o},ne=()=>{U.value=!1,b.value=!0,A()},de=o=>{U.value=!0,b.value=!0,Object.assign(n,{...o,processes:[...o.processes||[]]})},re=o=>{p.value=o,P.value=!0},ue=o=>{const e=C.value.findIndex(u=>u.id===o);e>-1&&(C.value.splice(e,1),F.success("删除成功"),q())},ie=()=>{const o={sequence:n.processes.length+1,processName:"",workCenter:void 0,standardTime:0};n.processes.push(o)},pe=o=>{n.processes.splice(o,1),n.processes.forEach((e,u)=>{e.sequence=u+1})},me=async()=>{try{if(await z.value.validate(),U.value){const o=C.value.findIndex(e=>e.id===n.id);o>-1&&(C.value[o]={...n,updateTime:new Date().toLocaleString()},F.success("更新成功"))}else{const o=(Math.max(...C.value.map(u=>parseInt(u.id)))+1).toString(),e={...n,id:o,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};C.value.push(e),F.success("新增成功")}b.value=!1,q()}catch(o){console.error("表单验证失败:",o)}},ce=()=>{b.value=!1,A()},A=()=>{var o;Object.assign(n,{id:"",routeCode:"",routeName:"",productId:void 0,version:"",standardTime:0,capacity:0,description:"",status:"1",processes:[]}),(o=z.value)==null||o.resetFields()},q=()=>{S.value=!0,setTimeout(()=>{let o=[...C.value];r.routeCode&&(o=o.filter(e=>e.routeCode.includes(r.routeCode))),r.routeName&&(o=o.filter(e=>e.routeName.includes(r.routeName))),r.productName&&(o=o.filter(e=>O(e.productId).includes(r.productName))),r.status!==void 0&&(o=o.filter(e=>e.status===r.status)),I.total=o.length,S.value=!1},500)};return ge(()=>{q()}),(o,e)=>{const u=d("a-button"),w=d("a-input"),i=d("a-form-item"),f=d("a-select-option"),V=d("a-select"),H=d("a-form"),K=d("a-tag"),ve=d("a-popconfirm"),fe=d("a-space"),E=d("a-table"),k=d("a-col"),M=d("a-row"),$=d("a-input-number"),G=d("a-radio"),Ce=d("a-radio-group"),_e=d("a-textarea"),J=d("a-divider"),Q=d("a-modal"),v=d("a-descriptions-item"),we=d("a-descriptions");return y(),be("div",Ie,[W("div",qe,[e[15]||(e[15]=W("h2",null,"工艺路线管理",-1)),t(u,{type:"primary",onClick:ne},{icon:a(()=>[t(g(X))]),default:a(()=>[e[14]||(e[14]=s(" 新增路线 ",-1))]),_:1})]),W("div",Ue,[t(H,{layout:"inline",model:r,onFinish:L},{default:a(()=>[t(i,{label:"路线编码"},{default:a(()=>[t(w,{value:r.routeCode,"onUpdate:value":e[0]||(e[0]=l=>r.routeCode=l),placeholder:"请输入路线编码","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(i,{label:"路线名称"},{default:a(()=>[t(w,{value:r.routeName,"onUpdate:value":e[1]||(e[1]=l=>r.routeName=l),placeholder:"请输入路线名称","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(i,{label:"适用产品"},{default:a(()=>[t(w,{value:r.productName,"onUpdate:value":e[2]||(e[2]=l=>r.productName=l),placeholder:"请输入适用产品","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(i,{label:"状态"},{default:a(()=>[t(V,{value:r.status,"onUpdate:value":e[3]||(e[3]=l=>r.status=l),placeholder:"请选择状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[t(f,{value:"1"},{default:a(()=>[...e[16]||(e[16]=[s("启用",-1)])]),_:1}),t(f,{value:"0"},{default:a(()=>[...e[17]||(e[17]=[s("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(i,null,{default:a(()=>[t(u,{type:"primary","html-type":"submit"},{icon:a(()=>[t(g(Ne))]),default:a(()=>[e[18]||(e[18]=s(" 搜索 ",-1))]),_:1}),t(u,{style:{"margin-left":"8px"},onClick:oe},{default:a(()=>[...e[19]||(e[19]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),W("div",Re,[t(E,{columns:Z,"data-source":C.value,loading:S.value,pagination:I,"row-key":"id",onChange:le,expandable:{expandedRowRender:te,expandedRowKeys:j.value,onExpandedRowsChange:se}},{bodyCell:a(({column:l,record:m})=>[l.key==="status"?(y(),T(K,{key:0,color:m.status==="1"?"green":"red"},{default:a(()=>[s(c(m.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):x("",!0),l.key==="action"?(y(),T(fe,{key:1},{default:a(()=>[t(u,{type:"link",size:"small",onClick:R=>de(m)},{icon:a(()=>[t(g(Te))]),default:a(()=>[e[20]||(e[20]=s(" 编辑 ",-1))]),_:1},8,["onClick"]),t(u,{type:"link",size:"small",onClick:R=>re(m)},{icon:a(()=>[t(g(xe))]),default:a(()=>[e[21]||(e[21]=s(" 查看 ",-1))]),_:1},8,["onClick"]),t(ve,{title:"确定要删除这条工艺路线吗？",onConfirm:R=>ue(m.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[t(u,{type:"link",size:"small",danger:""},{icon:a(()=>[t(g(Y))]),default:a(()=>[e[22]||(e[22]=s(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):x("",!0)]),_:1},8,["data-source","loading","pagination","expandable"])]),t(Q,{visible:b.value,"onUpdate:visible":e[12]||(e[12]=l=>b.value=l),title:ae.value,width:"1000px",onOk:me,onCancel:ce},{default:a(()=>[t(H,{ref_key:"formRef",ref:z,model:n,rules:ee,layout:"vertical"},{default:a(()=>[t(M,{gutter:16},{default:a(()=>[t(k,{span:12},{default:a(()=>[t(i,{label:"路线编码",name:"routeCode"},{default:a(()=>[t(w,{value:n.routeCode,"onUpdate:value":e[4]||(e[4]=l=>n.routeCode=l),placeholder:"请输入路线编码"},null,8,["value"])]),_:1})]),_:1}),t(k,{span:12},{default:a(()=>[t(i,{label:"路线名称",name:"routeName"},{default:a(()=>[t(w,{value:n.routeName,"onUpdate:value":e[5]||(e[5]=l=>n.routeName=l),placeholder:"请输入路线名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(M,{gutter:16},{default:a(()=>[t(k,{span:12},{default:a(()=>[t(i,{label:"适用产品",name:"productId"},{default:a(()=>[t(V,{value:n.productId,"onUpdate:value":e[6]||(e[6]=l=>n.productId=l),placeholder:"请选择适用产品"},{default:a(()=>[t(f,{value:"1"},{default:a(()=>[...e[23]||(e[23]=[s("电子控制器",-1)])]),_:1}),t(f,{value:"2"},{default:a(()=>[...e[24]||(e[24]=[s("电路板组件",-1)])]),_:1}),t(f,{value:"3"},{default:a(()=>[...e[25]||(e[25]=[s("机械外壳",-1)])]),_:1}),t(f,{value:"4"},{default:a(()=>[...e[26]||(e[26]=[s("传感器模块",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(k,{span:12},{default:a(()=>[t(i,{label:"版本",name:"version"},{default:a(()=>[t(w,{value:n.version,"onUpdate:value":e[7]||(e[7]=l=>n.version=l),placeholder:"请输入版本号"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(M,{gutter:16},{default:a(()=>[t(k,{span:8},{default:a(()=>[t(i,{label:"标准工时(分钟)",name:"standardTime"},{default:a(()=>[t($,{value:n.standardTime,"onUpdate:value":e[8]||(e[8]=l=>n.standardTime=l),placeholder:"请输入标准工时",min:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(k,{span:8},{default:a(()=>[t(i,{label:"产能(件/小时)",name:"capacity"},{default:a(()=>[t($,{value:n.capacity,"onUpdate:value":e[9]||(e[9]=l=>n.capacity=l),placeholder:"请输入产能",min:0,style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),t(k,{span:8},{default:a(()=>[t(i,{label:"状态",name:"status"},{default:a(()=>[t(Ce,{value:n.status,"onUpdate:value":e[10]||(e[10]=l=>n.status=l)},{default:a(()=>[t(G,{value:"1"},{default:a(()=>[...e[27]||(e[27]=[s("启用",-1)])]),_:1}),t(G,{value:"0"},{default:a(()=>[...e[28]||(e[28]=[s("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(i,{label:"描述",name:"description"},{default:a(()=>[t(_e,{value:n.description,"onUpdate:value":e[11]||(e[11]=l=>n.description=l),placeholder:"请输入工艺路线描述",rows:3},null,8,["value"])]),_:1}),t(J,null,{default:a(()=>[...e[29]||(e[29]=[s("工序配置",-1)])]),_:1}),t(i,{label:"工序列表"},{default:a(()=>[t(E,{columns:D,"data-source":n.processes,pagination:!1,size:"small"},{bodyCell:a(({column:l,record:m,index:R})=>[l.key==="processName"?(y(),T(w,{key:0,value:m.processName,"onUpdate:value":N=>m.processName=N,placeholder:"工序名称"},null,8,["value","onUpdate:value"])):x("",!0),l.key==="workCenter"?(y(),T(V,{key:1,value:m.workCenter,"onUpdate:value":N=>m.workCenter=N,placeholder:"工作中心"},{default:a(()=>[t(f,{value:"WC001"},{default:a(()=>[...e[30]||(e[30]=[s("装配车间",-1)])]),_:1}),t(f,{value:"WC002"},{default:a(()=>[...e[31]||(e[31]=[s("测试车间",-1)])]),_:1}),t(f,{value:"WC003"},{default:a(()=>[...e[32]||(e[32]=[s("包装车间",-1)])]),_:1})]),_:1},8,["value","onUpdate:value"])):x("",!0),l.key==="standardTime"?(y(),T($,{key:2,value:m.standardTime,"onUpdate:value":N=>m.standardTime=N,placeholder:"标准工时",min:0,style:{width:"100%"}},null,8,["value","onUpdate:value"])):x("",!0),l.key==="action"?(y(),T(u,{key:3,type:"link",size:"small",danger:"",onClick:N=>pe(R)},{icon:a(()=>[t(g(Y))]),default:a(()=>[e[33]||(e[33]=s(" 删除 ",-1))]),_:1},8,["onClick"])):x("",!0)]),footer:a(()=>[t(u,{type:"dashed",onClick:ie,block:""},{icon:a(()=>[t(g(X))]),default:a(()=>[e[34]||(e[34]=s(" 添加工序 ",-1))]),_:1})]),_:1},8,["data-source"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(Q,{visible:P.value,"onUpdate:visible":e[13]||(e[13]=l=>P.value=l),title:"工艺路线详情",width:"1000px",footer:null},{default:a(()=>[t(we,{column:3,bordered:""},{default:a(()=>[t(v,{label:"路线编码"},{default:a(()=>[s(c(p.value.routeCode),1)]),_:1}),t(v,{label:"路线名称"},{default:a(()=>[s(c(p.value.routeName),1)]),_:1}),t(v,{label:"版本"},{default:a(()=>[s(c(p.value.version),1)]),_:1}),t(v,{label:"适用产品"},{default:a(()=>[s(c(O(p.value.productId)),1)]),_:1}),t(v,{label:"标准工时"},{default:a(()=>[s(c(p.value.standardTime)+"分钟",1)]),_:1}),t(v,{label:"产能"},{default:a(()=>[s(c(p.value.capacity)+"件/小时",1)]),_:1}),t(v,{label:"状态"},{default:a(()=>[t(K,{color:p.value.status==="1"?"green":"red"},{default:a(()=>[s(c(p.value.status==="1"?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),t(v,{label:"创建时间"},{default:a(()=>[s(c(p.value.createTime),1)]),_:1}),t(v,{label:"更新时间"},{default:a(()=>[s(c(p.value.updateTime),1)]),_:1}),t(v,{label:"描述",span:3},{default:a(()=>[s(c(p.value.description||"无"),1)]),_:1})]),_:1}),t(J,null,{default:a(()=>[...e[35]||(e[35]=[s("工序详情",-1)])]),_:1}),t(E,{columns:D,"data-source":p.value.processes||[],pagination:!1,size:"small"},null,8,["data-source"])]),_:1},8,["visible"])])}}},ze=ke(We,[["__scopeId","data-v-40a75d84"]]);export{ze as default};
