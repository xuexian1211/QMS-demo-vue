import{d as Q,r as p,a as x,m as H,c as W,e as S,x as t,q as a,s as u,o as D,h as r,y as _,P as X,G as Y,I as Z,R as ee,p as te,f as ae,M as E,C as I}from"./index-BsO03Xlk.js";import{E as le}from"./ExportOutlined-3X2_SK8n.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"page-container"},de={class:"toolbar"},ie={class:"table-container"},se=Q({__name:"InspMethodList",setup(ue){const b=p(!1),s=p([]),m=p([]),d=x({methodName:"",attachmentId:""}),f=x({current:1,pageSize:20,total:0,showSizeChanger:!0,showQuickJumper:!0}),z=[{title:"方法名称",dataIndex:"methodName",key:"methodName",width:200},{title:"附件ID",dataIndex:"attachmentId",key:"attachmentId",width:200},{title:"操作步骤",dataIndex:"operationText",key:"operationText",ellipsis:!0},{title:"操作",key:"action",width:150,fixed:"right"}],v=()=>{b.value=!0,setTimeout(()=>{let l=[{id:"201",methodName:"通用卡尺测量法",operationText:"1. 校零 2. 清洁工件 3. 测量关键尺寸 4.记录",attachmentId:"FILE_SOP_001.pdf"},{id:"202",methodName:"目视检查",operationText:"1. 明确判定标准 2. 在自然光条件下检查表面 3.记录",attachmentId:""}];d.methodName&&(l=l.filter(e=>e.methodName.includes(d.methodName))),d.attachmentId&&(l=l.filter(e=>(e.attachmentId||"").includes(d.attachmentId))),s.value=l,f.total=l.length,b.value=!1},300)},y=()=>{f.current=1,v()},R=()=>{d.methodName="",d.attachmentId="",y()},U=l=>{f.current=l.current,f.pageSize=l.pageSize,v()},B=l=>{m.value=l},h=p(!1),g=p(!1),C=p(),o=x({id:null,methodName:"",attachmentId:"",operationText:""}),M={methodName:[{required:!0,message:"请输入方法名称",trigger:"blur"}]},P=()=>{g.value=!1,Object.assign(o,{id:null,methodName:"",attachmentId:"",operationText:""}),h.value=!0},N=l=>{const e=l.id?l:s.value.find(i=>i.id===m.value[0]);e&&(g.value=!0,Object.assign(o,{...e}),h.value=!0)},V=l=>{E.confirm({title:"确认删除",content:`确定删除检验方法 ${l.methodName} 吗？`,okType:"danger",onOk(){s.value=s.value.filter(e=>e.id!==l.id),I.success("删除成功")}})},L=()=>{E.confirm({title:"确认批量删除",content:`确定删除选中的 ${m.value.length} 条记录吗？`,okType:"danger",onOk(){s.value=s.value.filter(l=>!m.value.includes(l.id)),m.value=[],I.success("删除成功")}})},$=()=>{C.value.validate().then(()=>{if(g.value){const l=s.value.findIndex(e=>e.id===o.id);l>-1&&Object.assign(s.value[l],o)}else s.value.push({...o,id:Date.now().toString()});I.success("保存成功"),h.value=!1,v()})},j=()=>{I.success("导出任务已开始")};return H(()=>{v()}),(l,e)=>{const i=u("a-button"),w=u("a-space"),k=u("a-input"),c=u("a-form-item"),T=u("a-form"),q=u("a-card"),F=u("a-divider"),K=u("a-table"),A=u("a-textarea"),G=u("a-modal");return D(),W("div",oe,[S("div",de,[t(w,null,{default:a(()=>[t(i,{type:"primary",onClick:P},{icon:a(()=>[t(_(X))]),default:a(()=>[e[6]||(e[6]=r("新增 ",-1))]),_:1}),t(i,{disabled:m.value.length!==1,onClick:N},{icon:a(()=>[t(_(Y))]),default:a(()=>[e[7]||(e[7]=r("编辑 ",-1))]),_:1},8,["disabled"]),t(i,{danger:"",disabled:m.value.length===0,onClick:L},{icon:a(()=>[t(_(Z))]),default:a(()=>[e[8]||(e[8]=r("删除 ",-1))]),_:1},8,["disabled"]),t(i,{onClick:j},{icon:a(()=>[t(_(le))]),default:a(()=>[e[9]||(e[9]=r("导出 ",-1))]),_:1}),t(i,{onClick:v},{icon:a(()=>[t(_(ee))]),default:a(()=>[e[10]||(e[10]=r("刷新 ",-1))]),_:1})]),_:1})]),t(q,{class:"search-card",bordered:!1},{default:a(()=>[t(T,{layout:"inline",model:d},{default:a(()=>[t(c,{label:"方法名称"},{default:a(()=>[t(k,{value:d.methodName,"onUpdate:value":e[0]||(e[0]=n=>d.methodName=n),placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1}),t(c,{label:"附件ID"},{default:a(()=>[t(k,{value:d.attachmentId,"onUpdate:value":e[1]||(e[1]=n=>d.attachmentId=n),placeholder:"请输入","allow-clear":""},null,8,["value"])]),_:1}),t(c,null,{default:a(()=>[t(i,{type:"primary",onClick:y},{default:a(()=>[...e[11]||(e[11]=[r("查询",-1)])]),_:1}),t(i,{style:{"margin-left":"8px"},onClick:R},{default:a(()=>[...e[12]||(e[12]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),S("div",ie,[t(K,{columns:z,"data-source":s.value,loading:b.value,"row-key":"id",size:"middle","row-selection":{selectedRowKeys:m.value,onChange:B},pagination:f,onChange:U},{bodyCell:a(({column:n,record:O})=>[n.key==="action"?(D(),te(w,{key:0},{default:a(()=>[t(i,{type:"link",size:"small",onClick:J=>N(O)},{default:a(()=>[...e[13]||(e[13]=[r("编辑",-1)])]),_:1},8,["onClick"]),t(F,{type:"vertical"}),t(i,{type:"link",danger:"",size:"small",onClick:J=>V(O)},{default:a(()=>[...e[14]||(e[14]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):ae("",!0)]),_:1},8,["data-source","loading","row-selection","pagination"])]),t(G,{visible:h.value,"onUpdate:visible":e[5]||(e[5]=n=>h.value=n),title:g.value?"编辑检验方法":"新增检验方法",width:"600px",onOk:$},{default:a(()=>[t(T,{ref_key:"formRef",ref:C,model:o,rules:M,layout:"vertical"},{default:a(()=>[t(c,{label:"方法名称",name:"methodName"},{default:a(()=>[t(k,{value:o.methodName,"onUpdate:value":e[2]||(e[2]=n=>o.methodName=n),placeholder:"请输入方法名称"},null,8,["value"])]),_:1}),t(c,{label:"附件ID",name:"attachmentId"},{default:a(()=>[t(k,{value:o.attachmentId,"onUpdate:value":e[3]||(e[3]=n=>o.attachmentId=n),placeholder:"例如：FILE_SOP_001.pdf"},null,8,["value"])]),_:1}),t(c,{label:"操作步骤描述",name:"operationText"},{default:a(()=>[t(A,{value:o.operationText,"onUpdate:value":e[4]||(e[4]=n=>o.operationText=n),rows:6,placeholder:"请输入操作步骤"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}}),pe=ne(se,[["__scopeId","data-v-70cf9ed7"]]);export{pe as default};
