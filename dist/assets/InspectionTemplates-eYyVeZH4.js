import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as S,r as y,m as oe,c as U,o as g,e as Q,x as t,q as a,h as u,y as O,P as D,s,p as N,f as R,t as se,F as ie,z as ue,C as b}from"./index-D0CfuKge.js";const de={class:"page-container"},re={class:"page-header"},me={class:"search-form"},pe={__name:"InspectionTemplates",setup(ce){const c=S({name:"",type:""}),r=y([]),x=y(!1),v=S({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:l=>`共 ${l} 条数据`}),V=[{title:"模板编号",dataIndex:"code",key:"code",width:120},{title:"模板名称",dataIndex:"name",key:"name"},{title:"检验类型",dataIndex:"type",key:"type",width:100},{title:"检验项目数",dataIndex:"itemCount",key:"itemCount",width:100},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:180,fixed:"right"}],f=y(!1),C=y(!1),h=y(),o=S({id:null,name:"",type:"",description:"",items:[],status:"active"}),q={name:[{required:!0,message:"请输入模板名称",trigger:"blur"}],type:[{required:!0,message:"请选择检验类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},P=[{id:1,code:"TPL001",name:"来料检验标准模板",type:"IQC",description:"用于原材料进厂检验的标准模板",itemCount:12,status:"active",createTime:"2024-01-15 09:30:00"},{id:2,code:"TPL002",name:"过程检验通用模板",type:"IPQC",description:"生产过程中的质量检验模板",itemCount:8,status:"active",createTime:"2024-01-16 14:20:00"},{id:3,code:"TPL003",name:"成品出厂检验模板",type:"FQC",description:"成品出厂前的最终检验模板",itemCount:15,status:"inactive",createTime:"2024-01-17 10:45:00"}],w=()=>{x.value=!0,setTimeout(()=>{r.value=P,v.total=P.length,x.value=!1},500)},z=()=>{v.current=1,w()},B=()=>{c.name="",c.type="",z()},M=l=>{v.current=l.current,v.pageSize=l.pageSize,w()},j=()=>{C.value=!1,f.value=!0,I()},E=l=>{C.value=!0,f.value=!0,Object.assign(o,{...l,items:l.items||[{name:"",method:"",standard:""}]})},J=l=>{b.info("查看功能开发中...")},A=l=>{const e=r.value.findIndex(i=>i.id===l);e>-1&&(r.value.splice(e,1),v.total--,b.success("删除成功"))},G=()=>{o.items.push({name:"",method:"",standard:""})},H=l=>{o.items.length>1&&o.items.splice(l,1)},K=async()=>{try{if(await h.value.validate(),C.value){const l=r.value.findIndex(e=>e.id===o.id);l>-1&&(r.value[l]={...o,itemCount:o.items.length,code:o.code||`TPL${String(o.id).padStart(3,"0")}`}),b.success("更新成功")}else{const l=Math.max(...r.value.map(i=>i.id))+1,e={...o,id:l,code:`TPL${String(l).padStart(3,"0")}`,itemCount:o.items.length,createTime:new Date().toLocaleString("zh-CN")};r.value.unshift(e),v.total++,b.success("创建成功")}f.value=!1,I()}catch(l){console.error("表单验证失败:",l)}},W=()=>{f.value=!1,I()},I=()=>{var l;Object.assign(o,{id:null,name:"",type:"",description:"",items:[{name:"",method:"",standard:""}],status:"active"}),(l=h.value)==null||l.resetFields()};return oe(()=>{w()}),(l,e)=>{const i=s("a-button"),k=s("a-input"),m=s("a-form-item"),T=s("a-select"),F=s("a-form"),X=s("a-tag"),Y=s("a-popconfirm"),Z=s("a-space"),ee=s("a-table"),_=s("a-col"),L=s("a-row"),te=s("a-textarea"),$=s("a-radio"),ae=s("a-radio-group"),le=s("a-modal");return g(),U("div",de,[Q("div",re,[e[8]||(e[8]=Q("h1",null,"检验模板管理",-1)),t(i,{type:"primary",onClick:j},{icon:a(()=>[t(O(D))]),default:a(()=>[e[7]||(e[7]=u(" 新建模板 ",-1))]),_:1})]),Q("div",me,[t(F,{layout:"inline",model:c},{default:a(()=>[t(m,{label:"模板名称"},{default:a(()=>[t(k,{value:c.name,"onUpdate:value":e[0]||(e[0]=n=>c.name=n),placeholder:"请输入模板名称"},null,8,["value"])]),_:1}),t(m,{label:"检验类型"},{default:a(()=>[t(T,{value:c.type,"onUpdate:value":e[1]||(e[1]=n=>c.type=n),placeholder:"请选择检验类型",style:{width:"150px"},options:[{value:"IQC",label:"来料检验"},{value:"IPQC",label:"过程检验"},{value:"FQC",label:"成品检验"},{value:"OQC",label:"出货检验"}]},null,8,["value"])]),_:1}),t(m,null,{default:a(()=>[t(i,{type:"primary",onClick:z},{default:a(()=>[...e[9]||(e[9]=[u("查询",-1)])]),_:1}),t(i,{style:{"margin-left":"8px"},onClick:B},{default:a(()=>[...e[10]||(e[10]=[u("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),t(ee,{columns:V,"data-source":r.value,pagination:v,loading:x.value,onChange:M,"row-key":"id"},{bodyCell:a(({column:n,record:p})=>[n.key==="status"?(g(),N(X,{key:0,color:p.status==="active"?"green":"red"},{default:a(()=>[u(se(p.status==="active"?"启用":"禁用"),1)]),_:2},1032,["color"])):R("",!0),n.key==="action"?(g(),N(Z,{key:1},{default:a(()=>[t(i,{type:"link",size:"small",onClick:d=>E(p)},{default:a(()=>[...e[11]||(e[11]=[u("编辑",-1)])]),_:1},8,["onClick"]),t(i,{type:"link",size:"small",onClick:d=>J(p)},{default:a(()=>[...e[12]||(e[12]=[u("查看",-1)])]),_:1},8,["onClick"]),t(Y,{title:"确定要删除这个模板吗？",onConfirm:d=>A(p.id)},{default:a(()=>[t(i,{type:"link",size:"small",danger:""},{default:a(()=>[...e[13]||(e[13]=[u("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):R("",!0)]),_:1},8,["data-source","pagination","loading"]),t(le,{visible:f.value,"onUpdate:visible":e[6]||(e[6]=n=>f.value=n),title:C.value?"编辑模板":"新建模板",width:"800px",onOk:K,onCancel:W},{default:a(()=>[t(F,{ref_key:"formRef",ref:h,model:o,rules:q,layout:"vertical"},{default:a(()=>[t(L,{gutter:16},{default:a(()=>[t(_,{span:12},{default:a(()=>[t(m,{label:"模板名称",name:"name"},{default:a(()=>[t(k,{value:o.name,"onUpdate:value":e[2]||(e[2]=n=>o.name=n),placeholder:"请输入模板名称"},null,8,["value"])]),_:1})]),_:1}),t(_,{span:12},{default:a(()=>[t(m,{label:"检验类型",name:"type"},{default:a(()=>[t(T,{value:o.type,"onUpdate:value":e[3]||(e[3]=n=>o.type=n),placeholder:"请选择检验类型",options:[{value:"IQC",label:"来料检验"},{value:"IPQC",label:"过程检验"},{value:"FQC",label:"成品检验"},{value:"OQC",label:"出货检验"}]},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(m,{label:"模板描述",name:"description"},{default:a(()=>[t(te,{value:o.description,"onUpdate:value":e[4]||(e[4]=n=>o.description=n),rows:3,placeholder:"请输入模板描述"},null,8,["value"])]),_:1}),t(m,{label:"检验项目",name:"items"},{default:a(()=>[(g(!0),U(ie,null,ue(o.items,(n,p)=>(g(),U("div",{key:p,class:"inspection-item"},[t(L,{gutter:8},{default:a(()=>[t(_,{span:8},{default:a(()=>[t(k,{value:n.name,"onUpdate:value":d=>n.name=d,placeholder:"检验项目名称"},null,8,["value","onUpdate:value"])]),_:2},1024),t(_,{span:6},{default:a(()=>[t(T,{value:n.method,"onUpdate:value":d=>n.method=d,placeholder:"检验方法",options:[{value:"visual",label:"目视"},{value:"measure",label:"测量"},{value:"test",label:"测试"}]},null,8,["value","onUpdate:value"])]),_:2},1024),t(_,{span:6},{default:a(()=>[t(k,{value:n.standard,"onUpdate:value":d=>n.standard=d,placeholder:"检验标准"},null,8,["value","onUpdate:value"])]),_:2},1024),t(_,{span:4},{default:a(()=>[t(i,{type:"text",danger:"",onClick:d=>H(p)},{default:a(()=>[...e[14]||(e[14]=[u("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),t(i,{type:"dashed",onClick:G,style:{width:"100%","margin-top":"8px"}},{icon:a(()=>[t(O(D))]),default:a(()=>[e[15]||(e[15]=u(" 添加检验项目 ",-1))]),_:1})]),_:1}),t(m,{label:"状态",name:"status"},{default:a(()=>[t(ae,{value:o.status,"onUpdate:value":e[5]||(e[5]=n=>o.status=n)},{default:a(()=>[t($,{value:"active"},{default:a(()=>[...e[16]||(e[16]=[u("启用",-1)])]),_:1}),t($,{value:"inactive"},{default:a(()=>[...e[17]||(e[17]=[u("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}},_e=ne(pe,[["__scopeId","data-v-9a0454c7"]]);export{_e as default};
