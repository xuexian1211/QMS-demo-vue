import{d as lt,r as f,a as B,k as G,m as nt,c as N,e as D,x as t,q as a,s as d,o as u,h as s,y as $,P as st,G as rt,I as ot,Y as it,R as dt,p as k,f as y,t as i,F as R,z as ae,O as ut,M as le,C as q,u as ct}from"./index-BPMZt9Bz.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pt={class:"page-container"},ft={class:"toolbar"},vt={class:"table-container"},yt=["onClick"],Ct={class:"table-container"},_t=["onClick"],Nt={key:1,style:{color:"#bfbfbf"}},kt={key:1,style:{color:"#bfbfbf"}},bt={class:"table-container"},gt={key:0,style:{color:"#ff4d4f","margin-left":"4px"}},wt={key:1,style:{color:"#bfbfbf"}},xt=lt({__name:"CustomerSupplierMapping",setup(St){const ke=ct(),z=f(!1),ne=f("materialMapping"),b=f([]),O=f(!1),Q=f(!1),g=f(!1),H=f(),se=f([{id:"C001",code:"CUST001",name:"华为技术有限公司",type:"customer"},{id:"C002",code:"CUST002",name:"腾讯科技有限公司",type:"customer"},{id:"C003",code:"CUST003",name:"阿里巴巴集团",type:"customer"},{id:"S001",code:"SUP001",name:"富士康科技集团",type:"supplier"},{id:"S002",code:"SUP002",name:"立讯精密工业",type:"supplier"},{id:"S003",code:"SUP003",name:"宁德时代新能源",type:"supplier"}]),re=f([{id:"M001",code:"MAT-001",name:"铝合金压铸件A"},{id:"M002",code:"MAT-002",name:"锌合金外壳B"},{id:"M003",code:"MAT-003",name:"精密连接器C"},{id:"M004",code:"MAT-004",name:"散热模组D"},{id:"M005",code:"MAT-005",name:"电池模组E"}]),m=B({partnerName:"",externalCode:"",internalCode:"",status:void 0}),c=B({id:"",direction:"customer",partnerId:void 0,externalCode:"",externalName:"",internalMaterialId:void 0,status:"1",remark:""}),be={direction:[{required:!0,message:"请选择映射方向",trigger:"change"}],partnerId:[{required:!0,message:"请选择客户/供应商",trigger:"change"}],externalCode:[{required:!0,message:"请输入外部物料编码",trigger:"blur"}],internalMaterialId:[{required:!0,message:"请选择内部物料",trigger:"change"}]},w=f([{id:"1",direction:"customer",partnerId:"C001",partnerName:"华为技术有限公司",externalCode:"HW-AL-001",externalName:"铝壳体组件",internalMaterialId:"M001",internalCode:"MAT-001",internalName:"铝合金压铸件A",status:"1",remark:"华为定制编码",createTime:"2024-06-01 10:00:00"},{id:"2",direction:"customer",partnerId:"C002",partnerName:"腾讯科技有限公司",externalCode:"TX-ZN-002",externalName:"锌合金机壳",internalMaterialId:"M002",internalCode:"MAT-002",internalName:"锌合金外壳B",status:"1",remark:"",createTime:"2024-06-02 14:30:00"},{id:"3",direction:"supplier",partnerId:"S001",partnerName:"富士康科技集团",externalCode:"FX-CONN-100",externalName:"Type-C接口组件",internalMaterialId:"M003",internalCode:"MAT-003",internalName:"精密连接器C",status:"1",remark:"富士康供货编码",createTime:"2024-06-03 09:15:00"},{id:"4",direction:"supplier",partnerId:"S003",partnerName:"宁德时代新能源",externalCode:"CATL-BAT-E50",externalName:"50Ah方壳电芯",internalMaterialId:"M005",internalCode:"MAT-005",internalName:"电池模组E",status:"0",remark:"旧编码，已停用",createTime:"2024-05-10 16:00:00"}]),ge=[{title:"方向",dataIndex:"direction",key:"direction",width:80},{title:"客户/供应商",dataIndex:"partnerName",key:"partnerName",width:160},{title:"外部物料编码",dataIndex:"externalCode",key:"externalCode",width:140},{title:"外部物料名称",dataIndex:"externalName",key:"externalName",width:150},{title:"内部物料编码",dataIndex:"internalCode",key:"internalCode",width:120},{title:"内部物料名称",dataIndex:"internalName",key:"internalName",width:150},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:180,fixed:"right"}],oe=G(()=>{let n=[...w.value];return m.partnerName&&(n=n.filter(e=>e.partnerName.includes(m.partnerName))),m.externalCode&&(n=n.filter(e=>e.externalCode.includes(m.externalCode))),m.internalCode&&(n=n.filter(e=>e.internalCode.includes(m.internalCode))),m.status&&(n=n.filter(e=>e.status===m.status)),n}),x=B({customerName:"",ctqName:""}),W=f(!1),v=f(null),we=f([{id:"CTQ001",customerName:"华为技术有限公司",ctqName:"外观光洁度Ra",severity:"critical",materialName:"铝合金压铸件A",inspItemName:"表面粗糙度检测",standardDesc:"Ra ≤ 0.8μm，目视无划痕及凹坑",syncStatus:"synced",csrClauseId:"CSR-HW-001",csrClauseDesc:"华为CSR V2024.1 - 外观全检要求",csrVersion:"V2024.1",csrVersionOutdated:!0},{id:"CTQ002",customerName:"华为技术有限公司",ctqName:"尺寸公差-长度",severity:"major",materialName:"铝合金压铸件A",inspItemName:"外径长度检测",standardDesc:"100±0.05mm，三坐标测量",syncStatus:"synced",csrClauseId:"CSR-HW-002",csrClauseDesc:"华为CSR V2024.1 - 关键尺寸管控",csrVersion:"V2024.1",csrVersionOutdated:!0},{id:"CTQ003",customerName:"腾讯科技有限公司",ctqName:"抗压强度",severity:"critical",materialName:"锌合金外壳B",inspItemName:"",standardDesc:"≥ 350MPa，压力试验机检测",syncStatus:"pending",csrClauseId:null,csrClauseDesc:"",csrVersion:"",csrVersionOutdated:!1},{id:"CTQ004",customerName:"阿里巴巴集团",ctqName:"焊接气密性",severity:"major",materialName:"散热模组D",inspItemName:"气密性检测",standardDesc:"0.5MPa保压30s无泄漏",syncStatus:"synced",csrClauseId:"CSR-ALI-001",csrClauseDesc:"阿里CSR V3.0 - 气密性强控条款",csrVersion:"V3.0",csrVersionOutdated:!1}]),ie=f([{customerName:"华为技术有限公司",oldVersion:"V2024.1",newVersion:"V2024.2"}]),xe=[{title:"客户名称",dataIndex:"customerName",key:"customerName",width:140},{title:"CTQ特性名称",dataIndex:"ctqName",key:"ctqName",width:130},{title:"严重等级",dataIndex:"severity",key:"severity",width:120},{title:"来源 CSR",dataIndex:"csrSource",key:"csrSource",width:220},{title:"CSR版本",dataIndex:"csrVersion",key:"csrVersion",width:100},{title:"关联物料",dataIndex:"materialName",key:"materialName",width:140},{title:"标准要求",dataIndex:"standardDesc",key:"standardDesc",width:180,ellipsis:!0},{title:"同步状态",dataIndex:"syncStatus",key:"syncStatus",width:90},{title:"操作",key:"action",width:180,fixed:"right"}],Se=G(()=>{let n=[...we.value];return x.customerName&&(n=n.filter(e=>e.customerName.includes(x.customerName))),x.ctqName&&(n=n.filter(e=>e.ctqName.includes(x.ctqName))),n}),I=B({productName:"",customerName:""}),X=f(!1),C=f(null),Ie=f([{id:"TR001",customerName:"华为技术有限公司",productCode:"FP-001",productName:"5G基站散热壳体",processName:"压铸→CNC→阳极氧化→装配",rawMaterial:"铝合金ADC12",supplierName:"立讯精密工业"},{id:"TR002",customerName:"腾讯科技有限公司",productCode:"FP-002",productName:"服务器外壳组件",processName:"压铸→喷砂→喷粉→检验",rawMaterial:"锌合金ZA-8",supplierName:"富士康科技集团"},{id:"TR003",customerName:"阿里巴巴集团",productCode:"FP-003",productName:"数据中心散热模组",processName:"冲压→焊接→气密检测→总装",rawMaterial:"铜管+铝翅片",supplierName:"宁德时代新能源"}]),Me=[{title:"客户",dataIndex:"customerName",key:"customerName",width:150},{title:"成品编码",dataIndex:"productCode",key:"productCode",width:100},{title:"成品名称",dataIndex:"productName",key:"productName",width:160},{title:"生产工序",dataIndex:"processName",key:"processName",width:200},{title:"原材料",dataIndex:"rawMaterial",key:"rawMaterial",width:130},{title:"供应商",dataIndex:"supplierName",key:"supplierName",width:150},{title:"操作",key:"action",width:150,fixed:"right"}],Te=G(()=>{let n=[...Ie.value];return I.productName&&(n=n.filter(e=>e.productName.includes(I.productName))),I.customerName&&(n=n.filter(e=>e.customerName.includes(I.customerName))),n}),F=B({current:1,pageSize:20,total:4,showSizeChanger:!0,showQuickJumper:!0}),Ve=G(()=>g.value?"查看物料编码映射":Q.value?"编辑物料编码映射":"新增物料编码映射"),de=(n,e)=>{var M,E;const o=((E=(M=e==null?void 0:e.children)==null?void 0:M[0])==null?void 0:E.children)||"";return String(o).toLowerCase().includes(n.toLowerCase())},he=n=>{b.value=n},De=()=>{F.current=1},qe=()=>{Object.assign(m,{partnerName:"",externalCode:"",internalCode:"",status:void 0})},Oe=()=>{},Re=()=>{Object.assign(x,{customerName:"",ctqName:""})},Ue=()=>{},Ae=()=>{Object.assign(I,{productName:"",customerName:""})},$e=n=>{F.current=n.current,F.pageSize=n.pageSize},ze=()=>{Q.value=!1,g.value=!1,O.value=!0,ce()},Qe=()=>{const n=w.value.find(e=>e.id===b.value[0]);n&&ue(n)},ue=n=>{Q.value=!0,g.value=!1,O.value=!0,Object.assign(c,{...n})},Fe=n=>{Q.value=!0,g.value=!0,O.value=!0,Object.assign(c,{...n})},je=n=>{le.confirm({title:"确认删除",content:"确定删除该映射记录吗？",okType:"danger",onOk(){const e=w.value.findIndex(o=>o.id===n.id);e>-1&&(w.value.splice(e,1),q.success("删除成功"))}})},Be=()=>{le.confirm({title:"确认批量删除",content:`确定删除选中的 ${b.value.length} 条记录吗？`,okType:"danger",onOk(){w.value=w.value.filter(n=>!b.value.includes(n.id)),b.value=[],q.success("批量删除成功")}})},Ee=({key:n})=>{const e=n==="enable"?"1":"0",o=n==="enable"?"启用":"禁用";le.confirm({title:`确认批量${o}`,content:`确定${o}选中的 ${b.value.length} 条记录吗？`,onOk(){w.value.forEach(M=>{b.value.includes(M.id)&&(M.status=e)}),b.value=[],q.success(`批量${o}成功`)}})},Pe=async()=>{try{await H.value.validate();const n=se.value.find(o=>o.id===c.partnerId),e=re.value.find(o=>o.id===c.internalMaterialId);if(Q.value){const o=w.value.findIndex(M=>M.id===c.id);o>-1&&(w.value[o]={...c,partnerName:(n==null?void 0:n.name)||"",internalCode:(e==null?void 0:e.code)||"",internalName:(e==null?void 0:e.name)||"",createTime:w.value[o].createTime},q.success("更新成功"))}else{const o=String(Date.now());w.value.push({...c,id:o,partnerName:(n==null?void 0:n.name)||"",internalCode:(e==null?void 0:e.code)||"",internalName:(e==null?void 0:e.name)||"",createTime:new Date().toLocaleString()}),q.success("新增成功")}O.value=!1}catch(n){console.error("表单验证失败:",n)}},Le=()=>{O.value=!1,ce()},ce=()=>{var n;Object.assign(c,{id:"",direction:"customer",partnerId:void 0,externalCode:"",externalName:"",internalMaterialId:void 0,status:"1",remark:""}),(n=H.value)==null||n.resetFields()},Ke=n=>{n.syncStatus="synced",q.success(`CTQ特性 [${n.ctqName}] 已成功同步至检验项目`)},Ge=n=>{v.value=n,W.value=!0},me=n=>{ke.push("/basic-data/csr-management"),q.info(`正在跳转到 CSR 条款维护空间，查看条款：${n.csrClauseDesc}`)},He=n=>{x.customerName=n},We=n=>{C.value=n,X.value=!0},Xe=n=>{q.info(`编辑追溯链路 [${n.productName}] 功能开发中...`)},pe=()=>{z.value=!0,setTimeout(()=>{z.value=!1,F.total=oe.value.length},300)};return nt(()=>{pe()}),(n,e)=>{const o=d("a-button"),M=d("a-menu-item"),E=d("a-menu"),Ze=d("a-dropdown"),P=d("a-space"),V=d("a-input"),p=d("a-form-item"),U=d("a-select-option"),L=d("a-select"),K=d("a-form"),Z=d("a-card"),h=d("a-tag"),j=d("a-divider"),J=d("a-table"),Y=d("a-tab-pane"),Je=d("a-alert"),Ye=d("a-tooltip"),T=d("a-step"),fe=d("a-steps"),et=d("a-tabs"),A=d("a-col"),ee=d("a-row"),ve=d("a-radio"),tt=d("a-radio-group"),at=d("a-textarea"),te=d("a-modal"),_=d("a-descriptions-item"),ye=d("a-descriptions");return u(),N("div",pt,[D("div",ft,[t(P,null,{default:a(()=>[t(o,{type:"primary",onClick:ze},{icon:a(()=>[t($(st))]),default:a(()=>[e[20]||(e[20]=s("新增映射 ",-1))]),_:1}),t(o,{disabled:b.value.length!==1,onClick:Qe},{icon:a(()=>[t($(rt))]),default:a(()=>[e[21]||(e[21]=s("编辑 ",-1))]),_:1},8,["disabled"]),t(o,{danger:"",disabled:b.value.length===0,onClick:Be},{icon:a(()=>[t($(ot))]),default:a(()=>[e[22]||(e[22]=s("删除 ",-1))]),_:1},8,["disabled"]),t(Ze,{disabled:b.value.length===0},{overlay:a(()=>[t(E,{onClick:Ee},{default:a(()=>[t(M,{key:"enable"},{default:a(()=>[...e[24]||(e[24]=[s("批量启用",-1)])]),_:1}),t(M,{key:"disable"},{default:a(()=>[...e[25]||(e[25]=[s("批量禁用",-1)])]),_:1})]),_:1})]),default:a(()=>[t(o,null,{default:a(()=>[e[23]||(e[23]=s("状态操作 ",-1)),t($(it))]),_:1})]),_:1},8,["disabled"]),t(o,{onClick:pe},{icon:a(()=>[t($(dt))]),default:a(()=>[e[26]||(e[26]=s("刷新 ",-1))]),_:1})]),_:1})]),t(et,{activeKey:ne.value,"onUpdate:activeKey":e[8]||(e[8]=l=>ne.value=l),type:"card",class:"mapping-tabs"},{default:a(()=>[t(Y,{key:"materialMapping",tab:"物料编码映射"},{default:a(()=>[t(Z,{class:"search-card",bordered:!1},{default:a(()=>[t(K,{layout:"inline",model:m},{default:a(()=>[t(p,{label:"客户/供应商"},{default:a(()=>[t(V,{value:m.partnerName,"onUpdate:value":e[0]||(e[0]=l=>m.partnerName=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,{label:"外部物料编码"},{default:a(()=>[t(V,{value:m.externalCode,"onUpdate:value":e[1]||(e[1]=l=>m.externalCode=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,{label:"内部物料编码"},{default:a(()=>[t(V,{value:m.internalCode,"onUpdate:value":e[2]||(e[2]=l=>m.internalCode=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,{label:"状态"},{default:a(()=>[t(L,{value:m.status,"onUpdate:value":e[3]||(e[3]=l=>m.status=l),style:{width:"100px"},placeholder:"全部","allow-clear":""},{default:a(()=>[t(U,{value:"1"},{default:a(()=>[...e[27]||(e[27]=[s("启用",-1)])]),_:1}),t(U,{value:"0"},{default:a(()=>[...e[28]||(e[28]=[s("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(p,null,{default:a(()=>[t(o,{type:"primary",onClick:De},{default:a(()=>[...e[29]||(e[29]=[s("查询",-1)])]),_:1}),t(o,{style:{"margin-left":"8px"},onClick:qe},{default:a(()=>[...e[30]||(e[30]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),D("div",vt,[t(J,{columns:ge,"data-source":oe.value,loading:z.value,"row-key":"id",size:"middle","row-selection":{selectedRowKeys:b.value,onChange:he},pagination:F,onChange:$e},{bodyCell:a(({column:l,record:r})=>[l.key==="direction"?(u(),k(h,{key:0,color:r.direction==="customer"?"blue":"green"},{default:a(()=>[s(i(r.direction==="customer"?"客户":"供应商"),1)]),_:2},1032,["color"])):y("",!0),l.key==="status"?(u(),k(h,{key:1,color:r.status==="1"?"green":"red"},{default:a(()=>[s(i(r.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):y("",!0),l.key==="action"?(u(),k(P,{key:2},{default:a(()=>[t(o,{type:"link",size:"small",onClick:S=>ue(r)},{default:a(()=>[...e[31]||(e[31]=[s("编辑",-1)])]),_:1},8,["onClick"]),t(j,{type:"vertical"}),t(o,{type:"link",size:"small",onClick:S=>Fe(r)},{default:a(()=>[...e[32]||(e[32]=[s("查看",-1)])]),_:1},8,["onClick"]),t(j,{type:"vertical"}),t(o,{type:"link",danger:"",size:"small",onClick:S=>je(r)},{default:a(()=>[...e[33]||(e[33]=[s("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)):y("",!0)]),_:1},8,["data-source","loading","row-selection","pagination"])])]),_:1}),t(Y,{key:"ctqMapping",tab:"CTQ标准协同"},{default:a(()=>[ie.value.length>0?(u(),k(Je,{key:0,type:"warning","show-icon":"",closable:"",style:{"margin-bottom":"16px"}},{message:a(()=>[...e[34]||(e[34]=[D("span",null,"CSR 协议版本变更提醒",-1)])]),description:a(()=>[(u(!0),N(R,null,ae(ie.value,(l,r)=>(u(),N("div",{key:r,style:{"margin-bottom":"4px"}},[e[35]||(e[35]=s(" ⚠️ 客户 ",-1)),D("b",null,i(l.customerName),1),e[36]||(e[36]=s(" 的 CSR 协议已从 ",-1)),t(h,{color:"red"},{default:a(()=>[s(i(l.oldVersion),1)]),_:2},1024),e[37]||(e[37]=s(" 更新至 ",-1)),t(h,{color:"green"},{default:a(()=>[s(i(l.newVersion),1)]),_:2},1024),e[38]||(e[38]=s("， 请核对并同步更新以下 CTQ 参数阈值： ",-1)),D("a",{onClick:S=>He(l.customerName),style:{"margin-left":"4px"}},"查看受影响的 CTQ →",8,yt)]))),128))]),_:1})):y("",!0),t(Z,{class:"search-card",bordered:!1},{default:a(()=>[t(K,{layout:"inline",model:x},{default:a(()=>[t(p,{label:"客户名称"},{default:a(()=>[t(V,{value:x.customerName,"onUpdate:value":e[4]||(e[4]=l=>x.customerName=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,{label:"CTQ特性名称"},{default:a(()=>[t(V,{value:x.ctqName,"onUpdate:value":e[5]||(e[5]=l=>x.ctqName=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,null,{default:a(()=>[t(o,{type:"primary",onClick:Oe},{default:a(()=>[...e[39]||(e[39]=[s("查询",-1)])]),_:1}),t(o,{style:{"margin-left":"8px"},onClick:Re},{default:a(()=>[...e[40]||(e[40]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),D("div",Ct,[t(J,{columns:xe,"data-source":Se.value,loading:z.value,"row-key":"id",size:"middle",pagination:!1},{bodyCell:a(({column:l,record:r})=>[l.key==="severity"?(u(),k(h,{key:0,color:r.severity==="critical"?"red":r.severity==="major"?"orange":"blue"},{default:a(()=>[s(i(r.severity==="critical"?"关键特性(CC)":r.severity==="major"?"重要特性(SC)":"一般特性"),1)]),_:2},1032,["color"])):y("",!0),l.key==="csrSource"?(u(),N(R,{key:1},[r.csrClauseId?(u(),N("a",{key:0,onClick:S=>me(r)},i(r.csrClauseDesc),9,_t)):(u(),N("span",Nt,"未关联"))],64)):y("",!0),l.key==="csrVersion"?(u(),N(R,{key:2},[r.csrVersion?(u(),N(R,{key:0},[t(h,{color:r.csrVersionOutdated?"red":"green"},{default:a(()=>[s(i(r.csrVersion),1)]),_:2},1032,["color"]),r.csrVersionOutdated?(u(),k(Ye,{key:0,title:"CSR 协议版本已更新，请核查本项参数"},{default:a(()=>[t($(ut),{style:{color:"#ff4d4f","margin-left":"4px"}})]),_:1})):y("",!0)],64)):(u(),N("span",kt,"—"))],64)):y("",!0),l.key==="syncStatus"?(u(),k(h,{key:3,color:r.syncStatus==="synced"?"green":"orange"},{default:a(()=>[s(i(r.syncStatus==="synced"?"已同步":"待同步"),1)]),_:2},1032,["color"])):y("",!0),l.key==="action"?(u(),k(P,{key:4},{default:a(()=>[t(o,{type:"link",size:"small",onClick:S=>Ke(r)},{default:a(()=>[s(i(r.syncStatus==="synced"?"重新同步":"同步至检验项"),1)]),_:2},1032,["onClick"]),t(j,{type:"vertical"}),t(o,{type:"link",size:"small",onClick:S=>Ge(r)},{default:a(()=>[...e[41]||(e[41]=[s("查看",-1)])]),_:1},8,["onClick"])]),_:2},1024)):y("",!0)]),_:1},8,["data-source","loading"])])]),_:1}),t(Y,{key:"traceMapping",tab:"追溯关系配置"},{default:a(()=>[t(Z,{class:"search-card",bordered:!1},{default:a(()=>[t(K,{layout:"inline",model:I},{default:a(()=>[t(p,{label:"成品物料"},{default:a(()=>[t(V,{value:I.productName,"onUpdate:value":e[6]||(e[6]=l=>I.productName=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,{label:"客户名称"},{default:a(()=>[t(V,{value:I.customerName,"onUpdate:value":e[7]||(e[7]=l=>I.customerName=l),placeholder:"请输入","allow-clear":"",style:{width:"160px"}},null,8,["value"])]),_:1}),t(p,null,{default:a(()=>[t(o,{type:"primary",onClick:Ue},{default:a(()=>[...e[42]||(e[42]=[s("查询",-1)])]),_:1}),t(o,{style:{"margin-left":"8px"},onClick:Ae},{default:a(()=>[...e[43]||(e[43]=[s("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),D("div",bt,[t(J,{columns:Me,"data-source":Te.value,loading:z.value,"row-key":"id",size:"middle",pagination:!1},{bodyCell:a(({column:l,record:r})=>[l.key==="traceLink"?(u(),k(fe,{key:0,current:4,size:"small",style:{"max-width":"500px"}},{default:a(()=>[t(T,{title:r.supplierName,description:"供应商"},null,8,["title"]),t(T,{title:r.rawMaterial,description:"原材料"},null,8,["title"]),t(T,{title:r.processName,description:"生产工序"},null,8,["title"]),t(T,{title:r.productCode,description:"成品"},null,8,["title"]),t(T,{title:r.customerName,description:"客户"},null,8,["title"])]),_:2},1024)):y("",!0),l.key==="action"?(u(),k(P,{key:1},{default:a(()=>[t(o,{type:"link",size:"small",onClick:S=>We(r)},{default:a(()=>[...e[44]||(e[44]=[s("查看链路",-1)])]),_:1},8,["onClick"]),t(j,{type:"vertical"}),t(o,{type:"link",size:"small",onClick:S=>Xe(r)},{default:a(()=>[...e[45]||(e[45]=[s("编辑",-1)])]),_:1},8,["onClick"])]),_:2},1024)):y("",!0)]),_:1},8,["data-source","loading"])])]),_:1})]),_:1},8,["activeKey"]),t(te,{open:O.value,"onUpdate:open":e[16]||(e[16]=l=>O.value=l),title:Ve.value,width:"700px",onOk:Pe,onCancel:Le,footer:g.value?null:void 0},{default:a(()=>[t(K,{ref_key:"formRef",ref:H,model:c,rules:be,layout:"vertical"},{default:a(()=>[t(ee,{gutter:16},{default:a(()=>[t(A,{span:12},{default:a(()=>[t(p,{label:"映射方向",name:"direction"},{default:a(()=>[t(L,{value:c.direction,"onUpdate:value":e[9]||(e[9]=l=>c.direction=l),placeholder:"请选择",disabled:g.value},{default:a(()=>[t(U,{value:"customer"},{default:a(()=>[...e[46]||(e[46]=[s("客户方向",-1)])]),_:1}),t(U,{value:"supplier"},{default:a(()=>[...e[47]||(e[47]=[s("供应商方向",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(A,{span:12},{default:a(()=>[t(p,{label:"客户/供应商",name:"partnerId"},{default:a(()=>[t(L,{value:c.partnerId,"onUpdate:value":e[10]||(e[10]=l=>c.partnerId=l),placeholder:"请选择",disabled:g.value,"show-search":"","filter-option":de},{default:a(()=>[(u(!0),N(R,null,ae(se.value,l=>(u(),k(U,{key:l.id,value:l.id},{default:a(()=>[s(i(l.name)+" ("+i(l.code)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1}),t(ee,{gutter:16},{default:a(()=>[t(A,{span:12},{default:a(()=>[t(p,{label:"外部物料编码",name:"externalCode"},{default:a(()=>[t(V,{value:c.externalCode,"onUpdate:value":e[11]||(e[11]=l=>c.externalCode=l),placeholder:"对方系统中的物料编码",disabled:g.value},null,8,["value","disabled"])]),_:1})]),_:1}),t(A,{span:12},{default:a(()=>[t(p,{label:"外部物料名称",name:"externalName"},{default:a(()=>[t(V,{value:c.externalName,"onUpdate:value":e[12]||(e[12]=l=>c.externalName=l),placeholder:"对方系统中的物料名称",disabled:g.value},null,8,["value","disabled"])]),_:1})]),_:1})]),_:1}),t(ee,{gutter:16},{default:a(()=>[t(A,{span:12},{default:a(()=>[t(p,{label:"内部标准物料",name:"internalMaterialId"},{default:a(()=>[t(L,{value:c.internalMaterialId,"onUpdate:value":e[13]||(e[13]=l=>c.internalMaterialId=l),placeholder:"请选择本系统物料",disabled:g.value,"show-search":"","filter-option":de},{default:a(()=>[(u(!0),N(R,null,ae(re.value,l=>(u(),k(U,{key:l.id,value:l.id},{default:a(()=>[s(i(l.name)+" ("+i(l.code)+") ",1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])]),_:1})]),_:1}),t(A,{span:12},{default:a(()=>[t(p,{label:"状态",name:"status"},{default:a(()=>[t(tt,{value:c.status,"onUpdate:value":e[14]||(e[14]=l=>c.status=l),disabled:g.value},{default:a(()=>[t(ve,{value:"1"},{default:a(()=>[...e[48]||(e[48]=[s("启用",-1)])]),_:1}),t(ve,{value:"0"},{default:a(()=>[...e[49]||(e[49]=[s("禁用",-1)])]),_:1})]),_:1},8,["value","disabled"])]),_:1})]),_:1})]),_:1}),t(p,{label:"备注",name:"remark"},{default:a(()=>[t(at,{value:c.remark,"onUpdate:value":e[15]||(e[15]=l=>c.remark=l),placeholder:"请输入备注",rows:2,disabled:g.value},null,8,["value","disabled"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","footer"]),t(te,{open:W.value,"onUpdate:open":e[18]||(e[18]=l=>W.value=l),title:"CTQ特性详情",width:"700px",footer:null},{default:a(()=>[v.value?(u(),k(ye,{key:0,column:2,bordered:""},{default:a(()=>[t(_,{label:"客户名称"},{default:a(()=>[s(i(v.value.customerName),1)]),_:1}),t(_,{label:"CTQ特性名称"},{default:a(()=>[s(i(v.value.ctqName),1)]),_:1}),t(_,{label:"严重等级"},{default:a(()=>[s(i(v.value.severity==="critical"?"关键特性(CC)":v.value.severity==="major"?"重要特性(SC)":"一般特性"),1)]),_:1}),t(_,{label:"同步状态"},{default:a(()=>[s(i(v.value.syncStatus==="synced"?"已同步":"待同步"),1)]),_:1}),t(_,{label:"关联物料"},{default:a(()=>[s(i(v.value.materialName),1)]),_:1}),t(_,{label:"关联检验项"},{default:a(()=>[s(i(v.value.inspItemName||"未关联"),1)]),_:1}),t(_,{label:"标准要求",span:2},{default:a(()=>[s(i(v.value.standardDesc),1)]),_:1}),t(_,{label:"来源 CSR",span:2},{default:a(()=>[v.value.csrClauseId?(u(),N(R,{key:0},[D("a",{onClick:e[17]||(e[17]=l=>me(v.value))},i(v.value.csrClauseDesc),1),t(h,{color:v.value.csrVersionOutdated?"red":"green",style:{"margin-left":"8px"}},{default:a(()=>[s(i(v.value.csrVersion),1)]),_:1},8,["color"]),v.value.csrVersionOutdated?(u(),N("span",gt,"⚠ 版本已更新，请校验")):y("",!0)],64)):(u(),N("span",wt,"未关联 CSR 条款"))]),_:1})]),_:1})):y("",!0)]),_:1},8,["open"]),t(te,{open:X.value,"onUpdate:open":e[19]||(e[19]=l=>X.value=l),title:"追溯链路详情",width:"800px",footer:null},{default:a(()=>[C.value?(u(),k(ye,{key:0,column:2,bordered:""},{default:a(()=>[t(_,{label:"成品编码"},{default:a(()=>[s(i(C.value.productCode),1)]),_:1}),t(_,{label:"成品名称"},{default:a(()=>[s(i(C.value.productName),1)]),_:1}),t(_,{label:"客户"},{default:a(()=>[s(i(C.value.customerName),1)]),_:1}),t(_,{label:"生产工序"},{default:a(()=>[s(i(C.value.processName),1)]),_:1}),t(_,{label:"原材料"},{default:a(()=>[s(i(C.value.rawMaterial),1)]),_:1}),t(_,{label:"供应商"},{default:a(()=>[s(i(C.value.supplierName),1)]),_:1})]),_:1})):y("",!0),t(j,null,{default:a(()=>[...e[50]||(e[50]=[s("追溯链路可视化",-1)])]),_:1}),t(fe,{current:4,size:"small",direction:"vertical"},{default:a(()=>{var l,r,S,Ce,_e,Ne;return[t(T,{title:"客户",description:(l=C.value)==null?void 0:l.customerName,status:"finish"},null,8,["description"]),t(T,{title:"成品",description:`${(r=C.value)==null?void 0:r.productCode} - ${(S=C.value)==null?void 0:S.productName}`,status:"finish"},null,8,["description"]),t(T,{title:"生产工序",description:(Ce=C.value)==null?void 0:Ce.processName,status:"finish"},null,8,["description"]),t(T,{title:"原材料",description:(_e=C.value)==null?void 0:_e.rawMaterial,status:"finish"},null,8,["description"]),t(T,{title:"供应商",description:(Ne=C.value)==null?void 0:Ne.supplierName,status:"finish"},null,8,["description"])]}),_:1})]),_:1},8,["open"])])}}}),Tt=mt(xt,[["__scopeId","data-v-65485efd"]]);export{Tt as default};
