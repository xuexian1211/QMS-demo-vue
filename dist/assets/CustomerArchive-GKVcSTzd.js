import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as x,a as q,k as _e,m as ye,c as Ce,o as k,e as B,x as t,q as a,h as n,y as L,P as W,s as i,S as ge,p as y,f as C,t as v,G as we,H as xe,I as Y,C as E}from"./index-D0CfuKge.js";const Le={class:"customer-archive"},he={class:"page-header"},Ue={class:"search-form"},Ne={class:"table-container"},Pe={__name:"CustomerArchive",setup(Ae){const z=x(!1),h=x(!1),D=x(!1),A=x(!1),M=x(),s=q({customerCode:"",customerName:"",customerLevel:void 0,contactPerson:"",status:void 0}),u=q({id:"",customerCode:"",customerName:"",customerLevel:"B",creditLevel:3,creditCode:"",legalPerson:"",phone:"",email:"",address:"",bankName:"",bankAccount:"",remark:"",status:"1",contacts:[]}),F=[{title:"姓名",dataIndex:"name",key:"name",width:100},{title:"职位",dataIndex:"position",key:"position",width:100},{title:"电话",dataIndex:"phone",key:"phone",width:120},{title:"邮箱",dataIndex:"email",key:"email",width:150},{title:"主要联系人",dataIndex:"isPrimary",key:"isPrimary",width:100},{title:"操作",key:"action",width:80}],Z=[{title:"客户编码",dataIndex:"customerCode",key:"customerCode",width:120,fixed:"left"},{title:"客户名称",dataIndex:"customerName",key:"customerName",width:150,fixed:"left"},{title:"客户等级",dataIndex:"customerLevel",key:"customerLevel",width:100},{title:"信用等级",dataIndex:"creditLevel",key:"creditLevel",width:120},{title:"联系人",dataIndex:"primaryContact",key:"primaryContact",width:100,customRender:({record:o})=>{var m;const e=(m=o.contacts)==null?void 0:m.find(r=>r.isPrimary);return e?e.name:"未设置"}},{title:"联系电话",dataIndex:"phone",key:"phone",width:120},{title:"邮箱地址",dataIndex:"email",key:"email",width:180},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:200,fixed:"right"}],g=x([{id:"1",customerCode:"CUST001",customerName:"华为技术有限公司",customerLevel:"A",creditLevel:5,creditCode:"91440300708461136T",legalPerson:"任正非",phone:"0755-28780808",email:"contact@huawei.com",address:"广东省深圳市龙岗区坂田华为基地",bankName:"中国工商银行深圳分行",bankAccount:"6222024000012345678",remark:"重要战略客户",status:"1",createTime:"2024-01-15 10:30:00",updateTime:"2024-01-15 10:30:00",contacts:[{name:"张经理",position:"采购经理",phone:"13800138001",email:"zhang@huawei.com",isPrimary:!0},{name:"李工程师",position:"技术总监",phone:"13800138002",email:"li@huawei.com",isPrimary:!1}]},{id:"2",customerCode:"CUST002",customerName:"腾讯科技有限公司",customerLevel:"A",creditLevel:4.5,creditCode:"91440300708461136T",legalPerson:"马化腾",phone:"0755-86013388",email:"contact@tencent.com",address:"广东省深圳市南山区科技园",bankName:"中国建设银行深圳分行",bankAccount:"6227007200012345678",remark:"长期合作客户",status:"1",createTime:"2024-01-15 10:35:00",updateTime:"2024-01-15 10:35:00",contacts:[{name:"王总",position:"采购总监",phone:"13800138003",email:"wang@tencent.com",isPrimary:!0},{name:"刘经理",position:"项目经理",phone:"13800138004",email:"liu@tencent.com",isPrimary:!1}]},{id:"3",customerCode:"CUST003",customerName:"阿里巴巴集团",customerLevel:"A",creditLevel:4.5,creditCode:"91330100MA2802X12X",legalPerson:"张勇",phone:"0571-85022088",email:"contact@alibaba.com",address:"浙江省杭州市余杭区文一西路969号",bankName:"中国工商银行杭州分行",bankAccount:"6222021200012345678",remark:"电商领域重要客户",status:"1",createTime:"2024-01-15 10:40:00",updateTime:"2024-01-15 10:40:00",contacts:[{name:"陈总",position:"供应链总监",phone:"13800138005",email:"chen@alibaba.com",isPrimary:!0},{name:"赵经理",position:"采购经理",phone:"13800138006",email:"zhao@alibaba.com",isPrimary:!1}]}]),U=q({current:1,pageSize:10,total:3,showSizeChanger:!0,showQuickJumper:!0,showTotal:(o,e)=>`第 ${e[0]}-${e[1]} 条，共 ${o} 条`}),p=x({}),ee={customerCode:[{required:!0,message:"请输入客户编码",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户名称",trigger:"blur"}],customerLevel:[{required:!0,message:"请选择客户等级",trigger:"change"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},j=o=>({A:"A级客户",B:"B级客户",C:"C级客户"})[o]||"未知",R=o=>({A:"red",B:"orange",C:"blue"})[o]||"default",te=_e(()=>A.value?"编辑客户档案":"新增客户档案"),X=()=>{U.current=1,N()},ae=()=>{Object.assign(s,{customerCode:"",customerName:"",customerLevel:void 0,contactPerson:"",status:void 0}),X()},le=(o,e,m)=>{U.current=o.current,U.pageSize=o.pageSize,N()},oe=()=>{A.value=!1,h.value=!0,G()},ne=o=>{A.value=!0,h.value=!0,Object.assign(u,{...o,contacts:[...o.contacts||[]]})},ue=o=>{p.value=o,D.value=!0},se=o=>{const e=g.value.findIndex(m=>m.id===o);e>-1&&(g.value.splice(e,1),E.success("删除成功"),N())},de=()=>{const o={name:"",position:"",phone:"",email:"",isPrimary:!1};u.contacts.push(o)},ie=o=>{u.contacts.splice(o,1)},re=async()=>{try{if(await M.value.validate(),A.value){const o=g.value.findIndex(e=>e.id===u.id);o>-1&&(g.value[o]={...u,updateTime:new Date().toLocaleString()},E.success("更新成功"))}else{const o=(Math.max(...g.value.map(m=>parseInt(m.id)))+1).toString(),e={...u,id:o,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};g.value.push(e),E.success("新增成功")}h.value=!1,N()}catch(o){console.error("表单验证失败:",o)}},me=()=>{h.value=!1,G()},G=()=>{var o;Object.assign(u,{id:"",customerCode:"",customerName:"",customerLevel:"B",creditLevel:3,creditCode:"",legalPerson:"",phone:"",email:"",address:"",bankName:"",bankAccount:"",remark:"",status:"1",contacts:[]}),(o=M.value)==null||o.resetFields()},N=()=>{z.value=!0,setTimeout(()=>{let o=[...g.value];s.customerCode&&(o=o.filter(e=>e.customerCode.includes(s.customerCode))),s.customerName&&(o=o.filter(e=>e.customerName.includes(s.customerName))),s.customerLevel&&(o=o.filter(e=>e.customerLevel===s.customerLevel)),s.contactPerson&&(o=o.filter(e=>{var r;const m=(r=e.contacts)==null?void 0:r.find(d=>d.isPrimary);return m&&m.name.includes(s.contactPerson)})),s.status!==void 0&&(o=o.filter(e=>e.status===s.status)),U.total=o.length,z.value=!1},500)};return ye(()=>{N()}),(o,e)=>{const m=i("a-button"),r=i("a-input"),d=i("a-form-item"),w=i("a-select-option"),O=i("a-select"),H=i("a-form"),T=i("a-tag"),$=i("a-rate"),ce=i("a-popconfirm"),pe=i("a-space"),V=i("a-table"),b=i("a-col"),P=i("a-row"),J=i("a-radio"),ve=i("a-radio-group"),I=i("a-divider"),Q=i("a-textarea"),fe=i("a-checkbox"),K=i("a-modal"),f=i("a-descriptions-item"),be=i("a-descriptions");return k(),Ce("div",Le,[B("div",he,[e[21]||(e[21]=B("h2",null,"客户档案管理",-1)),t(m,{type:"primary",onClick:oe},{icon:a(()=>[t(L(W))]),default:a(()=>[e[20]||(e[20]=n(" 新增客户 ",-1))]),_:1})]),B("div",Ue,[t(H,{layout:"inline",model:s,onFinish:X},{default:a(()=>[t(d,{label:"客户编码"},{default:a(()=>[t(r,{value:s.customerCode,"onUpdate:value":e[0]||(e[0]=l=>s.customerCode=l),placeholder:"请输入客户编码","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(d,{label:"客户名称"},{default:a(()=>[t(r,{value:s.customerName,"onUpdate:value":e[1]||(e[1]=l=>s.customerName=l),placeholder:"请输入客户名称","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(d,{label:"客户等级"},{default:a(()=>[t(O,{value:s.customerLevel,"onUpdate:value":e[2]||(e[2]=l=>s.customerLevel=l),placeholder:"请选择客户等级","allow-clear":"",style:{width:"150px"}},{default:a(()=>[t(w,{value:"A"},{default:a(()=>[...e[22]||(e[22]=[n("A级客户",-1)])]),_:1}),t(w,{value:"B"},{default:a(()=>[...e[23]||(e[23]=[n("B级客户",-1)])]),_:1}),t(w,{value:"C"},{default:a(()=>[...e[24]||(e[24]=[n("C级客户",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(d,{label:"联系人"},{default:a(()=>[t(r,{value:s.contactPerson,"onUpdate:value":e[3]||(e[3]=l=>s.contactPerson=l),placeholder:"请输入联系人","allow-clear":"",style:{width:"150px"}},null,8,["value"])]),_:1}),t(d,{label:"状态"},{default:a(()=>[t(O,{value:s.status,"onUpdate:value":e[4]||(e[4]=l=>s.status=l),placeholder:"请选择状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[t(w,{value:"1"},{default:a(()=>[...e[25]||(e[25]=[n("启用",-1)])]),_:1}),t(w,{value:"0"},{default:a(()=>[...e[26]||(e[26]=[n("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(d,null,{default:a(()=>[t(m,{type:"primary","html-type":"submit"},{icon:a(()=>[t(L(ge))]),default:a(()=>[e[27]||(e[27]=n(" 搜索 ",-1))]),_:1}),t(m,{style:{"margin-left":"8px"},onClick:ae},{default:a(()=>[...e[28]||(e[28]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),B("div",Ne,[t(V,{columns:Z,"data-source":g.value,loading:z.value,pagination:U,"row-key":"id",onChange:le},{bodyCell:a(({column:l,record:c})=>[l.key==="customerLevel"?(k(),y(T,{key:0,color:R(c.customerLevel)},{default:a(()=>[n(v(j(c.customerLevel)),1)]),_:2},1032,["color"])):C("",!0),l.key==="creditLevel"?(k(),y($,{key:1,value:c.creditLevel,disabled:"","allow-half":""},null,8,["value"])):C("",!0),l.key==="status"?(k(),y(T,{key:2,color:c.status==="1"?"green":"red"},{default:a(()=>[n(v(c.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):C("",!0),l.key==="action"?(k(),y(pe,{key:3},{default:a(()=>[t(m,{type:"link",size:"small",onClick:S=>ne(c)},{icon:a(()=>[t(L(we))]),default:a(()=>[e[29]||(e[29]=n(" 编辑 ",-1))]),_:1},8,["onClick"]),t(m,{type:"link",size:"small",onClick:S=>ue(c)},{icon:a(()=>[t(L(xe))]),default:a(()=>[e[30]||(e[30]=n(" 查看 ",-1))]),_:1},8,["onClick"]),t(ce,{title:"确定要删除这个客户档案吗？",onConfirm:S=>se(c.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[t(m,{type:"link",size:"small",danger:""},{icon:a(()=>[t(L(Y))]),default:a(()=>[e[31]||(e[31]=n(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):C("",!0)]),_:1},8,["data-source","loading","pagination"])]),t(K,{visible:h.value,"onUpdate:visible":e[18]||(e[18]=l=>h.value=l),title:te.value,width:"1000px",onOk:re,onCancel:me},{default:a(()=>[t(H,{ref_key:"formRef",ref:M,model:u,rules:ee,layout:"vertical"},{default:a(()=>[t(P,{gutter:16},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(d,{label:"客户编码",name:"customerCode"},{default:a(()=>[t(r,{value:u.customerCode,"onUpdate:value":e[5]||(e[5]=l=>u.customerCode=l),placeholder:"请输入客户编码"},null,8,["value"])]),_:1})]),_:1}),t(b,{span:12},{default:a(()=>[t(d,{label:"客户名称",name:"customerName"},{default:a(()=>[t(r,{value:u.customerName,"onUpdate:value":e[6]||(e[6]=l=>u.customerName=l),placeholder:"请输入客户名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(P,{gutter:16},{default:a(()=>[t(b,{span:8},{default:a(()=>[t(d,{label:"客户等级",name:"customerLevel"},{default:a(()=>[t(O,{value:u.customerLevel,"onUpdate:value":e[7]||(e[7]=l=>u.customerLevel=l),placeholder:"请选择客户等级"},{default:a(()=>[t(w,{value:"A"},{default:a(()=>[...e[32]||(e[32]=[n("A级客户",-1)])]),_:1}),t(w,{value:"B"},{default:a(()=>[...e[33]||(e[33]=[n("B级客户",-1)])]),_:1}),t(w,{value:"C"},{default:a(()=>[...e[34]||(e[34]=[n("C级客户",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),t(b,{span:8},{default:a(()=>[t(d,{label:"信用等级",name:"creditLevel"},{default:a(()=>[t($,{value:u.creditLevel,"onUpdate:value":e[8]||(e[8]=l=>u.creditLevel=l),"allow-half":""},null,8,["value"])]),_:1})]),_:1}),t(b,{span:8},{default:a(()=>[t(d,{label:"状态",name:"status"},{default:a(()=>[t(ve,{value:u.status,"onUpdate:value":e[9]||(e[9]=l=>u.status=l)},{default:a(()=>[t(J,{value:"1"},{default:a(()=>[...e[35]||(e[35]=[n("启用",-1)])]),_:1}),t(J,{value:"0"},{default:a(()=>[...e[36]||(e[36]=[n("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(I,null,{default:a(()=>[...e[37]||(e[37]=[n("基本信息",-1)])]),_:1}),t(P,{gutter:16},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(d,{label:"统一社会信用代码",name:"creditCode"},{default:a(()=>[t(r,{value:u.creditCode,"onUpdate:value":e[10]||(e[10]=l=>u.creditCode=l),placeholder:"请输入统一社会信用代码"},null,8,["value"])]),_:1})]),_:1}),t(b,{span:12},{default:a(()=>[t(d,{label:"法定代表人",name:"legalPerson"},{default:a(()=>[t(r,{value:u.legalPerson,"onUpdate:value":e[11]||(e[11]=l=>u.legalPerson=l),placeholder:"请输入法定代表人"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(P,{gutter:16},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(d,{label:"联系电话",name:"phone"},{default:a(()=>[t(r,{value:u.phone,"onUpdate:value":e[12]||(e[12]=l=>u.phone=l),placeholder:"请输入联系电话"},null,8,["value"])]),_:1})]),_:1}),t(b,{span:12},{default:a(()=>[t(d,{label:"邮箱地址",name:"email"},{default:a(()=>[t(r,{value:u.email,"onUpdate:value":e[13]||(e[13]=l=>u.email=l),placeholder:"请输入邮箱地址"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(d,{label:"详细地址",name:"address"},{default:a(()=>[t(Q,{value:u.address,"onUpdate:value":e[14]||(e[14]=l=>u.address=l),placeholder:"请输入详细地址",rows:2},null,8,["value"])]),_:1}),t(I,null,{default:a(()=>[...e[38]||(e[38]=[n("联系人信息",-1)])]),_:1}),t(d,{label:"联系人列表"},{default:a(()=>[t(V,{columns:F,"data-source":u.contacts,pagination:!1,size:"small"},{bodyCell:a(({column:l,record:c,index:S})=>[l.key==="name"?(k(),y(r,{key:0,value:c.name,"onUpdate:value":_=>c.name=_,placeholder:"姓名"},null,8,["value","onUpdate:value"])):C("",!0),l.key==="position"?(k(),y(r,{key:1,value:c.position,"onUpdate:value":_=>c.position=_,placeholder:"职位"},null,8,["value","onUpdate:value"])):C("",!0),l.key==="phone"?(k(),y(r,{key:2,value:c.phone,"onUpdate:value":_=>c.phone=_,placeholder:"电话"},null,8,["value","onUpdate:value"])):C("",!0),l.key==="email"?(k(),y(r,{key:3,value:c.email,"onUpdate:value":_=>c.email=_,placeholder:"邮箱"},null,8,["value","onUpdate:value"])):C("",!0),l.key==="isPrimary"?(k(),y(fe,{key:4,checked:c.isPrimary,"onUpdate:checked":_=>c.isPrimary=_},{default:a(()=>[...e[39]||(e[39]=[n("主要联系人",-1)])]),_:1},8,["checked","onUpdate:checked"])):C("",!0),l.key==="action"?(k(),y(m,{key:5,type:"link",size:"small",danger:"",onClick:_=>ie(S)},{icon:a(()=>[t(L(Y))]),default:a(()=>[e[40]||(e[40]=n(" 删除 ",-1))]),_:1},8,["onClick"])):C("",!0)]),footer:a(()=>[t(m,{type:"dashed",onClick:de,block:""},{icon:a(()=>[t(L(W))]),default:a(()=>[e[41]||(e[41]=n(" 添加联系人 ",-1))]),_:1})]),_:1},8,["data-source"])]),_:1}),t(I,null,{default:a(()=>[...e[42]||(e[42]=[n("其他信息",-1)])]),_:1}),t(P,{gutter:16},{default:a(()=>[t(b,{span:12},{default:a(()=>[t(d,{label:"开户银行",name:"bankName"},{default:a(()=>[t(r,{value:u.bankName,"onUpdate:value":e[15]||(e[15]=l=>u.bankName=l),placeholder:"请输入开户银行"},null,8,["value"])]),_:1})]),_:1}),t(b,{span:12},{default:a(()=>[t(d,{label:"银行账号",name:"bankAccount"},{default:a(()=>[t(r,{value:u.bankAccount,"onUpdate:value":e[16]||(e[16]=l=>u.bankAccount=l),placeholder:"请输入银行账号"},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(d,{label:"备注",name:"remark"},{default:a(()=>[t(Q,{value:u.remark,"onUpdate:value":e[17]||(e[17]=l=>u.remark=l),placeholder:"请输入备注信息",rows:3},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t(K,{visible:D.value,"onUpdate:visible":e[19]||(e[19]=l=>D.value=l),title:"客户详情",width:"900px",footer:null},{default:a(()=>[t(be,{column:3,bordered:""},{default:a(()=>[t(f,{label:"客户编码"},{default:a(()=>[n(v(p.value.customerCode),1)]),_:1}),t(f,{label:"客户名称"},{default:a(()=>[n(v(p.value.customerName),1)]),_:1}),t(f,{label:"客户等级"},{default:a(()=>[t(T,{color:R(p.value.customerLevel)},{default:a(()=>[n(v(j(p.value.customerLevel)),1)]),_:1},8,["color"])]),_:1}),t(f,{label:"信用等级"},{default:a(()=>[t($,{value:p.value.creditLevel,disabled:"","allow-half":""},null,8,["value"])]),_:1}),t(f,{label:"统一社会信用代码"},{default:a(()=>[n(v(p.value.creditCode),1)]),_:1}),t(f,{label:"法定代表人"},{default:a(()=>[n(v(p.value.legalPerson),1)]),_:1}),t(f,{label:"联系电话"},{default:a(()=>[n(v(p.value.phone),1)]),_:1}),t(f,{label:"邮箱地址"},{default:a(()=>[n(v(p.value.email),1)]),_:1}),t(f,{label:"状态"},{default:a(()=>[t(T,{color:p.value.status==="1"?"green":"red"},{default:a(()=>[n(v(p.value.status==="1"?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),t(f,{label:"详细地址",span:3},{default:a(()=>[n(v(p.value.address),1)]),_:1}),t(f,{label:"开户银行"},{default:a(()=>[n(v(p.value.bankName),1)]),_:1}),t(f,{label:"银行账号"},{default:a(()=>[n(v(p.value.bankAccount),1)]),_:1}),t(f,{label:"创建时间"},{default:a(()=>[n(v(p.value.createTime),1)]),_:1}),t(f,{label:"备注",span:3},{default:a(()=>[n(v(p.value.remark||"无"),1)]),_:1})]),_:1}),t(I,null,{default:a(()=>[...e[43]||(e[43]=[n("联系人信息",-1)])]),_:1}),t(V,{columns:F,"data-source":p.value.contacts||[],pagination:!1,size:"small"},null,8,["data-source"])]),_:1},8,["visible"])])}}},Se=ke(Pe,[["__scopeId","data-v-bfcc0ebe"]]);export{Se as default};
