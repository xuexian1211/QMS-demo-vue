import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as g,a as h,k as de,m as ie,c as ue,o as D,e as w,x as t,q as a,h as r,y as k,P as ce,s,S as pe,p as L,f as q,t as m,G as me,H as ve,I as fe,C as E}from"./index-D0CfuKge.js";const ge={class:"material-category"},ye={class:"page-header"},_e={class:"search-form"},be={class:"table-container"},Ce={__name:"MaterialCategory",setup(Ne){const x=g(!1),y=g(!1),T=g(!1),I=g(!1),O=g(),i=h({categoryName:"",categoryCode:"",status:void 0}),n=h({id:"",categoryName:"",categoryCode:"",parentId:void 0,sortOrder:0,description:"",status:"1"}),B=[{title:"分类名称",dataIndex:"categoryName",key:"categoryName",width:150},{title:"分类编码",dataIndex:"categoryCode",key:"categoryCode",width:120},{title:"上级分类",dataIndex:"parentName",key:"parentName",width:120},{title:"排序",dataIndex:"sortOrder",key:"sortOrder",width:80,sorter:!0},{title:"状态",dataIndex:"status",key:"status",width:80},{title:"描述",dataIndex:"description",key:"description",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:150},{title:"操作",key:"action",width:200,fixed:"right"}],v=g([{id:"1",categoryName:"原材料",categoryCode:"RAW_MATERIAL",parentName:"无",parentId:null,sortOrder:1,description:"生产用原材料分类",status:"1",createTime:"2024-01-15 10:30:00",updateTime:"2024-01-15 10:30:00"},{id:"2",categoryName:"金属材料",categoryCode:"METAL",parentName:"原材料",parentId:"1",sortOrder:1,description:"各类金属材料",status:"1",createTime:"2024-01-15 10:35:00",updateTime:"2024-01-15 10:35:00"},{id:"3",categoryName:"非金属材料",categoryCode:"NON_METAL",parentName:"原材料",parentId:"1",sortOrder:2,description:"各类非金属材料",status:"1",createTime:"2024-01-15 10:40:00",updateTime:"2024-01-15 10:40:00"},{id:"4",categoryName:"半成品",categoryCode:"SEMI_FINISHED",parentName:"无",parentId:null,sortOrder:2,description:"生产过程中的半成品",status:"1",createTime:"2024-01-15 10:45:00",updateTime:"2024-01-15 10:45:00"},{id:"5",categoryName:"成品",categoryCode:"FINISHED",parentName:"无",parentId:null,sortOrder:3,description:"最终产品",status:"1",createTime:"2024-01-15 10:50:00",updateTime:"2024-01-15 10:50:00"}]),b=h({current:1,pageSize:10,total:5,showSizeChanger:!0,showQuickJumper:!0,showTotal:(l,e)=>`第 ${e[0]}-${e[1]} 条，共 ${l} 条`}),S=g([{title:"无",value:null,key:"null"},{title:"原材料",value:"1",key:"1",children:[{title:"金属材料",value:"2",key:"2"},{title:"非金属材料",value:"3",key:"3"}]},{title:"半成品",value:"4",key:"4"},{title:"成品",value:"5",key:"5"}]),c=g({}),R={categoryName:[{required:!0,message:"请输入分类名称",trigger:"blur"}],categoryCode:[{required:!0,message:"请输入分类编码",trigger:"blur"},{pattern:/^[A-Z_]+$/,message:"分类编码只能包含大写字母和下划线",trigger:"blur"}],sortOrder:[{required:!0,message:"请输入排序号",trigger:"blur"}]},j=de(()=>I.value?"编辑分类":"新增分类"),U=()=>{b.current=1,C()},H=()=>{Object.assign(i,{categoryName:"",categoryCode:"",status:void 0}),U()},P=(l,e,d)=>{b.current=l.current,b.pageSize=l.pageSize,C()},G=()=>{I.value=!1,y.value=!0,M()},J=l=>{I.value=!0,y.value=!0,Object.assign(n,{...l,parentId:l.parentId})},Q=l=>{c.value=l,T.value=!0},W=l=>{const e=v.value.findIndex(d=>d.id===l);e>-1&&(v.value.splice(e,1),E.success("删除成功"),C())},Z=async()=>{var l,e;try{if(await O.value.validate(),I.value){const d=v.value.findIndex(p=>p.id===n.id);if(d>-1){const p=n.parentId?(l=S.value.find(u=>u.value===n.parentId))==null?void 0:l.title:"无";v.value[d]={...n,parentName:p,updateTime:new Date().toLocaleString()},E.success("更新成功")}}else{const d=(Math.max(...v.value.map(_=>parseInt(_.id)))+1).toString(),p=n.parentId?(e=S.value.find(_=>_.value===n.parentId))==null?void 0:e.title:"无",u={...n,id:d,parentName:p,createTime:new Date().toLocaleString(),updateTime:new Date().toLocaleString()};v.value.push(u),E.success("新增成功")}y.value=!1,C()}catch(d){console.error("表单验证失败:",d)}},K=()=>{y.value=!1,M()},M=()=>{var l;Object.assign(n,{id:"",categoryName:"",categoryCode:"",parentId:void 0,sortOrder:0,description:"",status:"1"}),(l=O.value)==null||l.resetFields()},C=()=>{x.value=!0,setTimeout(()=>{let l=[...v.value];i.categoryName&&(l=l.filter(e=>e.categoryName.includes(i.categoryName))),i.categoryCode&&(l=l.filter(e=>e.categoryCode.includes(i.categoryCode))),i.status!==void 0&&(l=l.filter(e=>e.status===i.status)),b.total=l.length,x.value=!1},500)};return ie(()=>{C()}),(l,e)=>{const d=s("a-button"),p=s("a-input"),u=s("a-form-item"),_=s("a-select-option"),X=s("a-select"),z=s("a-form"),A=s("a-tag"),Y=s("a-popconfirm"),ee=s("a-space"),te=s("a-table"),ae=s("a-tree-select"),le=s("a-input-number"),oe=s("a-textarea"),V=s("a-radio"),ne=s("a-radio-group"),$=s("a-modal"),f=s("a-descriptions-item"),re=s("a-descriptions");return D(),ue("div",ge,[w("div",ye,[e[12]||(e[12]=w("h2",null,"物料分类管理",-1)),t(d,{type:"primary",onClick:G},{icon:a(()=>[t(k(ce))]),default:a(()=>[e[11]||(e[11]=r(" 新增分类 ",-1))]),_:1})]),w("div",_e,[t(z,{layout:"inline",model:i,onFinish:U},{default:a(()=>[t(u,{label:"分类名称"},{default:a(()=>[t(p,{value:i.categoryName,"onUpdate:value":e[0]||(e[0]=o=>i.categoryName=o),placeholder:"请输入分类名称","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(u,{label:"分类编码"},{default:a(()=>[t(p,{value:i.categoryCode,"onUpdate:value":e[1]||(e[1]=o=>i.categoryCode=o),placeholder:"请输入分类编码","allow-clear":"",style:{width:"200px"}},null,8,["value"])]),_:1}),t(u,{label:"状态"},{default:a(()=>[t(X,{value:i.status,"onUpdate:value":e[2]||(e[2]=o=>i.status=o),placeholder:"请选择状态","allow-clear":"",style:{width:"120px"}},{default:a(()=>[t(_,{value:"1"},{default:a(()=>[...e[13]||(e[13]=[r("启用",-1)])]),_:1}),t(_,{value:"0"},{default:a(()=>[...e[14]||(e[14]=[r("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),t(u,null,{default:a(()=>[t(d,{type:"primary","html-type":"submit"},{icon:a(()=>[t(k(pe))]),default:a(()=>[e[15]||(e[15]=r(" 搜索 ",-1))]),_:1}),t(d,{style:{"margin-left":"8px"},onClick:H},{default:a(()=>[...e[16]||(e[16]=[r("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),w("div",be,[t(te,{columns:B,"data-source":v.value,loading:x.value,pagination:b,"row-key":"id",onChange:P},{bodyCell:a(({column:o,record:N})=>[o.key==="status"?(D(),L(A,{key:0,color:N.status==="1"?"green":"red"},{default:a(()=>[r(m(N.status==="1"?"启用":"禁用"),1)]),_:2},1032,["color"])):q("",!0),o.key==="action"?(D(),L(ee,{key:1},{default:a(()=>[t(d,{type:"link",size:"small",onClick:F=>J(N)},{icon:a(()=>[t(k(me))]),default:a(()=>[e[17]||(e[17]=r(" 编辑 ",-1))]),_:1},8,["onClick"]),t(d,{type:"link",size:"small",onClick:F=>Q(N)},{icon:a(()=>[t(k(ve))]),default:a(()=>[e[18]||(e[18]=r(" 查看 ",-1))]),_:1},8,["onClick"]),t(Y,{title:"确定要删除这个分类吗？",onConfirm:F=>W(N.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[t(d,{type:"link",size:"small",danger:""},{icon:a(()=>[t(k(fe))]),default:a(()=>[e[19]||(e[19]=r(" 删除 ",-1))]),_:1})]),_:1},8,["onConfirm"])]),_:2},1024)):q("",!0)]),_:1},8,["data-source","loading","pagination"])]),t($,{visible:y.value,"onUpdate:visible":e[9]||(e[9]=o=>y.value=o),title:j.value,width:"600px",onOk:Z,onCancel:K},{default:a(()=>[t(z,{ref_key:"formRef",ref:O,model:n,rules:R,layout:"vertical"},{default:a(()=>[t(u,{label:"分类名称",name:"categoryName"},{default:a(()=>[t(p,{value:n.categoryName,"onUpdate:value":e[3]||(e[3]=o=>n.categoryName=o),placeholder:"请输入分类名称"},null,8,["value"])]),_:1}),t(u,{label:"分类编码",name:"categoryCode"},{default:a(()=>[t(p,{value:n.categoryCode,"onUpdate:value":e[4]||(e[4]=o=>n.categoryCode=o),placeholder:"请输入分类编码"},null,8,["value"])]),_:1}),t(u,{label:"上级分类",name:"parentId"},{default:a(()=>[t(ae,{value:n.parentId,"onUpdate:value":e[5]||(e[5]=o=>n.parentId=o),"tree-data":S.value,placeholder:"请选择上级分类","allow-clear":"","tree-default-expand-all":""},null,8,["value","tree-data"])]),_:1}),t(u,{label:"排序",name:"sortOrder"},{default:a(()=>[t(le,{value:n.sortOrder,"onUpdate:value":e[6]||(e[6]=o=>n.sortOrder=o),placeholder:"请输入排序号",min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),t(u,{label:"描述",name:"description"},{default:a(()=>[t(oe,{value:n.description,"onUpdate:value":e[7]||(e[7]=o=>n.description=o),placeholder:"请输入分类描述",rows:3},null,8,["value"])]),_:1}),t(u,{label:"状态",name:"status"},{default:a(()=>[t(ne,{value:n.status,"onUpdate:value":e[8]||(e[8]=o=>n.status=o)},{default:a(()=>[t(V,{value:"1"},{default:a(()=>[...e[20]||(e[20]=[r("启用",-1)])]),_:1}),t(V,{value:"0"},{default:a(()=>[...e[21]||(e[21]=[r("禁用",-1)])]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),t($,{visible:T.value,"onUpdate:visible":e[10]||(e[10]=o=>T.value=o),title:"分类详情",width:"600px",footer:null},{default:a(()=>[t(re,{column:2,bordered:""},{default:a(()=>[t(f,{label:"分类名称"},{default:a(()=>[r(m(c.value.categoryName),1)]),_:1}),t(f,{label:"分类编码"},{default:a(()=>[r(m(c.value.categoryCode),1)]),_:1}),t(f,{label:"上级分类"},{default:a(()=>[r(m(c.value.parentName||"无"),1)]),_:1}),t(f,{label:"排序"},{default:a(()=>[r(m(c.value.sortOrder),1)]),_:1}),t(f,{label:"状态"},{default:a(()=>[t(A,{color:c.value.status==="1"?"green":"red"},{default:a(()=>[r(m(c.value.status==="1"?"启用":"禁用"),1)]),_:1},8,["color"])]),_:1}),t(f,{label:"创建时间"},{default:a(()=>[r(m(c.value.createTime),1)]),_:1}),t(f,{label:"更新时间"},{default:a(()=>[r(m(c.value.updateTime),1)]),_:1}),t(f,{label:"描述",span:2},{default:a(()=>[r(m(c.value.description||"无"),1)]),_:1})]),_:1})]),_:1},8,["visible"])])}}},we=se(Ce,[["__scopeId","data-v-078a9c59"]]);export{we as default};
