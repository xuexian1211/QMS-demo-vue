var Te=Object.defineProperty;var De=(r,e,n)=>e in r?Te(r,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[e]=n;var x=(r,e,n)=>De(r,typeof e!="symbol"?e+"":e,n);import{d as ve,r as ie,m as $e,k as le,c as $,e as Q,p as Me,s as oe,F as Qe,t as ce,x as Le,o as C}from"./index-BhbkSrG8.js";import{_ as ze}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ee=`# 舜富 QMS 系统菜单重构方案\r
\r
## 1. 重构背景与设计思路\r
\r
根据《舜富QMS系统完整解决方案》的需求文档，系统涵盖了从基础数据、质量策划（APQP/PPAP）、过程控制、客诉管理、持续改进到体系审核等完整的质量生命周期，共计超过30个核心业务模块。本次菜单重构旨在将这些模块结构化，遵循**从基础到应用**、**从预防到售后**以及**IATF 16949质量体系标准**的业务脉络进行合理归类，确保用户操作层级扁平化、业务闭环清晰。\r
\r
---\r
\r
## 2. 一级与二级菜单结构规划\r
\r
### 1. 首页 / 工作台 (Dashboard)\r
- 个人工作台 (待办任务、检验预警、消息通知)\r
- 质量驾驶舱 (质量大屏看板)\r
\r
### 2. 基础数据 (Basic Data)\r
*对应文档：基础数据与质量主数据_需求文档*\r
- 客户档案\r
- 供应商档案\r
- 客供关系映射\r
- 物料分类\r
- 物料档案\r
- 工艺路线\r
- 生产班组\r
- 地点存储\r
- 计量单位\r
- 顾客特殊要求(CSR)\r
- 模具与工装档案\r
\r
### 3. 质量主数据 (Quality Master Data)\r
*对应文档：基础数据与质量主数据_需求文档、抽样标准及调整规则、计量器具管理、材料管理体系*\r
- 缺陷现象库\r
- 缺陷原因库\r
- 检验项目\r
- 检验方法\r
- 抽样方案\r
- 检验模板\r
- 检验方案\r
- 检验计划模型\r
- 计量器具台账\r
- 追溯条码与标签模板\r
\r
### 4. 质量策划 (Plan)\r
*对应文档：第7章 APQP/PPAP管理模块*\r
- APQP项目管理\r
- FMEA管理\r
- 控制计划\r
- PPAP管理\r
\r
### 5. 质量执行与控制 (Do)\r
*结合供应商、生产及出货阶段的检验与控制*\r
- **5.1 供应商质量管理 (SQM & IQC)**\r
  - 供应商准入与评估\r
  - 供应商PPAP管理\r
  - IQC来料检验\r
  - 进料不良异常处理\r
  - 供应商绩效考核\r
  - 供应商索赔与违约管理\r
- **5.2 生产过程控制 (IPQC)**\r
  - 首件/巡检/末件检验任务\r
  - 压铸工艺参数监控\r
  - 铸件检验与质量档案\r
  - 围堵单管理\r
  - 防错装置验证点检\r
- **5.3 最终检验与出货 (FQC/OQC)**\r
  - FQC终检任务\r
  - OQC出货检验\r
  - 不合格品报废申请与审理\r
  - 让步接收(特采)单\r
  - 返工/返修单管理\r
- **5.4 实验室管理 (Lab)**\r
  - 实验室送检任务\r
  - 实验室检测执行\r
  - 检测仪器设备监控\r
\r
### 6. 质量检查与评价 (Check)\r
*常态化指标监控、审核评价与客户反馈收集*\r
- QRQC快速反应\r
- SPC控制与分析\r
- MSA测量系统分析\r
- 客户满意度调查\r
- 分层过程审核\r
- 体系审核跟踪\r
- 管理评审执行记录\r
\r
### 7. 质量改进与行动 (Act)\r
*异常处理闭环与持续改进机制*\r
- 客诉/客退登记与处理\r
- 8D报告管理与追踪\r
- 纠正与预防措施管理\r
- 变化点申请与评估\r
\r
### 8. 数字化追溯 (Digital Traceability)\r
*对产品全生命周期的人机料法环测信息进行正向、逆向追溯及分析监控*\r
- **8.1 追溯查询**\r
  - 全链路追溯查询\r
  - 产品谱系图\r
  - 时序逻辑视图\r
- **8.2 正向与逆向分析**\r
  - 物料流追踪\r
  - 质量溯源分析\r
  - 相似性风险预警\r
- **8.3 统计与监控**\r
  - 追溯完整度报告\r
  - 供应链协调报告\r
\r
### 9. 质量成本管理 (Cost of Quality)\r
*财务与质量交叉模块，用于量化质量损失与改善收益*\r
- 质量成本科目定义\r
- 质量成本预算与计划\r
- 质量成本数据中心\r
- 质量成本核算单\r
- 成效与改善报告看板\r
\r
### 10. 知识库与培训 (Knowledge & Training)\r
*对应文档：第18章 知识库、20章 文档控制、22章 培训管理*\r
- 受控文档管理\r
- 质量经验库\r
- 培训管理\r
\r
### 11. 系统设置与集成 (System Settings)\r
*对应文档：第29-36章 安全权限与集成联动*\r
- 组织架构\r
- 角色权限\r
- 业务流转审批流配置\r
- 模块集成监控层\r
- 系统操作日志\r
- 审计追踪\r
- 系统参数\r
- 系统模板\r
- 数据应用\r
- 系统更新日志\r
- 系统公告\r
- 系统配置\r
- 菜单管理\r
- 系统监控\r
- 数据字典\r
---\r
\r
## 3. 设计亮点与预期收益\r
\r
1. **基于 PDCA 闭环模型**：主业务菜单按照 \`策划(Plan) -> 执行(Do) -> 检查(Check) -> 改进(Act)\` 重新组织，实现从先期防范、检验控制、审核监控到改善行动的闭环管理。\r
2. **深度集成压铸行业特性**：将**压铸工艺参数监控**和**铸件质量档案**融入过程执行层，强化核心制造过程的质量把控。\r
3. **补强实验室业务版图**：纳入**送检任务管理**与**实验室检测**模块，填补了在测试评价方面等关键业务的空缺。\r
4. **异常管理与持续改善并重**：QRQC、SPC、8D以及CAPA分别在“检查”与“改进”环节发挥关键作用，保障缺陷问题被强制闭环追踪。\r
5. **底层易拓展性强**：底层支撑与数据集成层独立设置，支持未来便捷接入更多第三方系统的监控入口与分析应用。\r
`,Be=`# 供应商档案 (Supplier Archive) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：供应商档案管理\r
**所属子系统**：基础数据管理模块\r
**目标**：对企业的各类供应商（原材料、设备、服务等）进行统一的主数据维护，满足多工厂化组织层级的数据管控需求，并加强对供应商相关资质证明文件的监管。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 整体布局\r
页面结构维持系统的统一交互规范，采用典型的“条件查询 + 数据操作 + 列表展示”的主体布局结构。\r
\r
### 2.2 搜索区设计\r
- **所属组织**：支持多选的下拉组织选择器，控制数据视界。\r
- **供应商编码**：输入框检索。\r
- **供应商名称**：输入框检索。\r
- **供应商等级**：A/B/C 三级下拉筛选。\r
- **供应类型**：下拉单选（原材料 / 设备 / 服务 / 其他）。\r
- **状态**：启用/禁用状态筛选。\r
\r
### 2.3 操作栏功能\r
- 支持常规的：新增、编辑、删除（批量）、状态变更（启用/禁用）、刷新。\r
- **导入功能**：集成“下载模板”与“文件上传”下拉操作，支持将Excel格式的供应商名单批量录入系统。\r
- **导出功能**：前端/后端导出过滤后的列表台账。\r
\r
## 3. 核心功能设计\r
### 3.1 多组织适配\r
- 融合 \`orgId\` 机制处理视图数据域。\r
- 新增与调整操作中，“所属组织”为强制前置字段。\r
- 列表对不同组织属性做颜色视觉隔离，例如“集团”层级和具体工厂使用不同色块。\r
\r
### 3.2 资质证明及有效期预警管理\r
- 由于供应商通常需要具备特种资质或 ISO 体系认证，系统特别增加了“资质附件管理”区块。\r
- 新增 **\`资质证明 (qualifications)\`**：上传营业执照、认证报告等文件的组件。\r
- 新增 **\`资质有效期 (qualificationExpiry)\`**：支持选择有效截止日期。\r
- **自动预警评估**：利用前端 \`computed\` (基于 dayjs) 或后端定时任务，动态计算当前时间是否已超过资质有效期。若识别已过期，表单编辑界面将展示红色 \`<a-alert>\` 强提醒，督促采购或质量人员及时联系供应商进行证件更新。\r
\r
## 4. 数据模型 (Data Model)\r
核心实体 \`Supplier\` 属性定义：\r
- \`id\`: 唯一主键\r
- \`orgId\`: 所属组织标识\r
- \`supplierCode\`: 供应商编码\r
- \`supplierName\`: 供应商名称\r
- \`supplierLevel\`: 供应商等级\r
- \`supplyType\`: 供应类型\r
- \`creditLevel\`: 信用分/级别的量化考核值\r
- \`cooperationYears\`: 合作年限\r
- \`creditCode\`: 统一社会信用代码\r
- \`legalPerson\`: 法人代表\r
- \`phone\` / \`email\` / \`address\`: 基础联系信息\r
- \`status\`: 生命周期状态标识\r
- \`qualifications\`: 资质证明附件集合\r
- \`qualificationExpiry\`: 资质有效期 (Date)\r
\r
## 5. 约束与规则\r
- **关联限制**：已被来料检验（IQC）单据引用的供应商不可被物理删除。\r
- **过期限制**：在部分深层次业务（如发放下单）中，若遇到资质已过期供应商可拦截报警（本页面为基础定义，拦截动作落地于其他业务链）。\r
`,Oe="# 储存地点管理 (Storage Location) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：库位/储存地点关联管理\r\n**所属子系统**：基础数据 / 辅仓储模块\r\n**目标**：统一定义和精细化管理厂区内的储位三维空间资源，建立容积率模型，同时针对高危及特定物料记录强制性的现场环控条件（如温湿度、消防要求等），辅助IQC验收入库和现场质检防呆预警。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 查询与操作\r\n- 具有标准的多维度搜索栏目（编码、名称、地点类型——包括仓库、车间、室外等）。\r\n- 操作按钮提供常规的增改删导体系，批量状态控制等。\r\n\r\n### 2.2 数据表格特色组件 (进度条)\r\n- **容量可视化机制**：表格内引入并重点打磨了 **容量使用情况 (`capacity`)** 的 `a-progress` 进度条列设计。\r\n  - 根据 `已用容量 / 总容量` 动态计算百分比。\r\n  - 若超出安全阈值 (例如 80% 变为警告活跃态，>90% 变为异常红色警告态)，直观呈现库区的爆仓压力。\r\n\r\n## 3. 核心功能设计\r\n### 3.1 环境控制体系 (Environmental Storage Conditions)\r\n此页面表单针对 QMS 典型的储藏变异情况额外新增了多个质量前置限定字段：\r\n- **温湿度范围录入 (`temperature`, `humidity`)**：限制例如部分电子料对 `18-25℃ / 40-60%` 绝对湿度的强需求登记。\r\n- **危化品及环安限制录入 (`ventilation`, `fireLevel`)**：下拉选择如防火等级 A/B/C 及对应的通风环境等级。\r\n\r\n### 3.2 空间分配机制\r\n- 提供全量的三维容量 `totalCapacity` 记录。\r\n- 该容量模块预留了外接出入库实时接口对接，计算出的 `usedCapacity` 可做前端阻断（例如超出容量禁止新建入库任务，这在需求链内预留了扩展锚点）。\r\n\r\n### 3.3 表单组块分段\r\n由于字段涵盖业务、环境、物理三维度，其添加/编辑表单使用 `a-divider` （分隔线）进行了业务语义化分割为：\r\n1. 基本定义段 (名称/类型/尺寸)\r\n2. 责任分配信息段 (部门/责任人/电话)\r\n3. 存储环控条件段 (温湿度/防火等)\r\n\r\n## 4. 数据模型 (Data Model)\r\n核心实体 `StorageLocation` 属性定义：\r\n- `id`: 唯一编号\r\n- `locationCode`: 物理储存编码 (如：WH001)\r\n- `locationName`: 名称\r\n- `locationType`: 分类（`warehouse`, `workshop`, `office`, `outdoor` 等）\r\n- `departmentId`: 运维挂靠部门\r\n- `managerId`: 行政/质量看守责任人\r\n- `totalCapacity`: 总体积或安全存放面积数\r\n- `usedCapacity`: 目前统计被占据数值\r\n- `phone`, `address`: 地理通信信息\r\n- `temperature`: 指导存储温度设定\r\n- `humidity`: 指导存储湿度设定\r\n- `ventilation`: 通风安全度级别\r\n- `fireLevel`: 必须满足的防火等级预设\r\n- `specialRequirements`: 人工补充的其他条件（如防潮、隔离存放等）\r\n- `status`: 状态\r\n\r\n## 5. 约束与规则\r\n- **可用性检验**：对环境要求极其严苛且状态标记为禁用的区域，后续 WMS 服务不允许下发转移物料到该片区的指令。\r\n- **空间合理性**：表单录入时，总容量 (`totalCapacity`) 不允许录入负数。\r\n",Ne=`# 客户档案 (Customer Archive) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：客户档案管理\r
**所属子系统**：基础数据管理模块\r
**目标**：维护企业所有客户的主数据信息，支持多组织数据隔离、资质附件管理与批量数据导入，为销售、发货及客诉等后续业务提供基础数据支撑。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 整体布局\r
页面采用标准的“上中下”上下分层布局：\r
- **顶部查询区 (Search Card)**：提供多种组合查询条件。\r
- **中部操作栏 (Toolbar)**：提供全局业务操作按钮。\r
- **下部数据区 (Table Container)**：以分页表格形式展示客户台账列表。\r
\r
### 2.2 搜索区设计\r
包含以下检索条件：\r
- **所属组织**：多选下拉框 (选项：集团、合肥工厂、芜湖工厂)，用于按组织域过滤客户。\r
- **客户编码**：文本精确/模糊检索。\r
- **客户名称**：文本精确/模糊检索。\r
- **客户等级**：下拉选择 (A级、B级、C级)。\r
- **客户类型**：下拉选择 (国内、海外、内部交易)。\r
- **状态**：下拉选择 (启用、禁用)。\r
\r
### 2.3 操作栏设计\r
- **新增**：打开新增客户的抽屉或弹窗。\r
- **编辑**：选中单条记录后激活，打开编辑表单。\r
- **删除**：批量删除选定的记录。\r
- **状态操作**：下拉菜单支持“批量启用”和“批量禁用”。\r
- **导入**：下拉菜单包含“下载导入模板”和“上传Excel文件”。\r
- **导出**：将目前查询结果导出为 Excel。\r
- **刷新**：重新加载当前表格数据。\r
\r
## 3. 核心功能设计\r
### 3.1 多组织支持 (Multi-Organization)\r
- 在数据模型中增加 \`orgId\` 字段。\r
- 列表页展示“所属组织”列，通过 \`Tag\` 标签使用不同颜色做视觉区分（集团为紫色，合肥工厂为蓝色，芜湖工厂为青色）。\r
- 搜索表单支持按组织维度圈定数据可见范围。\r
- 新增/编辑表单中，必须指定该客户档案归属的组织。\r
\r
### 3.2 资质附件管理\r
- 在新增及编辑表单中，添加了独立的“资质附件管理”区块。\r
- 使用 \`a-upload\` 组件实现多文件上传及列表展示管理。\r
- 保存时附件记录序列化并随主对象保存。\r
\r
### 3.3 导入与导出\r
- **导入**：利用不可见的 \`<input type="file">\` 实现文件选择，拦截系统默认行为，使用前端 FileReader 解析或上传给后端接口。\r
- **导出**：封装通用工具方法，将当前在前端的展示数据转换为 CSV 或 Excel 格式供用户下载保存。\r
\r
## 4. 数据模型 (Data Model)\r
核心实体 \`Customer\` 属性定义：\r
- \`id\`: 唯一主键\r
- \`orgId\`: 所属组织标识 (Group / 1 / 2)\r
- \`customerCode\`: 客户编码\r
- \`customerName\`: 客户名称\r
- \`customerLevel\`: 客户等级\r
- \`customerType\`: 客户类型\r
- \`creditLevel\`: 信用等级\r
- \`contactPerson\`: 联系人\r
- \`phone\`: 联系电话\r
- \`address\`: 联系地址\r
- \`remark\`: 备注\r
- \`status\`: 状态 (0: 禁用, 1: 启用)\r
- \`attachments\`: 资质附件列表 (Array)\r
\r
## 5. 约束与规则\r
- **唯一性约束**：同一组织下的客户编码必须唯一。\r
- **必填项验证**：所属组织、客户编码、客户名称、联系人等为必填字段。\r
- **权限控制**：编辑和删除操作需具备对应的数据权限，只能看到分配的组织的数据。\r
`,qe="# 工艺路线管理 (Process Route) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：工艺路线与工序检验挂载管理\r\n**所属子系统**：基础数据 / IPQC模块 (过程检验)\r\n**目标**：统筹定义某一款产品对应的完整生产流转工艺过程。它是车间 IPQC (过程检验)、首检、末检的锚点基座。通过该模型可以在特定的工序卡点强行织入检验逻辑。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 主子表联动网格 (Master-Detail Grid)\r\n- **主表视图**：提供工艺路线的基础清单（包括编码、路线名称、挂接物料编号及目前管控状态）。\r\n- **嵌套行展开视图 (`expandedRowRender`)**：利用 Vue 的 Table Slot 机制，实现点击主表某路线的”+”展开后，无需跳转即可全景预览属于该关联项的所有**工序明细表 (Steps)**。\r\n\r\n### 2.2 复杂页签式表单 (Tabbed Modal Forms)\r\n新增与编辑器抛弃了堆叠平铺，改用 `a-tabs` 结构：\r\n- **Tab 1: 基本信息**：填写路线的纲领信息与多版本（`Version`）号控制字段。同时可在这里挂接需要此条工艺的对应物料产品。\r\n- **Tab 2: 工序明细**：\r\n  - 属于动态行联动的内嵌编辑表格。\r\n  - 支持随时通过 `handleAddStep` 插入新工序。\r\n  - 内嵌输入框管理其：序号 (opSeq)、工序工步名称 (opName) 及对应的 工作段 (workCenter)。\r\n\r\n### 2.3 高阶路由重定向编辑\r\n- 除了 Modal 快捷编辑，还设计了跨路由挂载项（在操作列加入了专用的编辑、查看超链接，触发 `vue-router` 跳转到高等级的全屏级详情页面`/basic-data/process-route/edit/:id` 进行重量级排布修改）。\r\n\r\n## 3. 核心功能设计\r\n### 3.1 工序的检验组装插拔 (Inspection Configuration)\r\n在 Tab 2 工序明细维护中，核心杀手锏功能：\r\n- 单层工序列具有“检验配置”能力。\r\n- 前端显性放置 `FirstInsp` (首件校验)、`PatrolInsp` (巡检校验)、`FinalInsp` (末件校验) 的彩色能力标识微标签 (Tags)。\r\n- 提供【配置】按钮，它触发引荐组件 `<OperationInspConfigModal>`，实现在特定的一条工艺序位内注入不同维度的抽样或必检计划模板联动。\r\n\r\n### 3.2 灵活的路线与物料结合\r\n- **下拉模糊过滤物料**：`a-select` 中启用 `show-search` 并且实现了自定义了 `filter-option` 回调逻辑，支撑跨数层级的下拉联想补全。\r\n- 一条工艺路线可以服务于某些特性类同的多个SKU或独立使用。支持强大的版本管控（如新路线验证期设为 Draft 草稿，确认量产设为 Active 生效）。\r\n\r\n## 4. 数据模型 (Data Model)\r\n核心属于典型的【主从表设计】(1对多)：\r\n\r\n**主实体 `Route Master`**:\r\n- `id`: 表记录主键\r\n- `code`: 工艺唯一编码\r\n- `name`: 工艺名称\r\n- `materialId`: 默认适配挂载的产品外键\r\n- `version`: 生效版本号控制 (如 V1.0、V2.0)\r\n- `description`: 技术备忘信息\r\n- `status`: 生命周期（`Draft` / `Active` / `Obsolete`）\r\n\r\n**子实体 `Route Steps` (工序)**:\r\n- `id`: 工步内码\r\n- `opSeq`: 技术加工执行流水序号 (10, 20, 30 ...用以留空插位)\r\n- `opName`: 工艺名 (如：压铸、熔炼、组装)\r\n- `workCenter`: 要求生产落地的实际车间/机器设备组识别号\r\n- `hasFirstInsp` / `hasPatrolInsp` / `hasFinalInsp`: 是否挂载三检配置规则的布尔标记位 (Boolean)\r\n\r\n## 5. 约束与规则\r\n- **序列排序约束**：进入的生产操作时序(`opSeq`)应该符合自增要求（非必须连续，但业务上需要）。\r\n- **生效态数据拦截**：如果一条路线的 `status` 为已生效运行 (`Active`) ，修改其底下的抽检首检校验计划必须伴有高等级放行或直接拦截提示建议升级 `version` 版本以作变动追溯。\r\n",Ge=`# 物料/产品档案 (Material & Product Archive) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：物料产品档案管理\r
**所属子系统**：基础数据管理模块 / 质量主数据（融合）\r
**目标**：统管工厂中各种流转实体（含原物料、半成品、产成品）的基本属性；它是整个质量管理系统(QMS)的最高频被引用对象；支持关联各类质量特有标准设定。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 高级版块布局（左树右表联动）\r
引入了复杂的组合视图：\r
- **左侧分类导航树**：完全复用来自《物料分类管理》的分类拓扑树（即：原材料、半成品、成品分支）。\r
- **点击穿透**：当用户在左侧选中了某分类分支（如“成品”），右侧的表格内容区将**立刻只过滤并呈现**归属于该分类标识（包括其子类）的所有具体物料 SKU 条目。\r
- **树搜索**：左侧树自带过滤搜索，避免由于分类层级过多导致的浏览困难。\r
\r
### 2.2 右侧核心管理面板\r
包含标准的快速信息检索区和工具栏：\r
- **组合搜索**：支持“所属组织”组织层级、“物料编码”、“物料名称”字段检索。\r
- **数据导入导出**：通过工具栏按钮直接响应大批量的料号 Excel 上传解析以及输出台账诉求。\r
- **表格核心列**：物料编码、规格型号、单位、来源模式（自制/外购），以及最为特殊的统计列：**工艺路线数**。\r
\r
## 3. 核心功能与集成设计\r
### 3.1 跨模块的质量设置融合\r
本模块在基础属性CRUD外，通过弹窗/抽屉（Drawer）的方式承载并外接了多个高阶的质量主数据：\r
- **检验规格 (Spec Drawer)**：从列表的“更多/动作”或详细页可以针对某项物料开启配置其专有检测属性定义。\r
- **工艺路线 (Route Drawer)**：物料具体的生产流转经由工序设定，表格中以显性的蓝色超链接直观显现该物料拥有几条流线。\r
- **检验方案 (Plan Drawer)**：快捷地挂载此物料在各类特定事件（入库、过程、成品环节）触发时应响应的质检执行计划配置方案。\r
\r
### 3.2 多组织维度的管控\r
- 数据表含有 \`orgId\` 业务标识字段。\r
- 支持同一套物理编码的物料在不同工厂间不同的属性隔离描述呈现。由于涉及到各组织，所以在数据入库及查询环节均强制通过组织维度的校验。\r
\r
## 4. 数据模型 (Data Model)\r
基础物料实体 \`Material\` 属性定义：\r
- \`id\`: 唯一识别号\r
- \`orgId\`: 所属组织控制标识\r
- \`code\`: 物料/产品编码 (SKU)\r
- \`name\`: 物料/产品名称\r
- \`spec\`: 规格参数信息\r
- \`category\`: 归属分类引用标识\r
- \`unit\`: 计量单位 (pcs, kg, set等)\r
- \`source\`: 获取来源类别 (Buy:外购 / Make:自制)\r
- \`remark\`: 其他描述提示情况\r
\r
## 5. 约束与规则\r
- **多业务交错控制**：被生产单据或入库流水等已经占用的实体物料通常从业务上被判定为不可直接清除。\r
- **分类依赖限制**：新增物料时只能选择末级最细的可用分类节点进行挂靠绑定。\r
`,Fe=`# 物料分类管理 (Material Category) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：物料分类管理\r
**所属子系统**：基础数据管理模块\r
**目标**：管理公司所有物料的分组架构及分类树节点，通过直观的层级结构组织物料主数据，以便规范和加速整个供应链数据链的搜索与统计属性归类。\r
\r
## 2. 界面布局与交互设计 (重构说明)\r
为了大幅提升层级数据的可视化与可操作性，对页面进行了深度的 **“左树右表”** (Split-Layout) 布局改造。\r
\r
### 2.1 左侧分类树 (Tree Panel)\r
- **展示**：使用树状结构全量或异步渲染物料的层级关系（如：原材料 -> 金属材料）。\r
- **搜索**：顶部提供针对树节点的实时文本搜索过滤能力，便于在庞大的分类目录中快速定位。\r
- **操作互动**：\r
  - 左键单击：高亮选中该节点，并**联动右侧表格**，使其仅展示所选分类及所有下挂子分类的数据。\r
  - 右键单击：弹出快捷环境菜单 (Context Menu)，支持直接针对于此级别进行：**新增子分类**、**编辑此分类**、**删除此分类** 等极速操作。\r
- **清除重置**：树顶部含有“清除筛选”按钮，恢复查看平铺的全部分类台账。\r
\r
### 2.2 右侧内容面板 (Content Panel)\r
- 同常规的管理视图一致，但在数据获取时会额外挂载来自左侧所选层级的依赖参数。\r
- 包含了常规工具栏操作、搜索面板、及带有分类完整层级信息的表格 (\`a-table\`)。\r
\r
## 3. 核心功能设计\r
### 3.1 树与表格的数据联动\r
- 左侧树与右侧表格使用一套基础的数据源加工而成。\r
- 左树发生 \`select\` 事件时，更新上下文 \`selectedTreeKeys\`。\r
- 表格的 \`DataSource\` 设定为基于该 Key 向下递归查找所有子节点 ID 并执行集合内 \`.filter()\` 保留满足条件的条目。\r
\r
### 3.2 级联删除机制\r
- 树形结构数据中极易遇到存在关联子层级的情况。\r
- 在用户尝试触发删除操作时，系统会自动评估 (基于 \`getDescendantIds\` 获取数量)。\r
- 若其存在子类别，将明确在对话框气泡中提示：“分类X下有 N 个子分类，删除后子分类也将被删除”，确认后执行**深度遍历级联删除**以保证数据的干净与一致性。\r
\r
## 4. 数据模型 (Data Model)\r
核心实体 \`Category\` 属性定义：\r
- \`id\`: 分类主键\r
- \`categoryName\`: 分类名称\r
- \`categoryCode\`: 规范化分类编码 (大写字符 + 下划线构型)\r
- \`parentId\`: 上级分类ID（指向自身实体的外键指针，为空表示根节点）\r
- \`sortOrder\`: 同级内的显示排序权重\r
- \`description\`: 说明备注\r
- \`status\`: 控制节点是否可以在后续物料档案创建时被正常引用\r
\r
## 5. 约束与规则\r
- **编码规范**：分类编码被严格校验，只允许大写英文字母和下划线组成。\r
- **循环依赖防范**：在设置上级分类时，不能选择其自身或其子分类作为父级以致死循环（本期简化处理，但在后端需严格防范）。\r
`,Ue=`# 生产班组档案 (Production Team) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：生产班组管理\r
**所属子系统**：基础数据管理模块 / 人事辅助核算\r
**目标**：统管车间内的人员组织构架最小单元——“班组”。记录其归属部门、排班体系以及人员规模，为后续质量巡检打卡归属以及生产绩效统计提供维度分析依据。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 查询与检索\r
系统提供了轻量级的查询卡片：\r
- **班组编码 / 班组名称**：用于精确或模糊锁定特定班组。\r
- **所属部门**：下拉列表筛选（例如拉取生产一部、二部、质量部数据）。\r
- **状态**：启用/禁用。\r
\r
### 2.2 表格与色彩展示\r
- 对 **工作班次 (Work Shift)** 进行了色彩和文字的自定义渲染，利用不同颜色区分 “白班 (day)”、“夜班 (night)”、“混合班 (mixed)” 等高频变动排班体系。\r
\r
## 3. 核心功能设计\r
### 3.1 跨模块联动设计\r
- 在新增/编辑界面的中不仅定义基础文字，还深度嵌入了企业组织构架。\r
- **挂靠部门 (\`departmentId\`)**：强制所选班组归属于具体的粗粒度车间或生产部门。\r
- **挂靠主管 (\`leaderId\`)**：指定班组长的人员ID（依赖从人员主数据里抓取的数据）。\r
\r
### 3.2 规模及排班扩展控制\r
- 引入了 \`workShift\` 字段以支持灵活的排班约束录入（白班/夜班/早班等）。\r
- 通过 \`memberCount\` (固定或预估考勤基数) 定量此班组的大致规模。\r
- 支持填报详细的班组工作职责（\`responsibilities\`）和具体工作地点区域。\r
\r
### 3.3 查看及展示组件\r
- 配置了高颜值的 \`a-descriptions\` 组件支持在不进入可编辑表单的模式下，以三列宽度的平铺弹窗模式呈现班组全貌档案概览。\r
\r
## 4. 数据模型 (Data Model)\r
核心实体 \`ProductionTeam\` 属性定义：\r
- \`id\`: 唯一识别号\r
- \`teamCode\`: 班组编码（如：TEAM001）\r
- \`teamName\`: 班组命名\r
- \`departmentId\`: 直属部门的外键引用\r
- \`leaderId\`: 当前生效班长/负责人的外键引用\r
- \`workShift\`: 轮班班次制度约束\r
- \`memberCount\`: 满编或现有人数配置\r
- \`phone\`: 内部通联方式\r
- \`workLocation\`: 工作物理地点\r
- \`responsibilities\`: 团队主责定位\r
- \`remark\`: 补充备注说明\r
- \`status\`: 数据启用标识 (1/0)\r
\r
## 5. 约束与规则\r
- **关联数据清理控制**：已有排班或生产作业单挂靠的班组不能被彻底清除，只允许修改状态归档为禁用。\r
`,Ze="# 计量单位管理 (Unit Management) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：计量单位管理\r\n**所属子系统**：基础数据管理模块\r\n**目标**：统一定义和管理系统中使用的所有商品、物料及包装的计量单位，支持国际标准的单位类型分类（重量、长度、体积、面积等），并支持设定基准单位及复杂的换算比率，为库存换算、BOM计算及采购入库提供底层支撑。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 整体布局\r\n页面采用了标准化的“表单查询 + 工具栏 + 数据表格”三段式卡片布局。\r\n\r\n### 2.2 搜索区设计\r\n- **单位编码**：文本检索。\r\n- **单位名称**：文本检索。\r\n- **单位类型**：下拉选择（重量、长度、体积、数量、面积、时间）。\r\n- **状态**：启用/禁用筛选。\r\n\r\n### 2.3 数据表格展示\r\n- 关键展示字段包括单位的编码、名称以及分类的单位类型。\r\n- **视觉优化**：利用 `a-tag` 将不同单位类型渲染为不同颜色（例如：重量显示为紫色，长度蓝色，数量绿色等）。\r\n- 增加了“换算基准单位”与“换算系数”两列，以及是否为“首选/基准单位”的标签。\r\n\r\n## 3. 核心功能设计\r\n### 3.1 换算基准体系\r\n- **是否基准单位 (`isBaseUnit`)**：表单中可单选，用于定义某一类量的绝对基准（如重量基准为“KG”）。\r\n- **换算基准单位 (`baseUnitId`)**：针对非基准单位，要求必须选择同类型的基准单位进行挂靠关联。\r\n- **换算系数 (`conversionFactor`)**：提供极高精度的数字输入组件，定义1个当前单位等于多少个基准单位（例如，“吨”挂靠“千克”，系数设为 1000）。\r\n\r\n### 3.2 CRUD 与批量操作\r\n- **新增/编辑**：由对话框 (Modal) 承接，支持基准单位联动的规则校验。\r\n- **状态管理**：支持单选或批量勾选执行“启用/禁用”操作。\r\n- **导出 (Export)**：工具栏内置导出 CSV 表格能力，方便主数据报表拉取。\r\n\r\n## 4. 数据模型 (Data Model)\r\n核心实体 `Unit` 属性定义：\r\n- `id`: 唯一标识符\r\n- `unitCode`: 单位编码（验证规则：大写字母加下划线，如 `KG`, `PCS`）\r\n- `unitName`: 描述名称（如：千克，个）\r\n- `unitType`: 单位类型 (`weight`, `length`, `volume`, `count`, `area`, `time`)\r\n- `baseUnitId`: 换算基准单位 ID（自身外键）\r\n- `conversionFactor`: 换算乘数系数（精确至6位小数）\r\n- `isBaseUnit`: 标识本单位是否作为类型的基准点 (1/0)\r\n- `sortOrder`: 下拉排列顺序\r\n- `description`: 描述说明\r\n- `status`: 生命周期状态\r\n\r\n## 5. 约束与规则\r\n- **防呆控制**：同一 `unitType` 分类下，原则上只能有一个启用的基准单位（逻辑实现落地后端时拦截）。\r\n- **递归防范**：在选择 `baseUnitId` 时，可选池需要过滤掉自身，且强制展示 `isBaseUnit=1` 的单位列表，防止出现循环换算定义。\r\n",Ve=`# 基础数据与质量主数据模块 - 需求说明书(PRD)\r
\r
## 1. 概述\r
本文档基于现已完成的“基础数据”与“质量主数据”系统代码与模块进行梳理生成，旨在固化已有研发成果。同时，结合《舜富QMS系统完整解决方案》的宏观设计，给出当前实现与理想方案之间的差距分析，为下一阶段迭代提供参考。\r
\r
---\r
\r
## 2. 差距分析 (Gap Analysis)\r
\r
对比《解决方案》中涉及主数据相关章节（如分册7、分册8），目前已实现的模块能够支撑核心的前期检验和基础生产管理需求，满足了最核心的质量标准配置，但在更深入的防错预防、智能化方面存在部分缺失需求：\r
\r
1. **抽样标准的动态检验规则缺失（涉及第17章）**\r
   - **已实现**：静态的抽样参数配置（支持正常/加严/放宽，支持AQL值及Ac/Re判断）。\r
   - **缺失点**：缺乏“放宽/加严/正常/免检”之间自动转换的**业务规则引擎与计数器配置**（如：连续10批合格转放宽、连续5批下2批不合格转加严等自动化转移逻辑配置）。\r
2. **MSA与SPC的深度主数据配置缺失（涉及第16章）**\r
   - **已实现**：计量器具台账列表（实现基础设备追踪）。\r
   - **缺失点**：缺乏量具“校准计划模板”与量具“Gage R&R研究”（重复性、再现性分析）的参数化模板配置；缺失SPC相关的控制图类型、控制界限(UCL/LCL)的定义与异常判定规则配置。\r
3. **QRQC、CAPA配套的基础知识与工作流主数据未完全建立（涉及第9、11、18章）**\r
   - **说明**：当前已完成基础的缺陷分类（现象与原因），但针对CAPA根因分析（如5Why模板、鱼骨图模板）和QRQC报警级别与多部门团队的基础架构等依赖数据未做体系化的配置页。\r
\r
3. **基础数据层面的多组织架构支撑缺失 (Multi-Organization)**\r
   - **已实现**：当前的客户、供应商、物料、工序等基础数据属于扁平化的全局数据，未区分组织维度。\r
   - **缺失点**：作为集团型制造业，基础数据（特别是物料、BOM、工序）通常存在“集团级主数据”与“工厂级/组织级业务数据”的区别。目前系统缺少了字段级的\`orgId\`归属隔离机制，以及“分配/下发”至特定厂区的业务逻辑。\r
4. **进阶业务功能与体验的缺失 (UI及易用性)**\r
   - **数据导入能力**：当前缺少Excel批量导入功能，导致基础数据初始化工作量大。\r
   - **分类层级展示**：目前物料分类、缺陷原因分类采用下拉或列表展示，当层级过深时，缺乏高级的“左树右表”布局结构支持。\r
   - **文件控制流**：客户档案材料（如营业执照）、供应商资质证明（SQE准入证明）目前缺少文件对象存储与附件管理机制集成。\r
\r
> **结论**：如上所述，在支持基本检验的“人、机、料、法”等静态基础数据上基本满足核心流转需求；但在高阶的动态规则、数据隔离（多组织）以及部分用户体验（如左树右表、附件管理、批量导入）上存在改进空间。\r
\r
---\r
\r
## 3. 已实现业务需求列表 (需求清单)\r
\r
### 3.1 基础数据模块 (Basic Data)\r
\r
基础数据主要用于规范系统运行所需的静态业务对象，确保后续检验、客诉、供应商分析的一致性。\r
\r
#### 3.1.1 客户与供应商管理\r
* **客户档案管理 (CustomerArchive)**：维护企业客户的基本信息和合作状态，支撑OQC阶段及客诉模块的关联。\r
* **供应商档案管理 (SupplierArchive)**：维护供应商的基本资质、联络人等信息，为IQC来料检验提供货源关联支持。\r
* **客供关系映射 (CustomerSupplier)**：针对包含特殊供应链关系的企业，维护两者联动的映射结构。\r
\r
#### 3.1.2 物料与工艺结构\r
* **物料分类管理 (MaterialCategory)**：支持对物料建立多层级的树状分类体系（如原材料、半成品、成品等）。\r
* **物料/产品主数据 (MaterialProduct)**：对具体的铝合金、锌合金、外协件及产成品进行编码和业务属性定义。\r
* **工艺路线管理 (ProcessRoute)**：建立标准工序的先后执行顺序，为IPQC（首件、巡检、末件）提供基于工序的质量控制节点。\r
\r
#### 3.1.3 生产辅助基础\r
* **生产班组信息 (ProductionTeam)**：维护各生产车间的班组构成，用于检验任务和生产任务的责任人定界。\r
* **库位划分 (StorageLocation)**：维护物料的存放区域与货位体系。\r
* **单位体系 (UnitManagement)**：定义系统的度量衡主数据（如PC、KG、M 等），确保库存、抽样与检验单位的统一。\r
\r
---\r
\r
### 3.2 质量主数据模块 (Quality Master Data)\r
\r
质量主数据聚焦于检验管控所必需的准则和特征，是驱动IQC~OQC四级检验运作的核心引擎。\r
\r
#### 3.2.1 缺陷定义及管理\r
* **缺陷现象库 (DefectPhenomenon)**：对可能发生的不良表现（如表面划伤、尺寸超差、压铸气孔等）进行标准化定义，支持多维度查询。\r
* **缺陷原因库 (DefectCause)**：对触发缺陷的结构性原因建立知识树，便于后续不合格品分析和CAPA追溯。\r
\r
#### 3.2.2 检验特征基础数据\r
* **检验项目管理 (InspectionItem)**：定义独立的检验要素（如：外径长度、硬度值、外观颜色），支持集团/多工厂级别的组织隔离。\r
* **检验方法管理 (InspectionMethod)**：定义对应的测试和测量手段（如三坐标测量、光谱分析、目视检验等）。\r
\r
#### 3.2.3 抽样体系及判定标准\r
* **抽样方案配置 (SamplingPlan)**：\r
  * 支持多维度的抽样模式：基于国标（GB/T 2828.1等）根据批量与AQL自动推导样本量和Ac/Re、固定数量抽样、百分比抽样、全检。\r
  * 根据检验水平（I、II、III、S1-S4等）和检验类型（正常、加严、放宽）进行全方位判定支持。\r
\r
#### 3.2.4 检验方案及模板引擎集\r
* **检验模板设计 (InspTemplate)**：抽象出一套通用的检验标准集合模板，可复用于具备相似特性的产品/物料。\r
* **检验方案设计 (InspScheme)**：定义了高度灵活的验证逻辑单元，将检验项目、检验方法、相关缺陷代码与抽样方案打包整合。\r
* **检验计划模型 (InspPlan)**：在检验方案之上绑定触发条件（如特定供应商、特定物料组、具体产线工序等），在执行层指导任务的自动生成逻辑。\r
\r
#### 3.2.5 器具及仪器设备\r
* **计量器具台账 (GaugeLedger)**：管理质量检测所涉及的各类量具的状态、检定周期、精度等级及保管员，为后续MSA铺平基础。\r
\r
---\r
\r
## 4. 后续演进计划 (Roadmap)\r
\r
根据GAP分析结果，针对基础数据与质量主数据的演进路线图建议如下：\r
\r
### 阶段一：动态规则完善 (近期)\r
* **动态抽样规则引擎**：增加检验批次计数器与转移规则配置模块（支持在正常、加严、放宽、免检间自动转换）。\r
* **自动化触发集成**：将检验计划与动态抽样规则引擎结合，在生成检验任务时自动推导当前的抽样严格度。\r
\r
### 阶段二：配置化MSA与SPC (中期)\r
* **测量系统分析中心**：在现有的计量器具台账基础上，增加Gage R&R研究配置模板与数据采集模型，形成MSA基础配置数据。\r
* **统计过程控制主数据**：建立SPC控制图类型、判定规则（判异规则）等基础配置，为未来的SPC过程监控做好支撑准备。\r
* **多组织与权限隔离改造**：在所有基础数据（物料、客户、供应商）中增加 \`org_id\` 租户级或工厂级隔离，支持按组织查看不同工厂下的物料。\r
\r
### 阶段三：CAPA及QRQC数据基础建设与UI重构 (远期)\r
* **高级UI重构与树状结构**：针对含有层级结构的基础数据（如物料分类、缺陷原因等），优化为“左树右表”的左右分栏交互。增加各基础数据的Excel模板下载与批量导入能力。\r
* **根因分析模型配置**：搭建5Why模板、鱼骨图分类等分析模型基础数据源。\r
* **高阶报警与工作流策略**：搭建QRQC缺陷分级策略配置，为后续触发不同部门快速响应的报警级别及升级规则打通数据关联。\r
* **资质附件管理体系**：打通文件服务系统，在供应商、客户档案中集成资质证书附件的上传与有效期预警。\r
`,He=`# 不良现象与字典库 (Defect Phenomenon / Cause) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：质量缺陷与失效原因特征库\r
**所属子系统**：质量主数据模块 (Quality Master Data)\r
**目标**：为产品检测中所有不符合项 (NC) 提供标准化的话术代码库和严重程度标识，避免车间工人与质检人员手写随意字句所造成的不利分析汇总局面；以及管理常见的根因分析 (RCA) 中的故障特征。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 不良现象库 (Defect Phenomenon List)\r
采用多维检索栏与表格方式：\r
- 提供严重等级 (\`severity\`) 以及 缺陷/失效分类（\`processType\` 例如外观不良、尺寸不良等）的过滤支持。\r
- 通过 Tag 给不同的质量严重程度赋予显性颜色控制（如：**CR (致命色:红)**、**MA (主要:橘色)**、**MI (次要:蓝)**）。\r
\r
### 2.2 编辑与管理关联项模块\r
- 不仅仅是录入基本文字，也包括对不良现象在后续应用时的图片、缺陷指导手册的引用配置编辑组件。\r
\r
## 3. 核心功能设计\r
### 3.1 不良特征定义机制\r
为防止数据“泛滥”，建立了不良字典。在检验环节记录数据时：只有从这里定义了特征之后（或动态添加），该特征才能通过 “检验项目关联表”（参考检验项目关联项功能）自动拉到相应的品质表单中。\r
\r
### 3.2 不良原因分析源映射 (Defect Cause)\r
通过同步开发的分析页，将不良表象与其背后的产生机制（例如操作问题、材料问题、设计问题建立分类）。配合使用构成异常质量的 “现象→原因对策” 的闭环知识系统基础。\r
\r
## 4. 数据模型 (Data Model)\r
**不良现象实体 (\`DefectPhenomenon\`)**:\r
- \`code\`: 失效模型专有的代号\r
- \`name\`: 即现象呈现，例如：生锈、偏移、划痕\r
- \`severity\`: 失效严重等级 (\`CR\`: 严重缺陷, \`MA\`: 主要缺陷, \`MI\`: 次要缺陷)\r
- \`processType\`: 所属环节种类域\r
- \`description\`: 具体定义解释\r
\r
## 5. 约束与规则\r
- 严重度 \`severity\` 是作为核心流程驱动（触发评审）和系统汇总（拉出柏拉图及扣分权数）最关键的数据节点，不可进行粗糙变更。如果修改一个原本是次要的缺陷为致命，将会引流并放大历史表单问题的数据评估级别。\r
`,je=`# 抽样方案管理 (Sampling Plan) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：AQL 抽样规则与方案 (Sampling Plan)\r
**所属子系统**：质量主数据模块 (Quality Master Data)\r
**目标**：定义复杂的批量到样本转换计算规则，支持国际通用标准(如 GB/T 2828.1) 和内控百分比或全检方式，决定各检测批次放行和拒收 (Ac/Re) 阀值的底层模型。\r
\r
## 2. 界面布局与交互设计 \r
### 2.1 深度的 “左菜单右详情” 经典布局\r
页面为了适应多规则子级的渲染，构建了类似 IDE 的导航框架配置模式：\r
- **左侧边栏 (Left Panel)**：主方案导航。\r
  - 列出包含 GB/T2828.1 或 百分比 等大类母方案。\r
  - 含有悬浮快捷键及过滤功能，点击卡片（支持选中底色高亮）可以异步加载对应大类的诸多规则。\r
- **右侧工作台 (Right Panel)**：规则矩阵与详细子表展示区。\r
  - 结合主大类显示 \`planCode\`，可以向该方案下派生增添 “规则 (Rules)”。\r
  - 以 \`Nested Table\` 嵌套表格形式渲染不同规则组合下的判定细则。\r
\r
## 3. 核心功能设计\r
### 3.1 丰富的抽样标准匹配策略\r
支持由业务枚举定义的抽样模型 (\`samplingMethod\`)：\r
- **STANDARD_BASED**: 国标/行业计算判定 (使用 AQL 查询矩阵)\r
- **FIXED_QUANTITY**: 强制固定抽样个数 (例如来多少固定抽 10 件)\r
- **PERCENTAGE**: 百分比折算量 (例如10%)\r
- **FULL_INSPECTION**: 全检 (100%覆盖)\r
\r
### 3.2 矩阵抽样明细规则网格\r
这是本页面的主要亮点组件，用于渲染 AQL 规则的核心精髓：\r
针对给定的 \`inspectionLevel\` (检验等级如：II、S1、S2) 和 \`inspectionType\` (类型如正常、加严、放宽)：\r
配置一个批量查询表格。例如：\r
- 当交收数量段在 \`[batchSizeMin, batchSizeMax]\` 间。\r
- 采用某字码 (\`sampleSizeCode\`)，确定应取样总数。\r
- 然后配置 \`Ac（接收阀值数量）\` 和 \`Re（拒收阈值）\`。系统将以此矩阵精确执行批次判断逻辑。\r
\r
## 4. 数据模型 (Data Model)\r
数据结构上为 方案主干 -> 子规则设定 -> 阈值明细段 的三级树状体系：\r
\r
**Plan 层 (\`SamplingPlan\`)**:\r
- \`id\`, \`orgId\`\r
- \`planCode\`, \`planName\`\r
- \`samplingMethod\`: （国标、固定数、百分比等算法）\r
- \`description\`\r
\r
**Rule 层 (与Plan为 1:N)**:\r
- \`ruleCode\`, \`ruleName\`\r
- \`inspectionLevel\`: (I, II, III级等)\r
- \`inspectionType\`: (正常/加严/放宽)\r
- \`aqlValue\`: (0.65, 1.0, 1.5, 等)\r
\r
**Detail 层 (批量到样本矩阵段，与Rule为 1:N)**:\r
- \`batchSizeMin\`, \`batchSizeMax\`\r
- \`sampleSizeCode\`: 样本容量指示符字母\r
- \`acceptanceNumber\` (Ac)\r
- \`rejectionNumber\` (Re)\r
\r
## 5. 约束与规则\r
- **规则交叉检查**：对于同一个检验级别、检验类型和 AQL 下的 \`[batchSizeMin, batchSizeMax]\` 交收批次范围，不应该有任何覆盖或断层死角的重叠空间。\r
- **关联锁定限制**：在部分业务场景下，如果一个 AQL 方案或其中的规则已经被业务检验任务直接或间接作为计算快照锁定使用，不能执行删去（Delete），仅能采取废弃挂起动作。\r
`,Ke=`# 检验方法管理 (Inspection Method) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：检验方法与操作规范资源管理 (Inspection Method)\r
**所属子系统**：质量主数据模块 (Quality Master Data)\r
**目标**：统管质量系统内涵盖的一切测定动作及 SOP(标准操作程序)的索引数据，为主测数据（检验项目）提供作业指导文本或附件支持。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 查询与检索\r
系统采用了简单的卡片轻量检索：\r
- **方法名称 / 附件ID / 组织筛选**。\r
- 操作区支持典型的增、删、改、导出。\r
\r
### 2.2 表格与文字展示\r
- 默认在主表格将步骤核心文本以文本切省 \`ellipsis=true\` 方式进行渲染，便于直接快览部分核心步骤（例如需要特殊的蓝牙数显卡尺连接校准步骤提示）。\r
\r
## 3. 核心功能设计\r
### 3.1 集团/组织数据下放\r
同检验项目类似，方法库同样建立在集团下发与各工厂自建组合的体系中。\r
新增/编辑表单要求定义 \`orgId\` 域，方便集团推行大一统检验要求时能在不同工厂被共享。\r
\r
### 3.2 检验SOP的绑定机制\r
建立针对此方法的详尽多步流控制：\r
- 字段 \`operationText\` 提供大量人工指令（如 1.校准...2.放置...3.读取...）的支持。\r
- 字段 \`attachmentId\` 支持关联物理上的多媒体指导文档，使得在后续 IPQC（首检/巡检）触屏应用端能够快速调起说明书。\r
\r
## 4. 数据模型 (Data Model)\r
核心实体 \`InspectionMethod\` 属性定义：\r
- \`id\`: 实例主键\r
- \`orgId\`: 归属组织域 (null为集团总管)\r
- \`methodName\`: 工具操作方案命名 (如: 蓝牙卡尺检定法)\r
- \`attachmentId\`: 绑定对应服务端的文件管理服务器凭证ID（关联SOP）\r
- \`operationText\`: 特定的手写检测作业书说明详情。\r
\r
## 5. 约束与规则\r
- **重名排他验证**：为防范工厂下建操作标准引起混乱，新增和修改方法提交前引入异步唯一性鉴别。判断方式为：同 \`orgId\` 作用域下，\`methodName\` 不可发生完全一致冲突重复。\r
`,We="# 检验模板管理 (Inspection Template) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：质量检验模板管理 (Inspection Template)\r\n**所属子系统**：质量主数据模块 (Quality Master Data)\r\n**目标**：统一定义各工序、各类型检验（IQC/IPQC/FQC/OQC）在执行检验动作时的具体“表单外观”及验证特征清单。它是连接底层的“检验项目(Inspection Item)”和高层的“检验方案(Inspection Plan)”的中间载体，决定了一线质检员会看到怎样的检测记录页面结构。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 高级查询面板\r\n页面顶部区域内置了多维检索栏目，满足快速筛查的需求：\r\n- **组织过滤**：可按照归属地（例如：集团、芜湖工厂、合肥工厂）筛选。\r\n- **阶段过滤**：按照特定的检验阶段 (`IQC来料`, `IPQC过程`, `FQC成品`, `OQC出货`) 进行目标靶向过滤查询。\r\n- **基础状态查询**：内置了类似于生命周期的状态（草稿、审批中、已批准、已作废）筛选器。\r\n \r\n### 2.2 表格与操作设计\r\n- **丰富的数据列表**：一目了然地展示模板的编码、名称、版本、关联细项数量(`detailCount`)及最新同步状态。\r\n- **受控的操作机制**：操作列遵循了严格的文件受控策略，使用了下拉菜单 (`更多`) 来折叠低频的审批和流转动作操作（“提交审批”、“审批通过”、“历史版本管理”等）。\r\n\r\n## 3. 核心功能设计\r\n### 3.1 严格的版本历程追溯台账 (History Version Tracking)\r\n此功能是本页面最大的亮点，引入了深度贴合军工及汽车制造行业要求的 **版本追踪树** 弹窗：\r\n- 用户点击 “查看历史版本”，将弹出带左侧对齐锚点的 `a-timeline` 时间轴。\r\n- 直观渲染该模板的升版历程。包括某版本于何时被谁（Updater）以何种摘要（changeSummary，如：“调整了某项外观不良校验逻辑”）生成。\r\n- **版本快速回滚**：针对作废的历史快照（`OBSOLETE`），提供【恢复此版本】这一快捷路径按钮。此操作并不会去篡改现有生效版本，而是将其底层数据镜像一份，克隆生成最新编号的新一轮 `DRAFT` (草稿)版本，极大地减少了工程师重建模板工作量。\r\n\r\n### 3.2 组织下沉体系\r\n- 检验模板同样融入了集团 (`Group`，数据结构里一般表现为 `orgId: 'ORG001'`等类似顶层标识）和工厂 (`Factory`) 两套体系。下级工厂通常不允许直接篡改乃至删除带有上级标识的标准模板定义，仅能将其**复制 (Copy)** 下来做自我工厂级属性扩展。\r\n\r\n## 4. 数据模型 (Data Model)\r\n核心实体 `InspectionTemplate` 定义：\r\n- `id`: 表主记录标识\r\n- `orgId`: 指向数据所有的权限组或厂区域内码。\r\n- `code`: 系统内校验或导入时认定的逻辑编码\r\n- `name`: 模板可视化命名（如：IQC电子元器件检验单模板）\r\n- `inspType`: 检验大类域字典标识（`IQC`, `IPQC`, `FQC`, `OQC`）\r\n- `status`: 生命周期（`DRAFT`, `IN_APPROVAL`, `APPROVED`, `OBSOLETE`）\r\n- `version`: 当前生效管控的字面字符串（如：`V1.0`, `V2.1`）\r\n- `detailCount`: 下级装配检测项的数据规模反馈量。\r\n\r\n**历史节点模型 (History Node)**:\r\n- `version`: 关联子版本\r\n- `updateTime`, `updater`: 操作归属人日志\r\n- `changeSummary`: 用于技术变更(ECO)关联说明的简讯。\r\n\r\n## 5. 约束与规则\r\n- **生命周期锁定 (Status Guard)**：数据在 `DRAFT` (草稿阶段) 才可以做核心编辑 (`handleEdit`) 和清理废除 (`handleDelete`) 的动作。一旦状态机跃迁到其它任何形态，界面即进入强制只读与拦截态。\r\n- **关联锁定限制**：任何处在 `APPROVED` 已发布状态被 `InspPlan` (方案主数据表) 关联依赖的特征模板，必须通过版本升级 (New Version) 的方式处理维护。不允许直接撤下或破坏其内部已装嵌的校验项目，保证历史质检订单打开时的追溯呈现完备性。\r\n",Xe="# 检验项目管理 (Inspection Item) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：检验项目管理 (Inspection Item)\r\n**所属子系统**：质量主数据模块 (Quality Master Data)\r\n**目标**：用于统一定义 QMS 系统中所有可能被用于测量的最小检测单元。支持不同数据类型（计量型/计数型）、不同的量测分类及严格的多工厂组织权限隔离机制。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 整体布局\r\n采用经典的上栏查询、中栏工具、下栏数据的管理界面。\r\n- **高级过滤扩展**：由于检验项目的属性特征复杂，查询区域支持基础检索并提供了“展开/收起”功能的辅助区，可按数据类型、所属组织域等多条件进一步复合过滤。\r\n\r\n### 2.2 表格与色彩展示\r\n- **所属组织过滤控制**：引入多选的组织选择器（合肥工厂、芜湖工厂等）。通过 `a-tag` 将跨越组织（如“集团”项目）和车间级别的项目以醒目色彩划分。\r\n- **参数标记机制**：利用小巧醒目的标签 (`flags`) 快速呈现该检验项目是否承接 SPC 或者实验测试业务的核心挂载点（`isSpcDefault` 和 `isLabTestDefault`）。\r\n- **数据约束识别**：为 `计量型（Quantitative）` 提供浅蓝色标识，对 `计数型（Qualitative）` 提供紫色标识处理，并依据类型强制关联是否有计量单位 (UOM)。\r\n\r\n## 3. 核心功能设计\r\n### 3.1 跨级权限的编辑拦截机制\r\n- 系统的组织采用集团化分布。用户 `orgId` 若无跨级编辑权限，当点击诸如“集团级”标准检验项目时，操作列的编辑和删除会被拦截（逻辑 `canEdit()` 控制），只能只读查看或应用该标准项，而不能直接修改母版数据。\r\n\r\n### 3.2 不良缺陷挂勾模型 (Defect Phenomenon Link)\r\n- 增加了“不良现象” (Defect Phenomenon) 关联页签维护功能。针对某个质检项目可能导致的所有失效现象（如测表面外观时导致“划伤”、“破损”现象），支持进行先验绑定，缩短后续开具不合格单 (NC) 的选取时间。\r\n\r\n## 4. 数据模型 (Data Model)\r\n核心实体 `InspectionItem` 属性定义：\r\n- `id`: 项目内部主键\r\n- `code`: 项目唯一编码\r\n- `name`: 检测特征名称\r\n- `orgId`: 归属组织 (集团则为 null)\r\n- `category`: 分类，含：尺寸(`dimension`)、外观(`appearance`)、理化(`physical_chemical`)、功能(`functional`)\r\n- `dataType`: 数据定性方式 (`quantitative` 或 `qualitative`)\r\n- `uom`: 单位（仅当 `dataType` 为计量型强绑定）\r\n- `defaultMethodId`: 缺省验证和操作指导参考的方法卡ID\r\n- `status`: 生命周期\r\n\r\n## 5. 约束与规则\r\n- **强类型录入检查**：若 `dataType` 选为 `qualitative` 此时 UOM 输入框为被完全禁用。\r\n- **跨模块限制**：一旦该检验项目在生效的抽样方案体系或检验模板内被调用，系统逻辑底座原则上不允许再做删除动作（只能转为 obsolete/disabled 归档）。\r\n",Ye=`# 质量检验计划与方案方案 (Inspection Plan & Scheme) - 详细设计文档\r
\r
## 1. 模块概述\r
**模块名称**：质量检验计划管理 (Inspection Plan/Scheme)\r
**所属子系统**：质量主数据模块 (Quality Master Data)\r
**目标**：统筹 IQC、IPQC、FQC 与 OQC 等全工艺制程检验的纲领性顶层设计。它是最重要的高维聚合主数据。它将之前单独定义的【检验项目】、【检验方法】和【AQL 抽样规则】按照某种逻辑组合并打包为一个供一线使用的一体化检验套件。\r
\r
## 2. 界面布局与交互设计\r
### 2.1 高级查询与状态总览\r
使用了完整的查询面版：\r
- **方案状态过滤**：草稿(Draft), 审批中(In Approval), 已批准(Approved), 已作废(Obsolete)。\r
- **多组织归属过滤 (\`orgIds\`)**：支持使用 Multi-select 联合查询多个归属地（集团、合肥工厂等）下的质量预案。\r
\r
### 2.2 独创的副本复制向导 (Clone/Copy Modal)\r
由于检验预案往往极其繁复庞大（包含成百上千条特征规格校验），在 UI 交互中设计了专属的【复制方案】组件功能：\r
- 提供源名称提示。\r
- 提供输入新的 \`目标编码\` 和 \`目标名称\` 的表单卡，并**可以变更归属组织域**（即集团标准的方案允许被轻松复制为特定地方工厂的执行标准草稿）。\r
\r
## 3. 核心功能设计\r
### 3.1 工作流级生命周期管理\r
该页面抛弃了简单的“启用/禁用”，通过引入标准的文件受控审批概念：\r
1. **DRAFT (草稿)**：系统独家用此状态，保证只有该状态的计划方案可以被“编辑”。\r
2. **IN_APPROVAL (审批中)**：方案经编撰人员提交后的状态锁定。\r
3. **APPROVED (执行态/已批准)**：允许被应用到各类产线出货端。一旦进入此状态，本页面内的任何编辑动作都会被直接拉黑防呆，防止执行期篡改标准。\r
4. **OBSOLETE (作废)**。\r
\r
### 3.2 集团与工厂层级的重用继承保护（Group vs Factory）\r
- **隔离规则**：对属于集团级定义 (\`orgId === null\`) 的原版检验方案，所有厂级质量人员可以在列表中查看，但绝对**不允许直接编辑和删除**（即使用户尝试点击或破解触发编辑API，也会被代码 \`canEdit\` 或表单级的守卫给拦截）。\r
- **破局方式**：工厂用户可通过上文提到的**『一键复制』**将高级别通用标准拷贝，衍生出本厂特有的 DRAFT 版再进行改写与使用。\r
\r
### 3.3 检验明细的模板挂载与深度定制\r
- **模板引用与快速加载**：在新增或编辑检验方案时，支持在基础信息区域直接关联已配置好的【检验模板 (\`templateId\`)】。关联后，系统可将该检验模板下挂载的海量“标准检验项明细”一键快速加载、引入到当前检验方案中。\r
- **自定义后续编辑**：被加载进方案的检验明细，实质上脱离了原模板的强绑定束缚，变为了当前方案的实例级数据。质量主观或测试配置工程师随后可在**方案编辑详情**的“明细列表”页签下，针对这些衍生引入的项目，任意进行继续编辑调整（如设定是否强制实验室测试、单独剥离或增加部分特征），使得计划具备极其灵活的微调能力，兼顾了规范性和灵活性。\r
\r
## 4. 数据模型 (Data Model)\r
此页为高维路由枢纽，核心实体 \`InspectionPlan\` 表字段概念包括：\r
- \`id\`: 表主键\r
- \`orgId\`: 数据控制域隔离字段\r
- \`planCode\`: 检验大纲号\r
- \`planName\`: 方案中文全称\r
- \`version\`: 技术版本号(管控追溯)\r
- \`inspType\`: 检验过程类型（\`IQC/IPQC/FQC/OQC\`）\r
- \`templateName\`: 引用的底层检测表原始模板外键名称\r
- \`status\`: 生命周期。\r
\r
> **关联特性**：在这个抽象记录的下方（通过进入编辑/查看的方案详细页面），将挂接着多对多形态的 \`检验特征列表\`、对应的 \`AQL 放行细则\` 以及 \`特定料号库\` 匹配规则。\r
\r
## 5. 约束与规则\r
- **变更追溯**：正在使用的 \`APPROVED\` 状态绝不允许覆盖修改。任何技术调整必须通过修改原本生成 \`OBSOLETE\` 或重新生成递进高版本号的副本。\r
- **引用防呆**：如果某个物料主数据的免检配置或检验绑定已指配到了该方案，则此方案必须处于 \`APPROVED\` 安全状态。\r
`,Je="# 量检具台账与类型管理 (Gauge Ledger) - 详细设计文档\r\n\r\n## 1. 模块概述\r\n**模块名称**：量检具管理台账与层级树\r\n**所属子系统**：质量主数据模块 (Quality Master Data) / 检验支持模块\r\n**目标**：构建全厂测量系统资产（卡尺、硬度仪、三坐标等设备）的全生命周期管理跟踪卡。支持设备的层级分类、高精度测量属性配置并核心支撑MSA（测量系统分析）的依赖前提和定期设备送校提醒。\r\n\r\n## 2. 界面布局与交互设计\r\n### 2.1 “左树右表” 复杂布局 (Split Layout)\r\n页面布局采用了高频的高级左树右表结构：\r\n- **左侧容器 (Left Panel - Tree)**：使用 `a-tree` 组建渲染量检具分类树。\r\n  - 支持节点过滤搜索（如输入“卡尺”过滤树状节点）。\r\n  - 在每个节点上支持悬浮动作组（新增子类、编辑本类、删除大类）。\r\n- **右侧工作台 (Right Panel - Ledger List)**：设备明细列表。\r\n  - 只有在选中左侧设备类目后，右侧才会呈现挂属于此品类或此族系下的设备实体。\r\n  - 带有醒目的表头展示目前选中的大类其精度或“是否需MSA”。\r\n\r\n### 2.2 视觉驱动的阈值警告\r\n在量检具中，“校准到期监控”是最为关键的质量管理动作。\r\n- 在表格和详情中渲染 `nextCalDate` 时加入强校验逻辑：\r\n  - 如果日期已逾期 ( `<0 days` )：使用红色警报 `red`\r\n  - 如果在即将逾期范围内 ( `<14 days` )：使用警戒色 `orange`\r\n  - 正常在案：绿色 `green`\r\n\r\n## 3. 核心功能设计\r\n### 3.1 量检具类型属性定义 (Gauge Type Tree)\r\n类型不仅仅是个文本标签，他附带两大质量属性：\r\n- `precision` (分辨率/精度)：如0.01mm，这个精度将直接预设到新建的具体卡尺上。\r\n- `isMsaRequired` (是否需要MSA校验)：布尔值控制，如果是，未来在进行 GR&R 试验分析时，该类的设备才会被强制要求挑选出做验证。\r\n\r\n### 3.2 周期性校验 (Calibration Cycle)\r\n这部分由核心的生命周期字段控制：\r\n- `status`: 在用、校准中、封存、报废。\r\n- 如果设备状态被标记为`CALIBRATING`(校准中)或`SCRAPPED`(报废)，在检验员准备做 IPQC/OQC 选择所用设备输入时，下拉框会对其进行自动防呆拦截，不可选用。\r\n\r\n## 4. 数据模型 (Data Model)\r\n**类型节点实体 (`GaugeType`)**:\r\n- `id`, `parentId`, `typeName`: 维护无限极树的基础。\r\n- `precision`: 缺省精度\r\n- `isMsaRequired`: 强制MSA分析标记\r\n\r\n**量检具台账明细 (`GaugeLedger`)**:\r\n- `gaugeNo`: 设备唯一资产编号\r\n- `gaugeName`, `model`, `manufacturer`: 基本名牌参数\r\n- `accuracy`, `resolution`, `measureRange`: 测定边界能力\r\n- `calibrationCycle`: 周期(比如 12个月)\r\n- `lastCalDate`: 上次强检时间\r\n- `nextCalDate`: 证书失效/下次强检时间(触发报警核心字段)\r\n- `status`: 生命周期（`IN_USE`, `CALIBRATING`, `SEALED`, `SCRAPPED`）\r\n- `custodian`, `location`: 物理存放与保管责任追踪。\r\n\r\n## 5. 约束与规则\r\n- **强校准阻断**：当 `nextCalDate` 已过期，其对应的台账状态建议必须进入锁定态，不得在生产检验流程的下拉列表中再被选中作为“测定依据”，否则极易导致产品错漏判的质量事故。\r\n- **关联删除限制**：如果要删除左侧树节点类型时，系统必须防呆确保其下面未挂靠任何存量（哪怕是报废的）台账。\r\n";function X(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var D=X();function fe(r){D=r}var A={exec:()=>null};function k(r,e=""){let n=typeof r=="string"?r:r.source,s={replace:(t,i)=>{let l=typeof i=="string"?i:i.source;return l=l.replace(w.caret,"$1"),n=n.replace(t,l),s},getRegex:()=>new RegExp(n,e)};return s}var en=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),w={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i"),blockquoteBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}>`)},nn=/^(?:[ \t]*(?:\n|$))+/,rn=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,tn=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,B=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,sn=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Y=/ {0,3}(?:[*+-]|\d{1,9}[.)])/,me=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,xe=k(me).replace(/bull/g,Y).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),an=k(me).replace(/bull/g,Y).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),J=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ln=/^[^\n]+/,ee=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,on=k(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ee).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),cn=k(/^(bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Y).getRegex(),U="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ne=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,pn=k("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ne).replace("tag",U).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),be=k(J).replace("hr",B).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U).getRegex(),hn=k(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",be).getRegex(),re={blockquote:hn,code:rn,def:on,fences:tn,heading:sn,hr:B,html:pn,lheading:xe,list:cn,newline:nn,paragraph:be,table:A,text:ln},pe=k("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",B).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U).getRegex(),un={...re,lheading:an,table:pe,paragraph:k(J).replace("hr",B).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",pe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)])[ \\t]").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",U).getRegex()},dn={...re,html:k(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ne).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:A,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:k(J).replace("hr",B).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xe).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},gn=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,kn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,we=/^( {2,}|\\)\n(?!\s*$)/,fn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Z=/[\p{P}\p{S}]/u,te=/[\s\p{P}\p{S}]/u,ye=/[^\s\p{P}\p{S}]/u,mn=k(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,te).getRegex(),Se=/(?!~)[\p{P}\p{S}]/u,xn=/(?!~)[\s\p{P}\p{S}]/u,bn=/(?:[^\s\p{P}\p{S}]|~)/u,_e=/(?![*_])[\p{P}\p{S}]/u,wn=/(?![*_])[\s\p{P}\p{S}]/u,yn=/(?:[^\s\p{P}\p{S}]|[*_])/u,Sn=k(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",en?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),Re=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,_n=k(Re,"u").replace(/punct/g,Z).getRegex(),Rn=k(Re,"u").replace(/punct/g,Se).getRegex(),Pe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Pn=k(Pe,"gu").replace(/notPunctSpace/g,ye).replace(/punctSpace/g,te).replace(/punct/g,Z).getRegex(),In=k(Pe,"gu").replace(/notPunctSpace/g,bn).replace(/punctSpace/g,xn).replace(/punct/g,Se).getRegex(),Cn=k("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ye).replace(/punctSpace/g,te).replace(/punct/g,Z).getRegex(),An=k(/^~~?(?:((?!~)punct)|[^\s~])/,"u").replace(/punct/g,_e).getRegex(),Tn="^[^~]+(?=[^~])|(?!~)punct(~~?)(?=[\\s]|$)|notPunctSpace(~~?)(?!~)(?=punctSpace|$)|(?!~)punctSpace(~~?)(?=notPunctSpace)|[\\s](~~?)(?!~)(?=punct)|(?!~)punct(~~?)(?!~)(?=punct)|notPunctSpace(~~?)(?=notPunctSpace)",Dn=k(Tn,"gu").replace(/notPunctSpace/g,yn).replace(/punctSpace/g,wn).replace(/punct/g,_e).getRegex(),vn=k(/\\(punct)/,"gu").replace(/punct/g,Z).getRegex(),$n=k(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Mn=k(ne).replace("(?:-->|$)","-->").getRegex(),Qn=k("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Mn).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),q=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,Ln=k(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",q).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ie=k(/^!?\[(label)\]\[(ref)\]/).replace("label",q).replace("ref",ee).getRegex(),Ce=k(/^!?\[(ref)\](?:\[\])?/).replace("ref",ee).getRegex(),zn=k("reflink|nolink(?!\\()","g").replace("reflink",Ie).replace("nolink",Ce).getRegex(),he=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,se={_backpedal:A,anyPunctuation:vn,autolink:$n,blockSkip:Sn,br:we,code:kn,del:A,delLDelim:A,delRDelim:A,emStrongLDelim:_n,emStrongRDelimAst:Pn,emStrongRDelimUnd:Cn,escape:gn,link:Ln,nolink:Ce,punctuation:mn,reflink:Ie,reflinkSearch:zn,tag:Qn,text:fn,url:A},En={...se,link:k(/^!?\[(label)\]\((.*?)\)/).replace("label",q).getRegex(),reflink:k(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",q).getRegex()},j={...se,emStrongRDelimAst:In,emStrongLDelim:Rn,delLDelim:An,delRDelim:Dn,url:k(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",he).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:k(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",he).getRegex()},Bn={...j,br:k(we).replace("{2,}","*").getRegex(),text:k(j.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},O={normal:re,gfm:un,pedantic:dn},L={normal:se,gfm:j,breaks:Bn,pedantic:En},On={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ue=r=>On[r];function R(r,e){if(e){if(w.escapeTest.test(r))return r.replace(w.escapeReplace,ue)}else if(w.escapeTestNoEncode.test(r))return r.replace(w.escapeReplaceNoEncode,ue);return r}function de(r){try{r=encodeURI(r).replace(w.percentDecode,"%")}catch{return null}return r}function ge(r,e){var i;let n=r.replace(w.findPipe,(l,a,c)=>{let o=!1,h=a;for(;--h>=0&&c[h]==="\\";)o=!o;return o?"|":" |"}),s=n.split(w.splitPipe),t=0;if(s[0].trim()||s.shift(),s.length>0&&!((i=s.at(-1))!=null&&i.trim())&&s.pop(),e)if(s.length>e)s.splice(e);else for(;s.length<e;)s.push("");for(;t<s.length;t++)s[t]=s[t].trim().replace(w.slashPipe,"|");return s}function z(r,e,n){let s=r.length;if(s===0)return"";let t=0;for(;t<s&&r.charAt(s-t-1)===e;)t++;return r.slice(0,s-t)}function Nn(r,e){if(r.indexOf(e[1])===-1)return-1;let n=0;for(let s=0;s<r.length;s++)if(r[s]==="\\")s++;else if(r[s]===e[0])n++;else if(r[s]===e[1]&&(n--,n<0))return s;return n>0?-2:-1}function qn(r,e=0){let n=e,s="";for(let t of r)if(t==="	"){let i=4-n%4;s+=" ".repeat(i),n+=i}else s+=t,n++;return s}function ke(r,e,n,s,t){let i=e.href,l=e.title||null,a=r[1].replace(t.other.outputLinkReplace,"$1");s.state.inLink=!0;let c={type:r[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:l,text:a,tokens:s.inlineTokens(a)};return s.state.inLink=!1,c}function Gn(r,e,n){let s=r.match(n.other.indentCodeCompensation);if(s===null)return e;let t=s[1];return e.split(`
`).map(i=>{let l=i.match(n.other.beginningSpace);if(l===null)return i;let[a]=l;return a.length>=t.length?i.slice(t.length):i}).join(`
`)}var G=class{constructor(r){x(this,"options");x(this,"rules");x(this,"lexer");this.options=r||D}space(r){let e=this.rules.block.newline.exec(r);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(r){let e=this.rules.block.code.exec(r);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:z(n,`
`)}}}fences(r){let e=this.rules.block.fences.exec(r);if(e){let n=e[0],s=Gn(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:s}}}heading(r){let e=this.rules.block.heading.exec(r);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let s=z(n,"#");(this.options.pedantic||!s||this.rules.other.endingSpaceChar.test(s))&&(n=s.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(r){let e=this.rules.block.hr.exec(r);if(e)return{type:"hr",raw:z(e[0],`
`)}}blockquote(r){let e=this.rules.block.blockquote.exec(r);if(e){let n=z(e[0],`
`).split(`
`),s="",t="",i=[];for(;n.length>0;){let l=!1,a=[],c;for(c=0;c<n.length;c++)if(this.rules.other.blockquoteStart.test(n[c]))a.push(n[c]),l=!0;else if(!l)a.push(n[c]);else break;n=n.slice(c);let o=a.join(`
`),h=o.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");s=s?`${s}
${o}`:o,t=t?`${t}
${h}`:h;let d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,i,!0),this.lexer.state.top=d,n.length===0)break;let u=i.at(-1);if((u==null?void 0:u.type)==="code")break;if((u==null?void 0:u.type)==="blockquote"){let p=u,m=p.raw+`
`+n.join(`
`),g=this.blockquote(m);i[i.length-1]=g,s=s.substring(0,s.length-p.raw.length)+g.raw,t=t.substring(0,t.length-p.text.length)+g.text;break}else if((u==null?void 0:u.type)==="list"){let p=u,m=p.raw+`
`+n.join(`
`),g=this.list(m);i[i.length-1]=g,s=s.substring(0,s.length-u.raw.length)+g.raw,t=t.substring(0,t.length-p.raw.length)+g.raw,n=m.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:s,tokens:i,text:t}}}list(r){var n,s;let e=this.rules.block.list.exec(r);if(e){let t=e[1].trim(),i=t.length>1,l={type:"list",raw:"",ordered:i,start:i?+t.slice(0,-1):"",loose:!1,items:[]};t=i?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=i?t:"[*+-]");let a=this.rules.other.listItemRegex(t),c=!1;for(;r;){let h=!1,d="",u="";if(!(e=a.exec(r))||this.rules.block.hr.test(r))break;d=e[0],r=r.substring(d.length);let p=qn(e[2].split(`
`,1)[0],e[1].length),m=r.split(`
`,1)[0],g=!p.trim(),b=0;if(this.options.pedantic?(b=2,u=p.trimStart()):g?b=e[1].length+1:(b=p.search(this.rules.other.nonSpaceChar),b=b>4?1:b,u=p.slice(b),b+=e[1].length),g&&this.rules.other.blankLine.test(m)&&(d+=m+`
`,r=r.substring(m.length+1),h=!0),!h){let _=this.rules.other.nextBulletRegex(b),v=this.rules.other.hrRegex(b),I=this.rules.other.fencesBeginRegex(b),P=this.rules.other.headingBeginRegex(b),V=this.rules.other.htmlBeginRegex(b),Ae=this.rules.other.blockquoteBeginRegex(b);for(;r;){let H=r.split(`
`,1)[0],M;if(m=H,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),M=m):M=m.replace(this.rules.other.tabCharGlobal,"    "),I.test(m)||P.test(m)||V.test(m)||Ae.test(m)||_.test(m)||v.test(m))break;if(M.search(this.rules.other.nonSpaceChar)>=b||!m.trim())u+=`
`+M.slice(b);else{if(g||p.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||I.test(p)||P.test(p)||v.test(p))break;u+=`
`+m}g=!m.trim(),d+=H+`
`,r=r.substring(H.length+1),p=M.slice(b)}}l.loose||(c?l.loose=!0:this.rules.other.doubleBlankLine.test(d)&&(c=!0)),l.items.push({type:"list_item",raw:d,task:!!this.options.gfm&&this.rules.other.listIsTask.test(u),loose:!1,text:u,tokens:[]}),l.raw+=d}let o=l.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;l.raw=l.raw.trimEnd();for(let h of l.items){if(this.lexer.state.top=!1,h.tokens=this.lexer.blockTokens(h.text,[]),h.task){if(h.text=h.text.replace(this.rules.other.listReplaceTask,""),((n=h.tokens[0])==null?void 0:n.type)==="text"||((s=h.tokens[0])==null?void 0:s.type)==="paragraph"){h.tokens[0].raw=h.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),h.tokens[0].text=h.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let u=this.lexer.inlineQueue.length-1;u>=0;u--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[u].src)){this.lexer.inlineQueue[u].src=this.lexer.inlineQueue[u].src.replace(this.rules.other.listReplaceTask,"");break}}let d=this.rules.other.listTaskCheckbox.exec(h.raw);if(d){let u={type:"checkbox",raw:d[0]+" ",checked:d[0]!=="[ ]"};h.checked=u.checked,l.loose?h.tokens[0]&&["paragraph","text"].includes(h.tokens[0].type)&&"tokens"in h.tokens[0]&&h.tokens[0].tokens?(h.tokens[0].raw=u.raw+h.tokens[0].raw,h.tokens[0].text=u.raw+h.tokens[0].text,h.tokens[0].tokens.unshift(u)):h.tokens.unshift({type:"paragraph",raw:u.raw,text:u.raw,tokens:[u]}):h.tokens.unshift(u)}}if(!l.loose){let d=h.tokens.filter(p=>p.type==="space"),u=d.length>0&&d.some(p=>this.rules.other.anyLine.test(p.raw));l.loose=u}}if(l.loose)for(let h of l.items){h.loose=!0;for(let d of h.tokens)d.type==="text"&&(d.type="paragraph")}return l}}html(r){let e=this.rules.block.html.exec(r);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(r){let e=this.rules.block.def.exec(r);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),s=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",t=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:s,title:t}}}table(r){var l;let e=this.rules.block.table.exec(r);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=ge(e[1]),s=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),t=(l=e[3])!=null&&l.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===s.length){for(let a of s)this.rules.other.tableAlignRight.test(a)?i.align.push("right"):this.rules.other.tableAlignCenter.test(a)?i.align.push("center"):this.rules.other.tableAlignLeft.test(a)?i.align.push("left"):i.align.push(null);for(let a=0;a<n.length;a++)i.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:i.align[a]});for(let a of t)i.rows.push(ge(a,i.header.length).map((c,o)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:i.align[o]})));return i}}lheading(r){let e=this.rules.block.lheading.exec(r);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(r){let e=this.rules.block.paragraph.exec(r);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(r){let e=this.rules.block.text.exec(r);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(r){let e=this.rules.inline.escape.exec(r);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(r){let e=this.rules.inline.tag.exec(r);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(r){let e=this.rules.inline.link.exec(r);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let i=z(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{let i=Nn(e[2],"()");if(i===-2)return;if(i>-1){let l=(e[0].indexOf("!")===0?5:4)+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let s=e[2],t="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(s);i&&(s=i[1],t=i[3])}else t=e[3]?e[3].slice(1,-1):"";return s=s.trim(),this.rules.other.startAngleBracket.test(s)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?s=s.slice(1):s=s.slice(1,-1)),ke(e,{href:s&&s.replace(this.rules.inline.anyPunctuation,"$1"),title:t&&t.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(r,e){let n;if((n=this.rules.inline.reflink.exec(r))||(n=this.rules.inline.nolink.exec(r))){let s=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),t=e[s.toLowerCase()];if(!t){let i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return ke(n,t,n[0],this.lexer,this.rules)}}emStrong(r,e,n=""){let s=this.rules.inline.emStrongLDelim.exec(r);if(!(!s||s[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(s[1]||s[2])||!n||this.rules.inline.punctuation.exec(n))){let t=[...s[0]].length-1,i,l,a=t,c=0,o=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(o.lastIndex=0,e=e.slice(-1*r.length+t);(s=o.exec(e))!=null;){if(i=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!i)continue;if(l=[...i].length,s[3]||s[4]){a+=l;continue}else if((s[5]||s[6])&&t%3&&!((t+l)%3)){c+=l;continue}if(a-=l,a>0)continue;l=Math.min(l,l+a+c);let h=[...s[0]][0].length,d=r.slice(0,t+s.index+h+l);if(Math.min(t,l)%2){let p=d.slice(1,-1);return{type:"em",raw:d,text:p,tokens:this.lexer.inlineTokens(p)}}let u=d.slice(2,-2);return{type:"strong",raw:d,text:u,tokens:this.lexer.inlineTokens(u)}}}}codespan(r){let e=this.rules.inline.code.exec(r);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),s=this.rules.other.nonSpaceChar.test(n),t=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return s&&t&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(r){let e=this.rules.inline.br.exec(r);if(e)return{type:"br",raw:e[0]}}del(r,e,n=""){let s=this.rules.inline.delLDelim.exec(r);if(s&&(!s[1]||!n||this.rules.inline.punctuation.exec(n))){let t=[...s[0]].length-1,i,l,a=t,c=this.rules.inline.delRDelim;for(c.lastIndex=0,e=e.slice(-1*r.length+t);(s=c.exec(e))!=null;){if(i=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!i||(l=[...i].length,l!==t))continue;if(s[3]||s[4]){a+=l;continue}if(a-=l,a>0)continue;l=Math.min(l,l+a);let o=[...s[0]][0].length,h=r.slice(0,t+s.index+o+l),d=h.slice(t,-t);return{type:"del",raw:h,text:d,tokens:this.lexer.inlineTokens(d)}}}}autolink(r){let e=this.rules.inline.autolink.exec(r);if(e){let n,s;return e[2]==="@"?(n=e[1],s="mailto:"+n):(n=e[1],s=n),{type:"link",raw:e[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(r){var n;let e;if(e=this.rules.inline.url.exec(r)){let s,t;if(e[2]==="@")s=e[0],t="mailto:"+s;else{let i;do i=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(i!==e[0]);s=e[0],e[1]==="www."?t="http://"+e[0]:t=e[0]}return{type:"link",raw:e[0],text:s,href:t,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(r){let e=this.rules.inline.text.exec(r);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},y=class K{constructor(e){x(this,"tokens");x(this,"options");x(this,"state");x(this,"inlineQueue");x(this,"tokenizer");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||D,this.options.tokenizer=this.options.tokenizer||new G,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let n={other:w,block:O.normal,inline:L.normal};this.options.pedantic?(n.block=O.pedantic,n.inline=L.pedantic):this.options.gfm&&(n.block=O.gfm,this.options.breaks?n.inline=L.breaks:n.inline=L.gfm),this.tokenizer.rules=n}static get rules(){return{block:O,inline:L}}static lex(e,n){return new K(n).lex(e)}static lexInline(e,n){return new K(n).inlineTokens(e)}lex(e){e=e.replace(w.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){let s=this.inlineQueue[n];this.inlineTokens(s.src,s.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],s=!1){var t,i,l;for(this.options.pedantic&&(e=e.replace(w.tabCharGlobal,"    ").replace(w.spaceLine,""));e;){let a;if((i=(t=this.options.extensions)==null?void 0:t.block)!=null&&i.some(o=>(a=o.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);let o=n.at(-1);a.raw.length===1&&o!==void 0?o.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);let o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+a.raw,o.text+=`
`+a.text,this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);let o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+a.raw,o.text+=`
`+a.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},n.push(a));continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let c=e;if((l=this.options.extensions)!=null&&l.startBlock){let o=1/0,h=e.slice(1),d;this.options.extensions.startBlock.forEach(u=>{d=u.call({lexer:this},h),typeof d=="number"&&d>=0&&(o=Math.min(o,d))}),o<1/0&&o>=0&&(c=e.substring(0,o+1))}if(this.state.top&&(a=this.tokenizer.paragraph(c))){let o=n.at(-1);s&&(o==null?void 0:o.type)==="paragraph"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a),s=c.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);let o=n.at(-1);(o==null?void 0:o.type)==="text"?(o.raw+=(o.raw.endsWith(`
`)?"":`
`)+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(e){let o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var c,o,h,d,u;let s=e,t=null;if(this.tokens.links){let p=Object.keys(this.tokens.links);if(p.length>0)for(;(t=this.tokenizer.rules.inline.reflinkSearch.exec(s))!=null;)p.includes(t[0].slice(t[0].lastIndexOf("[")+1,-1))&&(s=s.slice(0,t.index)+"["+"a".repeat(t[0].length-2)+"]"+s.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(t=this.tokenizer.rules.inline.anyPunctuation.exec(s))!=null;)s=s.slice(0,t.index)+"++"+s.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(t=this.tokenizer.rules.inline.blockSkip.exec(s))!=null;)i=t[2]?t[2].length:0,s=s.slice(0,t.index+i)+"["+"a".repeat(t[0].length-i-2)+"]"+s.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);s=((o=(c=this.options.hooks)==null?void 0:c.emStrongMask)==null?void 0:o.call({lexer:this},s))??s;let l=!1,a="";for(;e;){l||(a=""),l=!1;let p;if((d=(h=this.options.extensions)==null?void 0:h.inline)!=null&&d.some(g=>(p=g.call({lexer:this},e,n))?(e=e.substring(p.raw.length),n.push(p),!0):!1))continue;if(p=this.tokenizer.escape(e)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.tag(e)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.link(e)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(p.raw.length);let g=n.at(-1);p.type==="text"&&(g==null?void 0:g.type)==="text"?(g.raw+=p.raw,g.text+=p.text):n.push(p);continue}if(p=this.tokenizer.emStrong(e,s,a)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.codespan(e)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.br(e)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.del(e,s,a)){e=e.substring(p.raw.length),n.push(p);continue}if(p=this.tokenizer.autolink(e)){e=e.substring(p.raw.length),n.push(p);continue}if(!this.state.inLink&&(p=this.tokenizer.url(e))){e=e.substring(p.raw.length),n.push(p);continue}let m=e;if((u=this.options.extensions)!=null&&u.startInline){let g=1/0,b=e.slice(1),_;this.options.extensions.startInline.forEach(v=>{_=v.call({lexer:this},b),typeof _=="number"&&_>=0&&(g=Math.min(g,_))}),g<1/0&&g>=0&&(m=e.substring(0,g+1))}if(p=this.tokenizer.inlineText(m)){e=e.substring(p.raw.length),p.raw.slice(-1)!=="_"&&(a=p.raw.slice(-1)),l=!0;let g=n.at(-1);(g==null?void 0:g.type)==="text"?(g.raw+=p.raw,g.text+=p.text):n.push(p);continue}if(e){let g="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(g);break}else throw new Error(g)}}return n}},F=class{constructor(r){x(this,"options");x(this,"parser");this.options=r||D}space(r){return""}code({text:r,lang:e,escaped:n}){var i;let s=(i=(e||"").match(w.notSpaceStart))==null?void 0:i[0],t=r.replace(w.endingNewline,"")+`
`;return s?'<pre><code class="language-'+R(s)+'">'+(n?t:R(t,!0))+`</code></pre>
`:"<pre><code>"+(n?t:R(t,!0))+`</code></pre>
`}blockquote({tokens:r}){return`<blockquote>
${this.parser.parse(r)}</blockquote>
`}html({text:r}){return r}def(r){return""}heading({tokens:r,depth:e}){return`<h${e}>${this.parser.parseInline(r)}</h${e}>
`}hr(r){return`<hr>
`}list(r){let e=r.ordered,n=r.start,s="";for(let l=0;l<r.items.length;l++){let a=r.items[l];s+=this.listitem(a)}let t=e?"ol":"ul",i=e&&n!==1?' start="'+n+'"':"";return"<"+t+i+`>
`+s+"</"+t+`>
`}listitem(r){return`<li>${this.parser.parse(r.tokens)}</li>
`}checkbox({checked:r}){return"<input "+(r?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:r}){return`<p>${this.parser.parseInline(r)}</p>
`}table(r){let e="",n="";for(let t=0;t<r.header.length;t++)n+=this.tablecell(r.header[t]);e+=this.tablerow({text:n});let s="";for(let t=0;t<r.rows.length;t++){let i=r.rows[t];n="";for(let l=0;l<i.length;l++)n+=this.tablecell(i[l]);s+=this.tablerow({text:n})}return s&&(s=`<tbody>${s}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+s+`</table>
`}tablerow({text:r}){return`<tr>
${r}</tr>
`}tablecell(r){let e=this.parser.parseInline(r.tokens),n=r.header?"th":"td";return(r.align?`<${n} align="${r.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:r}){return`<strong>${this.parser.parseInline(r)}</strong>`}em({tokens:r}){return`<em>${this.parser.parseInline(r)}</em>`}codespan({text:r}){return`<code>${R(r,!0)}</code>`}br(r){return"<br>"}del({tokens:r}){return`<del>${this.parser.parseInline(r)}</del>`}link({href:r,title:e,tokens:n}){let s=this.parser.parseInline(n),t=de(r);if(t===null)return s;r=t;let i='<a href="'+r+'"';return e&&(i+=' title="'+R(e)+'"'),i+=">"+s+"</a>",i}image({href:r,title:e,text:n,tokens:s}){s&&(n=this.parser.parseInline(s,this.parser.textRenderer));let t=de(r);if(t===null)return R(n);r=t;let i=`<img src="${r}" alt="${R(n)}"`;return e&&(i+=` title="${R(e)}"`),i+=">",i}text(r){return"tokens"in r&&r.tokens?this.parser.parseInline(r.tokens):"escaped"in r&&r.escaped?r.text:R(r.text)}},ae=class{strong({text:r}){return r}em({text:r}){return r}codespan({text:r}){return r}del({text:r}){return r}html({text:r}){return r}text({text:r}){return r}link({text:r}){return""+r}image({text:r}){return""+r}br(){return""}checkbox({raw:r}){return r}},S=class W{constructor(e){x(this,"options");x(this,"renderer");x(this,"textRenderer");this.options=e||D,this.options.renderer=this.options.renderer||new F,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ae}static parse(e,n){return new W(n).parse(e)}static parseInline(e,n){return new W(n).parseInline(e)}parse(e){var s,t;let n="";for(let i=0;i<e.length;i++){let l=e[i];if((t=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&t[l.type]){let c=l,o=this.options.extensions.renderers[c.type].call({parser:this},c);if(o!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(c.type)){n+=o||"";continue}}let a=l;switch(a.type){case"space":{n+=this.renderer.space(a);break}case"hr":{n+=this.renderer.hr(a);break}case"heading":{n+=this.renderer.heading(a);break}case"code":{n+=this.renderer.code(a);break}case"table":{n+=this.renderer.table(a);break}case"blockquote":{n+=this.renderer.blockquote(a);break}case"list":{n+=this.renderer.list(a);break}case"checkbox":{n+=this.renderer.checkbox(a);break}case"html":{n+=this.renderer.html(a);break}case"def":{n+=this.renderer.def(a);break}case"paragraph":{n+=this.renderer.paragraph(a);break}case"text":{n+=this.renderer.text(a);break}default:{let c='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}parseInline(e,n=this.renderer){var t,i;let s="";for(let l=0;l<e.length;l++){let a=e[l];if((i=(t=this.options.extensions)==null?void 0:t.renderers)!=null&&i[a.type]){let o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){s+=o||"";continue}}let c=a;switch(c.type){case"escape":{s+=n.text(c);break}case"html":{s+=n.html(c);break}case"link":{s+=n.link(c);break}case"image":{s+=n.image(c);break}case"checkbox":{s+=n.checkbox(c);break}case"strong":{s+=n.strong(c);break}case"em":{s+=n.em(c);break}case"codespan":{s+=n.codespan(c);break}case"br":{s+=n.br(c);break}case"del":{s+=n.del(c);break}case"text":{s+=n.text(c);break}default:{let o='Token with "'+c.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return s}},N,E=(N=class{constructor(r){x(this,"options");x(this,"block");this.options=r||D}preprocess(r){return r}postprocess(r){return r}processAllTokens(r){return r}emStrongMask(r){return r}provideLexer(){return this.block?y.lex:y.lexInline}provideParser(){return this.block?S.parse:S.parseInline}},x(N,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens","emStrongMask"])),x(N,"passThroughHooksRespectAsync",new Set(["preprocess","postprocess","processAllTokens"])),N),Fn=class{constructor(...r){x(this,"defaults",X());x(this,"options",this.setOptions);x(this,"parse",this.parseMarkdown(!0));x(this,"parseInline",this.parseMarkdown(!1));x(this,"Parser",S);x(this,"Renderer",F);x(this,"TextRenderer",ae);x(this,"Lexer",y);x(this,"Tokenizer",G);x(this,"Hooks",E);this.use(...r)}walkTokens(r,e){var s,t;let n=[];for(let i of r)switch(n=n.concat(e.call(this,i)),i.type){case"table":{let l=i;for(let a of l.header)n=n.concat(this.walkTokens(a.tokens,e));for(let a of l.rows)for(let c of a)n=n.concat(this.walkTokens(c.tokens,e));break}case"list":{let l=i;n=n.concat(this.walkTokens(l.items,e));break}default:{let l=i;(t=(s=this.defaults.extensions)==null?void 0:s.childTokens)!=null&&t[l.type]?this.defaults.extensions.childTokens[l.type].forEach(a=>{let c=l[a].flat(1/0);n=n.concat(this.walkTokens(c,e))}):l.tokens&&(n=n.concat(this.walkTokens(l.tokens,e)))}}return n}use(...r){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return r.forEach(n=>{let s={...n};if(s.async=this.defaults.async||s.async||!1,n.extensions&&(n.extensions.forEach(t=>{if(!t.name)throw new Error("extension name required");if("renderer"in t){let i=e.renderers[t.name];i?e.renderers[t.name]=function(...l){let a=t.renderer.apply(this,l);return a===!1&&(a=i.apply(this,l)),a}:e.renderers[t.name]=t.renderer}if("tokenizer"in t){if(!t.level||t.level!=="block"&&t.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=e[t.level];i?i.unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&(t.level==="block"?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:t.level==="inline"&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}"childTokens"in t&&t.childTokens&&(e.childTokens[t.name]=t.childTokens)}),s.extensions=e),n.renderer){let t=this.defaults.renderer||new F(this.defaults);for(let i in n.renderer){if(!(i in t))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let l=i,a=n.renderer[l],c=t[l];t[l]=(...o)=>{let h=a.apply(t,o);return h===!1&&(h=c.apply(t,o)),h||""}}s.renderer=t}if(n.tokenizer){let t=this.defaults.tokenizer||new G(this.defaults);for(let i in n.tokenizer){if(!(i in t))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let l=i,a=n.tokenizer[l],c=t[l];t[l]=(...o)=>{let h=a.apply(t,o);return h===!1&&(h=c.apply(t,o)),h}}s.tokenizer=t}if(n.hooks){let t=this.defaults.hooks||new E;for(let i in n.hooks){if(!(i in t))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let l=i,a=n.hooks[l],c=t[l];E.passThroughHooks.has(i)?t[l]=o=>{if(this.defaults.async&&E.passThroughHooksRespectAsync.has(i))return(async()=>{let d=await a.call(t,o);return c.call(t,d)})();let h=a.call(t,o);return c.call(t,h)}:t[l]=(...o)=>{if(this.defaults.async)return(async()=>{let d=await a.apply(t,o);return d===!1&&(d=await c.apply(t,o)),d})();let h=a.apply(t,o);return h===!1&&(h=c.apply(t,o)),h}}s.hooks=t}if(n.walkTokens){let t=this.defaults.walkTokens,i=n.walkTokens;s.walkTokens=function(l){let a=[];return a.push(i.call(this,l)),t&&(a=a.concat(t.call(this,l))),a}}this.defaults={...this.defaults,...s}}),this}setOptions(r){return this.defaults={...this.defaults,...r},this}lexer(r,e){return y.lex(r,e??this.defaults)}parser(r,e){return S.parse(r,e??this.defaults)}parseMarkdown(r){return(e,n)=>{let s={...n},t={...this.defaults,...s},i=this.onError(!!t.silent,!!t.async);if(this.defaults.async===!0&&s.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));if(t.hooks&&(t.hooks.options=t,t.hooks.block=r),t.async)return(async()=>{let l=t.hooks?await t.hooks.preprocess(e):e,a=await(t.hooks?await t.hooks.provideLexer():r?y.lex:y.lexInline)(l,t),c=t.hooks?await t.hooks.processAllTokens(a):a;t.walkTokens&&await Promise.all(this.walkTokens(c,t.walkTokens));let o=await(t.hooks?await t.hooks.provideParser():r?S.parse:S.parseInline)(c,t);return t.hooks?await t.hooks.postprocess(o):o})().catch(i);try{t.hooks&&(e=t.hooks.preprocess(e));let l=(t.hooks?t.hooks.provideLexer():r?y.lex:y.lexInline)(e,t);t.hooks&&(l=t.hooks.processAllTokens(l)),t.walkTokens&&this.walkTokens(l,t.walkTokens);let a=(t.hooks?t.hooks.provideParser():r?S.parse:S.parseInline)(l,t);return t.hooks&&(a=t.hooks.postprocess(a)),a}catch(l){return i(l)}}}onError(r,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,r){let s="<p>An error occurred:</p><pre>"+R(n.message+"",!0)+"</pre>";return e?Promise.resolve(s):s}if(e)return Promise.reject(n);throw n}}},T=new Fn;function f(r,e){return T.parse(r,e)}f.options=f.setOptions=function(r){return T.setOptions(r),f.defaults=T.defaults,fe(f.defaults),f};f.getDefaults=X;f.defaults=D;f.use=function(...r){return T.use(...r),f.defaults=T.defaults,fe(f.defaults),f};f.walkTokens=function(r,e){return T.walkTokens(r,e)};f.parseInline=T.parseInline;f.Parser=S;f.parser=S.parse;f.Renderer=F;f.TextRenderer=ae;f.Lexer=y;f.lexer=y.lex;f.Tokenizer=G;f.Hooks=E;f.parse=f;f.options;f.setOptions;f.use;f.walkTokens;f.parseInline;S.parse;y.lex;const Un={class:"prd-container"},Zn={class:"prd-sidebar"},Vn={key:1,style:{padding:"24px","text-align":"center",color:"#999"}},Hn={class:"prd-content"},jn={class:"doc-title"},Kn=["innerHTML"],Wn={key:1,class:"text-body"},Xn={key:1,class:"empty-state"},Yn=ve({__name:"UpdateLog",setup(r){const e=Object.assign({"/PRD/QMS系统菜单重构方案.md":Ee,"/PRD/基础数据/供应商档案_详细设计说明书.md":Be,"/PRD/基础数据/储存地点_详细设计说明书.md":Oe,"/PRD/基础数据/客户档案_详细设计说明书.md":Ne,"/PRD/基础数据/工艺路线_详细设计说明书.md":qe,"/PRD/基础数据/物料产品档案_详细设计说明书.md":Ge,"/PRD/基础数据/物料分类_详细设计说明书.md":Fe,"/PRD/基础数据/生产班组_详细设计说明书.md":Ue,"/PRD/基础数据/计量单位_详细设计说明书.md":Ze,"/PRD/基础数据与质量主数据_需求文档.md":Ve,"/PRD/质量主数据/不良现象与缺陷库_详细设计说明书.md":He,"/PRD/质量主数据/抽样方案管理_详细设计说明书.md":je,"/PRD/质量主数据/检验方法管理_详细设计说明书.md":Ke,"/PRD/质量主数据/检验模板管理_详细设计说明书.md":We,"/PRD/质量主数据/检验项目管理_详细设计说明书.md":Xe,"/PRD/质量主数据/质量检验计划与方案_详细设计说明书.md":Ye,"/PRD/质量主数据/量检具台账_详细设计说明书.md":Je}),n=ie([]),s=ie(null),t=c=>{const o=[];for(const[h,d]of Object.entries(c)){const u=h.match(/\/PRD\/(.+)$/);if(!u)continue;const m=u[1].split("/");let g=o,b="";m.forEach((_,v)=>{b+=(b?"/":"")+_;const I=v===m.length-1;let P=g.find(V=>V.title===_);P||(P={title:_,key:b,isLeaf:I,selectable:I},I?P.content=d:P.children=[],g.push(P)),I||(g=P.children)})}return o};$e(()=>{n.value=t(e)});const i=(c,o)=>{const h=o.node.dataRef;h&&h.isLeaf&&(s.value=h)},l=le(()=>s.value?s.value.title.toLowerCase().endsWith(".md"):!1),a=le(()=>{var c;return!l.value||!((c=s.value)!=null&&c.content)?"":f.parse(s.value.content)});return(c,o)=>{const h=oe("a-tree"),d=oe("a-empty");return C(),$("div",Un,[Q("div",Zn,[o[0]||(o[0]=Q("div",{class:"sidebar-header"},[Q("h3",null,"需求文档 (PRD)")],-1)),n.value.length>0?(C(),Me(h,{key:0,"tree-data":n.value,"default-expand-all":!0,onSelect:i,blockNode:""},null,8,["tree-data"])):(C(),$("div",Vn," 未找到文档 "))]),Q("div",Hn,[s.value?(C(),$(Qe,{key:0},[Q("h2",jn,ce(s.value.title),1),l.value?(C(),$("div",{key:0,class:"markdown-body",innerHTML:a.value},null,8,Kn)):(C(),$("pre",Wn,ce(s.value.content),1))],64)):(C(),$("div",Xn,[Le(d,{description:"请在左侧选择要查看的文档"})]))])])}}}),rr=ze(Yn,[["__scopeId","data-v-8e34b5d5"]]);export{rr as default};
