# 检验模板管理

## ADDED Requirements

### Requirement: 检验模板管理功能
The system MUST provide inspection template management functionality that allows creating and managing reusable inspection templates. 系统应提供检验模板管理功能，允许创建和管理可复用的检验模板

#### Scenario: 质量工程师访问检验模板列表页面
- 当质量工程师访问"检验模板"页面时
- 系统应显示检验模板列表
- 系统应提供搜索表单，支持按模板编码、名称、状态、版本筛选
- 系统应显示表格列：模板编码、模板名称、版本、状态、创建时间、操作

#### Scenario: 质量工程师创建新的检验模板
- 当质量工程师点击"新增"按钮时
- 系统应跳转到检验模板编辑页面
- 系统应显示模板基本信息表单
- 系统应允许用户输入模板编码、模板名称、版本
- 系统应设置模板初始状态为"草稿"

#### Scenario: 质量工程师编辑检验模板
- 当质量工程师点击"编辑"按钮时
- 系统应跳转到检验模板编辑页面
- 系统应预填充模板基本信息和明细数据
- 系统应允许用户修改模板信息
- 系统应仅在草稿或审批中状态下允许编辑

#### Scenario: 质量工程师查看检验模板
- 当质量工程师点击"查看"按钮时
- 系统应跳转到检验模板查看页面
- 系统应以只读模式显示模板信息
- 系统应不允许修改任何数据

#### Scenario: 质量工程师删除检验模板
- 当质量工程师点击"删除"按钮时
- 系统应显示确认对话框
- 系统应仅在草稿状态下允许删除
- 系统应在用户确认后删除模板

### Requirement: 检验模板状态管理
The system MUST support inspection template status management and workflow transitions. 系统应支持检验模板的状态管理和工作流流转

#### Scenario: 质量工程师提交草稿模板进行审批
- 当质量工程师在草稿模板页面点击"提交审批"按钮时
- 系统应将模板状态从"草稿"变更为"审批中"
- 系统应创建工作流实例
- 系统应禁止模板编辑

#### Scenario: 质量工程师审批通过检验模板
- 当质量工程师在审批中模板页面点击"审批通过"按钮时
- 系统应将模板状态从"审批中"变更为"已批准"
- 系统应完成工作流实例
- 系统应禁止模板编辑

#### Scenario: 质量工程师拒绝检验模板
- 当质量工程师在审批中模板页面点击"审批拒绝"按钮时
- 系统应将模板状态从"审批中"变更为"草稿"
- 系统应终止工作流实例
- 系统应允许模板编辑

#### Scenario: 质量工程师作废检验模板
- 当质量工程师点击"作废"按钮时
- 系统应显示确认对话框
- 系统应在用户确认后将模板状态变更为"作废"
- 系统应禁止模板编辑和删除

#### Scenario: 系统显示状态标签
- 系统应使用不同颜色标签显示模板状态
- 系统应显示：草稿（灰色）、审批中（蓝色）、已批准（绿色）、作废（红色）

### Requirement: 检验模板版本管理
The system MUST support inspection template version control. 系统应支持检验模板的版本管理

#### Scenario: 质量工程师查看模板历史版本
- 当质量工程师点击"版本历史"按钮时
- 系统应显示该模板的所有历史版本列表
- 系统应显示版本号、状态、创建时间、创建人

#### Scenario: 质量工程师查看特定版本内容
- 当质量工程师点击某个历史版本时
- 系统应以只读模式显示该版本的完整内容
- 系统应显示版本号和状态信息

#### Scenario: 系统防止修改已批准版本
- 当模板状态为"已批准"时
- 系统应禁止修改模板信息
- 系统应提示用户如需修改应创建新版本

### Requirement: 检验模板明细管理
The system MUST support inspection template detail management. 系统应支持检验模板明细管理

#### Scenario: 质量工程师添加模板明细行
- 当质量工程师在模板明细区域点击"添加检验项目"按钮时
- 系统应显示检验项目选择器
- 系统应允许用户选择检验项目
- 系统应在表格中新增一行，并自动填充检验项目默认值（检验方法、量检具类型、是否送检实验室、是否SPC）

#### Scenario: 质量工程师编辑模板明细行
- 当质量工程师点击明细行的"编辑"按钮时
- 系统应显示编辑表单
- 系统应允许用户修改以下字段：
  - 抽样规则
  - 特性分类（SC/CC/Major/Minor）
  - 检验方法
  - 量检具类型
  - 是否送检实验室
  - 是否SPC
  - IPQC频次类型（仅IPQC场景）
  - IPQC频次值（仅IPQC场景）
  - IPQC频次单位（仅IPQC场景）
- 系统应在保存后更新明细行

#### Scenario: 质量工程师删除模板明细行
- 当质量工程师点击明细行的"删除"按钮时
- 系统应显示确认对话框
- 系统应在用户确认后删除该明细行

#### Scenario: 质量工程师调整明细行顺序
- 当质量工程师拖拽明细行进行排序时
- 系统应实时更新行顺序
- 系统应在保存时保存新的顺序号

### Requirement: IPQC频次配置
The system MUST support IPQC frequency configuration. 系统应支持IPQC频次配置

#### Scenario: 质量工程师配置按时间检验频次
- 当质量工程师选择IPQC频次类型为"按时间"时
- 系统应显示频次值和频次单位字段
- 系统应允许用户输入频次值（如2）和选择频次单位（如"HOURS"）
- 系统应显示"每2小时"的配置预览

#### Scenario: 质量工程师配置按数量检验频次
- 当质量工程师选择IPQC频次类型为"按数量"时
- 系统应显示频次值和频次单位字段
- 系统应允许用户输入频次值（如5）和选择频次单位（如"PCS"）
- 系统应显示"每5件"的配置预览

#### Scenario: 系统验证IPQC频次配置
- 当用户保存明细行时
- 系统应验证频次值是否大于0
- 如果频次值无效，系统应显示错误提示并阻止保存

### Requirement: 检验模板表单验证
The system MUST support inspection template form validation. 系统应支持检验模板的表单验证

#### Scenario: 验证模板基本信息必填字段
- 当用户保存模板时
- 系统应验证模板编码、模板名称、版本是否已填写
- 如果必填字段未填写，系统应显示错误提示并阻止保存

#### Scenario: 验证模板编码唯一性
- 当用户保存新模板时
- 系统应验证模板编码在当前版本下是否唯一
- 如果模板编码已存在，系统应显示错误提示并阻止保存

#### Scenario: 验证模板包含检验项目
- 当用户提交模板审批时
- 系统应验证模板是否包含至少一个检验项目
- 如果模板为空，系统应显示错误提示并阻止提交

#### Scenario: 验证明细行必填字段
- 当用户保存明细行时
- 系统应验证抽样规则、特性分类是否已填写
- 如果必填字段未填写，系统应显示错误提示并阻止保存

### Requirement: 检验模板导出功能
The system MUST support exporting inspection templates. 系统应支持检验模板的导出功能

#### Scenario: 质量工程师导出检验模板
- 当质量工程师点击"导出"按钮时
- 系统应将当前筛选后的模板列表导出为Excel文件
- 系统应包含模板基本信息和明细信息

#### Scenario: 质量工程师导出检验模板明细
- 当质量工程师在模板编辑页面点击"导出明细"按钮时
- 系统应将当前模板的明细表导出为Excel文件
- 系统应包含所有明细行的完整信息
