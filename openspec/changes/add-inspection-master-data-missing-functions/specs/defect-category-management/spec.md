# 缺陷分类管理

## ADDED Requirements

### Requirement: 独立的缺陷分类管理页面
The system MUST provide an independent defect category management page that supports tree-structured category management. 系统应提供独立的缺陷分类管理页面，支持树状结构的分类管理

#### Scenario: 质量工程师访问缺陷分类管理页面
- 当质量工程师访问"缺陷分类管理"页面时
- 系统应显示缺陷分类树
- 树应支持多级分类展示（如：铸造缺陷 → 气孔类缺陷）
- 树应显示分类名称和分类代码

#### Scenario: 质量工程师创建新的根级缺陷分类
- 当质量工程师点击"新增根分类"按钮时
- 系统应显示新增分类表单
- 系统应允许用户输入分类代码、分类名称、描述
- 系统应在保存后刷新分类树并显示新创建的分类

#### Scenario: 质量工程师创建子级缺陷分类
- 当质量工程师在树节点上点击"添加子类"按钮时
- 系统应显示新增子分类表单
- 系统应自动填充父级分类信息
- 系统应在保存后刷新分类树并显示新创建的子分类

#### Scenario: 质量工程师编辑缺陷分类
- 当质量工程师在树节点上点击"编辑"按钮时
- 系统应显示编辑表单，预填充当前分类信息
- 系统应允许用户修改分类代码、分类名称、描述
- 系统应在保存后更新分类树中的分类信息

#### Scenario: 质量工程师搜索缺陷分类
- 当质量工程师在搜索框中输入搜索关键词时
- 系统应过滤分类树，显示匹配的分类节点
- 系统应支持按分类名称或分类代码搜索

### Requirement: 缺陷分类删除功能
The system MUST support defect category deletion with cascade deletion confirmation. 系统应支持缺陷分类的删除功能，并提供级联删除确认

#### Scenario: 质量工程师删除无引用的缺陷分类
- 当质量工程师在树节点上点击"删除"按钮时
- 系统应显示确认对话框，提示删除分类及其所有子类
- 如果该分类及其子类未被不良现象引用
- 系统应在用户确认后删除分类及其所有子类
- 系统应刷新分类树

#### Scenario: 质量工程师删除被引用的缺陷分类
- 当质量工程师在树节点上点击"删除"按钮时
- 系统应显示确认对话框，提示删除分类及其所有子类
- 如果该分类或其子类已被不良现象引用
- 系统应提示用户该分类已被引用，并询问是否级联删除相关不良现象或取消删除操作

#### Scenario: 质量工程师删除包含子类的缺陷分类
- 当质量工程师删除包含子类的父分类时
- 系统应提示用户将同时删除所有子分类
- 系统应在用户确认后删除父分类及其所有子分类

### Requirement: 缺陷分类树信息预览
The system MUST support previewing and operating on category information in the defect category tree. 系统应在缺陷分类树中支持分类信息的预览和操作

#### Scenario: 质量工程师在分类树中选择缺陷分类
- 当质量工程师点击分类树中的某个分类节点时
- 系统应在右侧详情区域显示该分类的完整信息
- 系统应显示分类代码、分类名称、描述、父级分类（如有）

#### Scenario: 质量工程师展开/折叠分类树节点
- 当质量工程师点击分类树的展开/折叠图标时
- 系统应展开或折叠该节点的子分类
- 系统应保持展开/折叠状态

#### Scenario: 系统默认展开分类树
- 当页面加载时
- 系统应默认展开第一级分类节点
- 系统应自动加载分类树数据

### Requirement: 缺陷分类导出功能
The system MUST support exporting defect categories. 系统应支持缺陷分类的导出功能

#### Scenario: 质量工程师导出缺陷分类
- 当质量工程师点击"导出"按钮时
- 系统应将当前分类树数据导出为Excel文件
- 系统应包含分类代码、分类名称、父级分类、描述等完整信息
- 系统应支持树状结构的导出（包含层级关系）
