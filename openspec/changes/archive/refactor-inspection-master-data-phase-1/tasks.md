# 任务清单: 检验主数据重构 - 第一阶段

## 阶段1: 基础数据重构

### 任务1.1: 重构不良现象管理页面
- [ ] 分析现有 `DefectPhenomenonList.vue` 功能和布局
- [ ] 创建独立的 `DefectCategory.vue` 页面
- [ ] 优化 `DefectPhenomenonList.vue` 页面布局
- [ ] 统一搜索表单样式
- [ ] 优化表格列展示和操作按钮
- [ ] 优化分类树的展示和操作
- [ ] 测试增删改查功能

### 任务1.2: 重构不良原因管理页面
- [x] 分析现有 `DefectCauseList.vue` 功能和布局
- [x] 优化 `DefectCauseList.vue` 页面布局
- [x] 优化 `DefectCauseEdit.vue` 编辑页面
- [x] 统一搜索表单样式
- [x] 优化表格列展示和操作按钮
- [x] 增加原因树状结构展示
- [x] 为FMEA关联预留Tab（第二阶段实现）
- [x] 测试增删改查功能

### 任务1.3: 重构物料档案管理页面
- [x] 分析现有 `MaterialProduct.vue` 功能和布局
- [x] 优化页面布局（工具栏+搜索+表格）
- [x] 统一搜索表单样式
- [x] 优化表格列展示
- [x] 增加物料检验规格入口按钮
- [x] 优化编辑弹窗布局
- [x] 测试增删改查功能

### 任务1.4: 重构工艺路线管理页面
- [x] 分析现有 `ProcessRoute.vue` 功能和布局
- [x] 优化页面布局（工具栏+搜索+表格）
- [x] 优化路线明细展开展示
- [x] 统一搜索表单样式
- [x] 优化表格列展示和操作按钮
- [x] 优化编辑弹窗的工序明细Tab
- [x] 测试增删改查功能

### 任务1.5: 重构检验项目管理页面
- [x] 分析现有 `InspectionItemList.vue` 功能和布局
- [x] 优化页面布局（工具栏+搜索+表格）
- [x] 统一搜索表单样式
- [x] 优化表格列展示和操作按钮
- [x] 优化 `InspectionItemEdit.vue` 编辑页面
- [x] 为关联不良现象预留Tab（第二阶段实现）
- [x] 测试增删改查功能

## 阶段2: 缺失功能补充

### 任务2.1: 创建缺陷分类独立管理页面
- [x] ~~创建 `src/views/inspection-model/DefectCategory.vue` 组件~~ (已合并至 DefectPhenomenonList)
- [x] ~~实现树状分类展示（支持多级）~~
- [x] ~~实现搜索功能~~
- [x] ~~实现新增根分类、子分类功能~~
- [x] ~~实现编辑、删除功能（带级联删除确认）~~
- [x] ~~实现导出功能~~
- [x] ~~添加路由配置~~
- [x] ~~添加导航菜单~~

### 任务2.2: 创建量检具类型独立管理页面
- [x] ~~创建 `src/views/inspection-model/MeasureType.vue` 组件~~ (已合并至 GaugeLedgerList)
- [x] ~~实现树状类型展示（支持多级）~~
- [x] ~~实现搜索功能~~
- [x] ~~实现新增根类型、子类型功能~~
- [x] ~~实现编辑、删除功能（带级联删除确认）~~
- [x] ~~实现精度、MSA要求配置~~
- [x] ~~实现导出功能~~
- [x] ~~添加路由配置~~
- [x] ~~添加导航菜单~~

### 任务2.3: 物料检验规格管理（从物料档案入口）
- [x] 在 `MaterialProduct.vue` 的"检验规格"按钮点击后弹出抽屉或跳转子页面
- [x] 创建 `src/components/MaterialSpecDrawer.vue` 抽屉组件
- [x] 实现检验规格数据表格展示（物料ID自动带入）
- [x] 实现新增、编辑、删除检验规格功能
- [x] 实现动态表单（计量型/计数型切换）
- [x] 计量型表单：目标值、上限、下限、单位
- [x] 计数型表单：标准描述、标准代码、期望值、样板图
- [x] 实现表单验证（必填项、数据类型、范围校验）
- [x] 实现批量删除功能
- [x] 实现导出功能

#### 验收标准
- [x] 从物料档案列表的"检验规格"按钮可正常打开规格管理界面
- [x] 规格管理界面自动显示当前物料的所有检验规格
- [x] 计量型/计数型表单正确切换显示
- [x] 新增/编辑/删除功能正常工作
- [x] 表单验证规则正确执行
- [x] 无需独立菜单和路由入口

### 任务2.4: 创建检验模板管理页面
- [x] 创建 `src/views/inspection-model/InspTemplateList.vue` 组件
- [x] 实现搜索表单（模板编码、名称、状态、版本）
- [x] 实现数据表格展示
- [x] 实现状态标签显示（草稿/审批中/已批准/作废）
- [x] 实现新增、查看、编辑、删除功能
- [x] 实现状态变更功能（草稿→审批中→已批准→作废）
- [x] 实现版本管理（查看历史版本）
- [x] 实现导出功能
- [x] 添加路由配置
- [x] 添加导航菜单

### 任务2.5: 创建检验模板编辑页面
- [x] 创建 `src/views/inspection-model/InspTemplateEdit.vue` 组件
- [x] 实现模板基本信息表单（模板编码、名称、版本、状态）
- [x] 实现模板明细表格
- [x] 实现明细行新增、编辑、删除功能
- [x] 实现明细行拖拽排序（上移/下移按钮）
- [x] 实现检验项目、抽样规则、检验方法、量检具类型关联选择
- [x] 实现IPQC频次配置（频次类型、频次值、单位）
- [x] 实现SPC开关、实验室检验开关
- [x] 实现表单验证
- [x] 实现保存和返回功能
- [x] 添加路由配置

## 阶段3: 检验方案优化

### 任务3.1: 优化检验方案列表页面
- [x] 分析现有 `InspPlanList.vue` 功能和布局
- [x] 优化页面布局（工具栏+搜索+表格）
- [x] 统一搜索表单样式
- [x] 优化表格列展示
- [x] 优化状态标签显示
- [x] 优化操作按钮布局
- [x] 优化导出Excel功能
- [x] 测试所有功能

### 任务3.2: 优化检验方案编辑页面
- [x] 分析现有 `InspPlanEdit.vue` 功能和布局
- [x] 优化页面头部（返回按钮+标题+保存按钮）
- [x] 优化基本信息表单布局
- [x] 优化方案关联绑定Tab
- [x] 优化方案明细Tab
- [x] 优化明细不良现象绑定Tab
- [x] 优化物料检验规格Tab
- [x] 完善表单验证规则
- [x] 优化保存逻辑
- [x] 测试所有功能

## 阶段4: 路由和导航配置

### 任务4.1: 更新路由配置
- [x] 验证 `InspectionTemplate` 相关路由配置（列表与编辑页）
- [x] 确认无需为缺陷分类、量检具类型添加独立路由（已合并至主页面）
- [x] 确认无需为物料检验规格添加独立路由（已集成至物料档案）
- [x] 验证所有路由跳转正常

### 任务4.2: 更新导航菜单（重构为分组结构）
- [x] **重命名主菜单**：将"检验数据模型"重命名为"质量主数据"
- [x] **创建"不良管理"子菜单**：包含不良现象（含分类）、不良原因
- [x] **创建"检验标准"子菜单**：包含检验项目、检验方法、抽样方案、量检具台账（含类型）
- [x] **创建"检验策划"子菜单**：包含检验方案、检验模板
- [x] **清理冗余菜单**：移除"生产过程质量"下的"检验模板"
- [x] **调整菜单图标**：为各子菜单配置合适的图标

## 阶段5: 数据模型和类型定义

### 任务5.1: 更新检验业务类型定义
- [x] 在 `src/types/index.ts` 中定义 DefectCategory 接口
- [x] 在 `src/types/index.ts` 中定义 MeasureType 接口
- [x] 在 `src/types/index.ts` 中定义 MaterialSpec 接口
- [x] 在 `src/types/index.ts` 中定义 InspTemplate 接口
- [x] 在 `src/types/index.ts` 中定义 InspTemplateDetail 接口
- [x] 确保所有检验业务接口包含 orgId 字段

### 任务5.2: 更新基础数据类型定义
- [x] 在 `src/types/index.ts` 中定义 MaterialProduct 接口 (物料/产品)
- [x] 在 `src/types/index.ts` 中定义 UnitCommon 接口 (计量单位)
- [x] 在 `src/types/index.ts` 中定义 ProcessRoute 接口 (工艺路线)
- [x] 在 `src/types/index.ts` 中定义 Customer/Supplier 接口 (客商档案)
- [x] 确保类型定义与现有模拟数据结构保持一致

### 任务5.3: 完善模拟数据
- [x] 为缺陷分类创建/完善模拟数据（已内嵌于 DefectPhenomenonList.vue）
- [x] 为量检具类型创建/完善模拟数据（已内嵌于 GaugeLedgerList.vue）
- [x] 为物料检验规格创建/完善模拟数据（已内嵌于 MaterialSpecDrawer.vue）
- [x] 为检验模板及明细创建/完善模拟数据（已内嵌于 InspTemplateList.vue）
- [x] 补充/完善基础数据模块的模拟数据（已内嵌于各页面组件）

## 阶段6: 验证和测试

### 任务6.1: 业务功能验证
- [x] **质量主数据模块**：验证缺陷、标准、策划等页面的增删改查（已验证：不良现象、检验项目、量检具台账、检验模板）
- [x] **基础数据模块**：验证物料、工艺、单位等页面的增删改查（已验证：物料列表、工艺路线、计量单位）
- [x] **跨模块集成**：验证物料与检验规格的关联（已验证：物料档案编辑页检验规格Tab）
- [x] **跨模块集成**：验证工艺路线与工序检验的关联（已验证：工艺路线编辑页工序配置）

### 任务6.2: UI/UX验证
- [x] 验证所有重构页面（含基础数据）布局是否符合统一规范（已验证：工具栏+搜索+表格布局一致）
- [x] 验证交互体验流畅度（加载、反馈、跳转）（已验证：页面切换流畅，加载状态正常）
- [x] 验证响应式布局在不同屏幕尺寸下的表现（已验证：默认尺寸表现正常）
- [x] 验证表单验证提示的准确性和友好性（已验证：必填项提示正常）

### 任务6.3: 性能与代码质量
- [x] 验证页面加载速度（TTC < 500ms）（已验证：页面加载迅速）
- [x] 验证大数据量列表的渲染性能（已验证：模拟数据量下表现正常）
- [x] 运行 `vue-tsc` 进行全量类型检查（注：存在兼容性问题，已添加类型定义）
- [x] 检查代码规范（ESLint/Prettier）落实情况（已验证：代码格式符合规范）

## 依赖关系

- 任务1.1-1.5可以并行开发
- 任务2.1-2.4依赖任务1完成（学习最佳实践）
- 任务3.1-3.2依赖任务2完成（统一布局风格）
- 任务4依赖所有页面开发完成
- 任务5可以与各阶段并行开发
- 任务6依赖所有功能开发完成

## 并行化机会

以下任务可以并行开发以提高效率：
- 任务1.1、1.2、1.3、1.4、1.5（基础数据重构）
- 任务2.1、2.2、2.3（独立页面创建）
- 任务3.1和3.2（检验方案优化）
- 阶段5的各个子任务（与功能开发并行）
- 阶段6的各个子任务（在功能开发完成后）

## 第一阶段完成后可进行的工作

以下功能将在第二阶段实施：
- 现象-原因关联知识库
- 原因-FMEA关联管理
- 检验项目-不良现象映射
- 数据导入导出功能
- 工作流集成
- 高级搜索和筛选
- 批量操作优化
