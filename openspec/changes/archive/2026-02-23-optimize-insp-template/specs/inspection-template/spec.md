# Spec: 检验模板管理 (Inspection Template Management)

## MODIFIED Requirements

### Requirement: [REQ-IT-001] 检验模板版本与状态管理
检验模板 SHALL 具备严格的版本控制和生命周期状态流转，以确保生产中使用的标准是经过审批且有效的。

#### Scenario: 模板状态流转
- **GIVEN**: 一个处于 `DRAFT` (草稿) 状态的检验模板。
- **WHEN**: 工程师完成编辑并点击“提交审批”。
- **THEN**: 模板状态变更为 `IN_APPROVAL` (审批中)，此时模板被锁定，不可再编辑。
- **WHEN**: 审批通过。
- **THEN**: 状态变更为 `APPROVED` (已批准)，该版本可以被检验方案引用。
- **WHEN**: 创建新版本。
- **THEN**: 原 `APPROVED` 状态的模板保持有效，直至手动标记为 `OBSOLETE` (作废) 或被新版本完全替代。

### Requirement: [REQ-IT-002] 检验模板明细的特性分类与配置
模板明细行 SHALL 支持丰富的质量属性配置，以便精确控制不同特性的检验要求。

#### Scenario: 特级特性配置
- **GIVEN**: 正在编辑一个检验模板。
- **WHEN**: 添加一个检验项目（如“外观”）。
- **THEN**: 支持选择特性分类（SC-特殊特性、CC-关键特性、Major-主要、Minor-次要）。
- **THEN**: 抽样规则必须配置（引用 L1 抽样标准）。
- **THEN**: 检验方法、量检具类型、是否送检、SPC 监控开关应支持在项目默认值基础上进行覆盖编辑。

### Requirement: [REQ-IT-003] 不良现象关联防错 (Poka-Yoke)
系统 SHALL 通过预定义项目与不良现象的关联，减少检验员录入时的错误风险。

#### Scenario: 关联过滤展示
- **GIVEN**: 模板中“尺寸检查”项关联了“尺寸偏大”、“尺寸偏小”两个不良现象。
- **WHEN**: 检验员在执行该项目的检验并录入不合格结果时。
- **THEN**: 系统仅弹出关联的前述两个不良现象供选择，防止录入“色差”等无关缺陷。

### Requirement: [REQ-IT-004] 全局与私有支持
系统 SHALL 支持集团定义的全局标准项目与工厂定义的私有项目在同一模板中共存。

#### Scenario: 引用标准项目
- **GIVEN**: 舜富集团定义了全局的“硬度测试”项目。
- **WHEN**: 合肥工厂新建模板。
- **THEN**: 可以直接引用该全局项目，同时添加自己工厂私有的“特殊盐雾测试”项目。
