# 量检具台账管理

## ADDED Requirements

### Requirement: 扩展量检具台账数据模型
系统 MUST 支持扩展的量检具台账字段，包括技术参数、校准信息和管理信息。

#### Scenario: 质量工程师新增完整量检具信息
- 当质量工程师打开新增量检具台账弹窗时
- 系统 MUST 显示分组的表单，包含基本信息、技术参数、校准信息、管理信息四个分组
- 当工程师填写完整信息并保存时
- 系统 MUST 验证必填字段并保存所有字段数据

#### Scenario: 量检具列表显示校准状态
- 当用户查看量检具台账列表时
- 系统 MUST 显示每个量检具的校准状态指示
- 距下次校准 > 14 天显示绿色（正常）
- 距下次校准 ≤ 14 天显示橙色（即将到期）
- 已超过校准日期显示红色（已过期）

#### Scenario: 按校准状态筛选量检具
- 当用户在筛选条件中选择"即将到期"时
- 系统 MUST 仅显示距下次校准日期 ≤ 14 天的量检具记录

---

### Requirement: 校准记录管理功能
系统 MUST 支持记录每个量检具的历史校准信息。

#### Scenario: 查看量检具校准历史
- 当质量工程师进入量检具详情页的"校准记录"Tab 时
- 系统 MUST 显示该量检具的所有历史校准记录列表
- 列表 MUST 包含校准日期、校准类型、校准结果、校准机构等信息

#### Scenario: 新增校准记录
- 当质量工程师点击"新增校准记录"按钮时
- 系统 MUST 显示校准记录表单
- 当工程师填写校准信息并保存时
- 系统 MUST 自动更新台账的"上次校准日期"为本次校准日期
- 系统 MUST 根据校准周期自动计算并更新"下次校准日期"

#### Scenario: 上传校准证书附件
- 当质量工程师新增校准记录时
- 系统 MUST 支持上传校准证书扫描件作为附件
- 附件 MUST 与校准记录关联保存

---

### Requirement: 量检具状态生命周期管理
系统 MUST 支持量检具的状态流转和变更记录。

#### Scenario: 状态流转限制
- 当量检具当前状态为"在用"时
- 用户可以将状态变更为"校准中"、"封存"或"报废"
- 当量检具当前状态为"报废"时
- 系统 MUST NOT 允许进行状态变更（终态）

#### Scenario: 状态变更记录
- 当用户变更量检具状态时
- 系统 MUST 要求用户填写变更原因
- 系统 MUST 记录变更日志，包含原状态、新状态、操作人、操作时间、变更原因

#### Scenario: 查看状态变更历史
- 当用户进入量检具详情页的"状态变更"Tab 时
- 系统 MUST 以时间线形式展示该量检具的所有状态变更历史

