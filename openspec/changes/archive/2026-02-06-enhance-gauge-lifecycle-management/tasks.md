# 任务清单：增强量检具全生命周期管理

## 阶段 1：数据模型扩展

### 任务 1.1：扩展量检具台账类型定义 [优先级: P0]
- [x] 在 `src/types/index.ts` 中扩展 `GaugeLedger` 接口，新增字段：
  - `manufacturer` 制造商
  - `serialNo` 出厂序列号
  - `measureRange` 量程范围
  - `resolution` 分辨率
  - `accuracy` 精度等级
  - `calibrationCycle` 校准周期（月）
  - `lastCalDate` 上次校准日期
  - `purchaseDate` 购置日期
  - `expiryDate` 有效期
  - `location` 存放位置
  - `custodian` 保管人
  - `certificateNo` 检定证书编号
  - `attachmentIds` 附件列表
- [x] 定义 `GaugeStatus` 枚举类型
- [x] 定义 `CalibrationRecord` 校准记录接口

### 任务 1.2：扩展模拟数据 [优先级: P0]
- [x] 更新 `GaugeLedgerList.vue` 中的模拟数据，包含新增字段的示例值
- [x] 添加校准记录的模拟数据

---

## 阶段 2：台账表单扩展

### 任务 2.1：扩展台账编辑弹窗 [优先级: P0]
- [x] 修改 `GaugeLedgerList.vue` 中的台账编辑弹窗
- [x] 使用分组布局（基本信息、技术参数、校准信息、管理信息）
- [x] 添加必填项验证规则
- [x] 校准周期输入时自动计算下次校准日期

### 任务 2.2：扩展台账列表显示 [优先级: P1]
- [x] 列表增加「校准状态」指示列
  - 正常（绿色）：距下次校准 > 14 天
  - 即将到期（橙色）：距下次校准 ≤ 14 天
  - 已过期（红色）：已超过校准日期
- [x] 支持按校准状态筛选

### 任务 2.3：实现批量导入功能 [优先级: P1]
- [x] 在台账列表页头部增加「导入」按钮
- [x] 实现模拟导入逻辑，支持批量增加台账记录
- [x] 导入完成后给予结果反馈（成功条数）

---

## 阶段 3：台账详情页

### 任务 3.1：创建台账详情页组件 [优先级: P0]
- [x] 创建 `GaugeLedgerDetail.vue` 组件
- [x] 使用 Tab 页布局：
  - Tab 1: 基本信息
  - Tab 2: 校准记录
  - Tab 3: 状态变更记录
- [x] 添加路由配置

### 任务 3.2：实现校准记录管理 [优先级: P0]
- [x] 在详情页「校准记录」Tab 中显示历史校准记录列表
- [x] 支持新增校准记录
- [x] 新增校准记录时自动更新台账的 `lastCalDate` 和 `nextCalDate`
- [x] 支持上传校准证书附件

---

## 阶段 4：状态生命周期管理

### 任务 4.1：实现状态流转逻辑 [优先级: P1]
- [x] 定义状态流转规则（状态机）
- [x] 在台账列表操作列增加"状态变更"按钮
- [x] 状态变更时记录变更日志
- [x] 限制无效的状态流转（如报废后不能再变更）

### 任务 4.2：实现校准到期预警 [优先级: P1]
- [x] 在台账列表页顶部显示"即将到期"和"已过期"的数量统计卡片
- [x] 点击卡片筛选对应状态的记录
- [x] 考虑后续集成系统通知/消息推送

---

## 阶段 5：路由和菜单更新

### 任务 5.1：更新路由配置 [优先级: P0]
- [x] 在 `src/router/index.ts` 中添加台账详情页路由
- [x] 路由路径：`/inspection-model/gauge-ledgers/:id`

### 任务 5.2：验证菜单导航 [优先级: P2]
- [x] 确认现有菜单「量检具台账」能正确导航到列表页
- [x] 验证从列表页进入详情页的导航流程

---

## 验收标准

1. **功能完整性**
   - [x] 台账表单可录入所有新增字段
   - [x] 校准记录可正确新增和查看
   - [x] 状态流转符合定义的规则
   - [x] 支持台账数据的批量导入功能

2. **用户体验**
   - [x] 校准到期状态有明显的视觉提示
   - [x] 表单布局清晰，分组合理
   - [x] 操作有适当的确认提示

3. **数据一致性**
   - [x] 新增校准记录后，台账的校准日期字段自动更新
   - [x] 状态变更有完整的日志记录

